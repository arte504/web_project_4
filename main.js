!function(){"use strict";class e{constructor(e,t){this._formConfig=e,this._formElement=t}_showInputError=(e,t)=>{const{inputErrorClass:r,errorMessageClass:s}=this._formConfig,n=this._formElement.querySelector(` #${e.id}_error `);n.textContent=t,n.classList.add(s),e.classList.add(r)};_hideInputError=e=>{const{inputErrorClass:t,errorMessageClass:r}=this._formConfig,s=this._formElement.querySelector(` #${e.id}_error `);s.textContent="",s.classList.remove(r),e.classList.remove(t)};resetValidation(){this.inputs.forEach((e=>{this._hideInputError(e)})),this._toggleSubmitButton()}_checkInput=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)};_checkIfFormValid=()=>this.inputs.every((e=>e.validity.valid));_toggleSubmitButton(){const{inactiveButtonClass:e,submitButtonSelector:t}=this._formConfig,r=this._formElement.querySelector(t);this._checkIfFormValid()?(r.disabled=!1,r.classList.remove(e)):(r.disabled=!0,r.classList.add(e))}_setEventListeners=()=>{const{inputSelector:e}=this._formConfig;return this.inputs=Array.from(this._formElement.querySelectorAll(e)),this.inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInput(e),this._toggleSubmitButton()}))})),this._formElement};enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class t{constructor(e,t,r,{onCardClick:s,removeHandler:n,likeHandler:o}){this._name=e.name,this._link=e.link,this._likes=e.likes,this._ownerId=e.owner._id,this._id=e._id,this._template=t,this._userId=r,this._onCardClick=s,this._likeHandler=o,this._removeHandler=n}_getTemplate(){return this._template.content.querySelector(".card").cloneNode(!0)}_setAttributes(e,t){for(const r in t)e.setAttribute(r,t[r])}deleteCard(){const e=document.getElementById(id);e&&e.parentNode.removeChild(e),this._cardElement=null}_renderLikes(){this._likes.forEach((e=>e._id===this._userId?this._likeCard():this._unlikeCard()))}showLikes(e){this._cardElement.querySelector(".card__like-count").textContent=e}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(e=>{this._likeCard(e)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._removeHandler(this._id)})),this._cardElement.addEventListener("click",(e=>{this._onCardClick(e)}))}_showDeleteIcon(){this._userId!=this._ownerId&&this._cardElement.querySelector(".card__delete-button").classList.add("card__delete-button_hidden")}isLiked(){return this.likeIcon.classList.contains("card__like-button_active")}generateCard(){return this._cardElement=this._getTemplate(),this.likeIcon=this._cardElement.querySelector(".card__like-button"),this._setAttributes(this._cardElement.querySelector(".card__image"),{src:this._link,alt:this._name}),this._cardElement.querySelector(".card__title").textContent=this._name,this._showDeleteIcon(),this.showLikes(this._likes.length),this._setEventListeners(),this._renderLikes(),this._cardElement}_likeCard(){this.likeIcon.classList.add("card__like-button_active")}_unlikeCard(){this.likeIcon.classList.remove("card__like-button_active")}}class r{constructor(e){this._modal=e}open(){this._modal.classList.add("modal_visible"),document.addEventListener("keyup",this._checkForEscClose)}close(){this._modal.classList.remove("modal_visible"),console.log("Check"),document.removeEventListener("keyup",this._checkForEscClose)}_clickEscHandler=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._modal.querySelector(".modal__close-button").addEventListener("click",(e=>{this.close(e)})),this._modal.addEventListener("click",(e=>{e.target.classList.contains("modal_visible")&&this.close(e)}))}}class s extends r{constructor({modal:e,handleSubmit:t}){super(e),this._handleSubmit=t,this._form=document.querySelector(".modal__container"),this._formElement=this._form.querySelectorAll(".modal__input")}_getInputValues(){return this._formInputValues={},inputList.forEach((e=>{this._formInputValues[e.name]=e.value})),inputValues}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",this.handleSubmit)}handleSubmit=e=>(e.preventDefault(),this._handleSubmit(this._getInputValues));handleRemove(e){this._handleSubmit=e}close(){super.close(),this._form.removeEventListener("submit",this.handleSubmit),this._form.reset()}}class n{constructor({items:e,renderer:t},r){this._renderedElements=e,this._renderer=t,this._container=document.querySelector(r)}renderer(){this._renderedElements.forEach((e=>this._renderer(e)))}addItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}}class o{constructor(e,t,r){this._name=e,this._job=t,this._avatar=r}getUserInfo(){return this._userInfo={name:this._name.textContent,job:this._job.textContent}}setUserInfo(e){const{name:t,job:r,userAvatar:s}=e;this._name.textContent=t,this._job.textContent=r,this._avatar.src=s}}const i=document.querySelector(".profile__edit-button"),a=document.querySelector(".modal_type_edit"),l=document.querySelector(".profile__title"),d=document.querySelector(".modal__input_type_title"),c=document.querySelector(".profile__subtitle"),_=document.querySelector(".modal__input_type_subtitle"),h=(document.querySelector(".modal__close-button_type_edit"),document.querySelector(".profile__image")),u=document.querySelector(".profile__image-edit"),m=document.querySelector(".modal_type_avatar"),p=(m.querySelector(".modal__input_type_avatar"),document.querySelector(".modal__close-button_type_avatar"),document.querySelector(".profile__add-button")),b=document.querySelector(".modal_type_add-card"),f=(document.querySelector(".modal__input_type_name"),document.querySelector(".modal__input_type_link"),document.querySelector(".modal__close-button_type_add-card"),document.forms.add),E=(f.elements.title,f.elements.link,document.querySelector(".modal__submit-button"),document.querySelector(".cards__grid"),document.querySelector("#card__template")),k=document.querySelector(".modal_type_big-image"),y=(document.querySelector(".modal__big-image"),document.querySelector(".modal__image-caption"),document.querySelector(".modal__close-button_type_big-image"),document.querySelector(".modal_type_delete-card")),v={formSelector:".modal__container",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_error",errorMessageClass:"modal__error_visible"},S=new class extends r{openup=e=>{const t=e.target;this._modalElement.querySelector(".modal__big-image").src=t.src,this._modalElement.querySelector(".modal__big-image").alt=t.alt,this._modalElement.querySelector(".modal__image-caption").textContent=t.alt,this.open()}}(k);S.setEventListeners();const g=new s({modal:y});function C(e,t){t.querySelector(".modal__submit-button").textContent=e?"Saving...":"Save"}g.setEventListeners();const L=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}getCardList(){return fetch(this._baseUrl+"/cards",{headers:this._headers}).then((function(e){if(e.ok)return e.json().then((e=>e));Promise.reject("Error!"+e.statusText)}))}getUserInfo(){return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error!"+e.statusText)))}getAppInfo(){return Promise.all([this.getCardList(),this.getUserInfo()])}addCard(e){const{name:t,link:r}=e;return fetch(this._baseUrl+"/cards",{headers:this._headers,method:"POST",body:JSON.stringify({name:t,link:r})}).then((e=>{if(e.ok)return e.json();Promise.reject("Error!"+e.statusText)}))}removeCard(e){return fetch(this._baseUrl+"/cards/"+e,{headers:this._headers,method:"DELETE"}).then((e=>e.ok?e.json():Promise.reject("Error!"+e.statusText)))}likeCard(e){return fetch(this._baseUrl+"/cards/likes/"+e,{headers:this._headers,method:"PUT"}).then((e=>{if(e.ok)return e.json();Promise.reject("Error!"+e.statusText)}))}unlikeCard(e){return fetch(this._baseUrl+"/cards/likes/"+e,{headers:this._headers,method:"DELETE"}).then((e=>e.ok?e.json():Promise.reject("Error!"+e.statusText)))}setUserInfo(e){const{name:t,job:r}=e;return fetch(this._baseUrl+"/users/me",{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,job:r})}).then((e=>e.ok?e.json():Promise.reject("Error!"+e.statusText+e.status)))}setUserAvatar(e){return fetch(this._baseUrl+"/users/me/avatar",{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject("Error!"+e.statusText)))}updateUserInfo(e){const{name:t,job:r}=e;return fetch(this._baseUrl+"/users/me",{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:r})}).then((e=>e.ok?e.json():Promise.reject("Error!"+e.statusText)))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"709a0d9d-db06-4890-a594-b07e7309a353","Content-Type":"application/json"}});L.getAppInfo().then((([e,r])=>{const u=new o(l,c,h);u.setUserInfo(r);const f=e=>{const s=new t(e,E,r._id,{onCardClick:({name:e,link:t})=>{S.open(t,e)},removeHandler:e=>{g.open(),g.handleRemove((()=>{L.removeCard(e).then((()=>{s.deleteCardModal(),g.close()})).catch((e=>console.log(e)))}))},likeHandler:e=>{s.isLiked()?L.unlikeCard(e).then((e=>{s.unlikeCard(),s.showLikes(e.likes.lenght)})):L.likeCard(e).then((e=>{s.unlikeCard(),s.showLikes(e.likes.lenght)})).catch((e=>console.log(e)))}});return s},k=new n({items:e,renderer:e=>{k.addItem(f(e).generateCard())}},".cards__grid");console.log(e),k.renderer();const y=new s({modal:b,handleSubmit:e=>{C(!0,b),L.addCard(e).then((e=>{k.prependItem(f(e).generateCard())})).then((()=>{y.close()})).catch((e=>console.log(e))).finally((()=>C(!1,b)))}});p.addEventListener("click",(()=>{j.resetValidation(),y.open()}));const v=new s({modal:a,handleSubmit:e=>{C(!0,a),L.updateUserInfo(o).then((e=>{u.setUserInfo(e)})).then((()=>{v.close()})).catch((e=>console.log(e))).finally((()=>C(!1,a)))}});i.addEventListener("click",(()=>{I.resetValidation();const{name:e,job:t}=u.getUserInfo();d.value=e,_.value=t,v.open()}));const q=new s({modal:m,handleSubmit:e=>{C(!0,m),L.updateUserInfo(e.avatar).then((e=>{u.setUserInfo(e)})).then((()=>{q.close()})).catch((e=>console.log(e))).finally((()=>{C(!1,m)}))}})})).catch((e=>console.log(e)));const q=new s({modal:m,modalSubmition:e=>{!function(e){C(!0,m),L.setUserAvatar({avatar:e.avatarURL}).then((e=>{avatarImage.src=e.avatar,C(!1,m),q.close()})).catch((e=>console.log(e)))}(e)}});u.addEventListener("click",(()=>{q.open()})),q.setEventListeners();const I=new e(v,a);I.enableValidation(),new e(v,m).enableValidation();const j=new e(v,b);j.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQ0p3QyxZQUFZekgsSUFBTWlGLEVBQUl2QyxPQUN0QjZCLEdBQWEsRUFBT2QsR0FDcEI2RCxFQUFXOUcsV0FFWm9HLE9BQU1DLEdBQU9wRyxRQUFRQyxJQUFJbUcsS0FNeEJhLENBQWlCdkssTUFJckJxRyxFQUFpQjFHLGlCQUFpQixTQUFTLEtBQ3pDd0ssRUFBV2hILFVBR2JnSCxFQUFXekcsb0JBSVgsTUFBTXNHLEVBQXdCLElBQUk3TSxFQUFjRSxFQUFZMkksR0FDNURnRSxFQUFzQnBLLG1CQUVPLElBQUl6QyxFQUFjRSxFQUFZaUosR0FDdEMxRyxtQkFFckIsTUFBTWtLLEVBQXdCLElBQUkzTSxFQUFjRSxFQUFZbUosR0FDNURzRCxFQUFzQmxLLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvSW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGZvcm1Db25maWcsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9mb3JtQ29uZmlnID0gZm9ybUNvbmZpZztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpID0+IHtcclxuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvck1lc3NhZ2VDbGFzcyB9ID0gdGhpcy5fZm9ybUNvbmZpZztcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCAjJHtpbnB1dEVsZW1lbnQuaWR9X2Vycm9yIGApO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoZXJyb3JNZXNzYWdlQ2xhc3MpO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5wdXRFcnJvckNsYXNzKTtcclxuICB9O1xyXG4gIFxyXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvck1lc3NhZ2VDbGFzcyB9ID0gdGhpcy5fZm9ybUNvbmZpZztcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCAjJHtpbnB1dEVsZW1lbnQuaWR9X2Vycm9yIGApO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGVycm9yTWVzc2FnZUNsYXNzKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl90b2dnbGVTdWJtaXRCdXR0b24oKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0ID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9jaGVja0lmRm9ybVZhbGlkID0gKCkgPT4gdGhpcy5pbnB1dHMuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcblxyXG4gIF90b2dnbGVTdWJtaXRCdXR0b24oKSB7XHJcbiAgICBjb25zdCB7IGluYWN0aXZlQnV0dG9uQ2xhc3MsIHN1Ym1pdEJ1dHRvblNlbGVjdG9yIH0gPSB0aGlzLl9mb3JtQ29uZmlnO1xyXG4gICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICAgIGlmICh0aGlzLl9jaGVja0lmRm9ybVZhbGlkKCkpIHtcclxuICAgICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgY29uc3QgeyBpbnB1dFNlbGVjdG9yIH0gPSB0aGlzLl9mb3JtQ29uZmlnO1xyXG4gICAgdGhpcy5pbnB1dHMgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoaW5wdXRTZWxlY3RvcikpO1xyXG5cclxuICAgIHRoaXMuaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dChpbnB1dCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlU3VibWl0QnV0dG9uKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybUVsZW1lbnQ7XHJcbiAgfTtcclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoIGRhdGEsIHRlbXBsYXRlLCB1c2VySWQsIFxyXG4gICAgeyBvbkNhcmRDbGljaywgcmVtb3ZlSGFuZGxlciwgbGlrZUhhbmRsZXIgfSApIFxyXG4gIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX3RlbXBsYXRlID0gdGVtcGxhdGU7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcblxyXG4gICAgdGhpcy5fb25DYXJkQ2xpY2sgPSBvbkNhcmRDbGljaztcclxuICAgIHRoaXMuX2xpa2VIYW5kbGVyID0gbGlrZUhhbmRsZXI7XHJcbiAgICB0aGlzLl9yZW1vdmVIYW5kbGVyID0gcmVtb3ZlSGFuZGxlcjtcclxuICB9XHJcbiAgLy8gLS0tIEdldCBjYXJkIHRlbXBsYXRlIC0tLSAvL1xyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gdGhpcy5fdGVtcGxhdGVcclxuICAgIC5jb250ZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcignLmNhcmQnKVxyXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2V0QXR0cmlidXRlcyhjYXJkRWxlbWVudCwgYXR0cmlicykge1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cmlicykge1xyXG4gICAgICBjYXJkRWxlbWVudC5zZXRBdHRyaWJ1dGUoa2V5LCBhdHRyaWJzW2tleV0pO1xyXG4gICAgfVxyXG4gIH1cclxuICAvLyAtLS0gQ2FyZCBkZWxldGluZyBtZXRob2QgLS0tIC8vXHJcbiAgZGVsZXRlQ2FyZCgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xyXG4gICAgaWYoY2FyZEVsZW1lbnQpe1xyXG4gICAgICBjYXJkRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGNhcmRFbGVtZW50KTtcclxuICAgIH1cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICB9XHJcbiAgLy8gLS0tICAtLS0gLy9cclxuICBfcmVuZGVyTGlrZXMgKCkge1xyXG4gICAgdGhpcy5fbGlrZXMuZm9yRWFjaCgobGlrZSkgPT4gXHJcbiAgICAgIGxpa2UuX2lkID09PSB0aGlzLl91c2VySWQgPyB0aGlzLl9saWtlQ2FyZCgpIDogdGhpcy5fdW5saWtlQ2FyZCgpXHJcbiAgICApO1xyXG4gIH1cclxuICAvLyAtLS0gU2hvdyB0aGUgbGlrZSBhbW91bnQgLS0tIC8vXHJcbiAgc2hvd0xpa2VzKGNvdW50KXtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50JykudGV4dENvbnRlbnQgPSBjb3VudDtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBTZXQgZXZlbnRzIGxpc3RlbmVycyBmb3IgdGhlIGNhcmRzIHRoYXQgd2lsbCBiZSBjcmVhdGVkISAtLS0gLy9cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJylcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgICB0aGlzLl9saWtlQ2FyZChldmVudCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ1dHRvbicpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3JlbW92ZUhhbmRsZXIodGhpcy5faWQpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX29uQ2FyZENsaWNrKGV2ZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dEZWxldGVJY29uKCkge1xyXG4gICAgaWYodGhpcy5fdXNlcklkICE9IHRoaXMuX293bmVySWQpIHtcclxuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKS5jbGFzc0xpc3QuYWRkKCdjYXJkX19kZWxldGUtYnV0dG9uX2hpZGRlbicpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLmxpa2VJY29uLmNsYXNzTGlzdC5jb250YWlucygnY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlJyk7XHJcbiAgfVxyXG5cclxuICAvLyAtLS0gQ3JlYXRpbmcgdGhlIGNhcmQgYW5kIGNhcmQgZWxlbWVudHMgLS0tIC8vXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5saWtlSWNvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ1dHRvbicpO1xyXG4gICAgdGhpcy5fc2V0QXR0cmlidXRlcyh0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKSwge1xyXG4gICAgICBzcmM6IHRoaXMuX2xpbmssXHJcbiAgICAgIGFsdDogdGhpcy5fbmFtZVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgdGhpcy5fc2hvd0RlbGV0ZUljb24oKTtcclxuICAgIHRoaXMuc2hvd0xpa2VzKHRoaXMuX2xpa2VzLmxlbmd0aCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfbGlrZUNhcmQoKSB7XHJcbiAgICB0aGlzLmxpa2VJY29uLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZScpO1xyXG4gIH1cclxuXHJcbiAgX3VubGlrZUNhcmQoKSB7XHJcbiAgICB0aGlzLmxpa2VJY29uLmNsYXNzTGlzdC5yZW1vdmUoJ2NhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZScpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbCB7XHJcbiAgY29uc3RydWN0b3IobW9kYWwpIHtcclxuICAgIHRoaXMuX21vZGFsID0gbW9kYWw7XHJcbiAgfVxyXG4gIC8vIC0tLSBPcGVuIG1vZGFsIG1ldGhvZCAtLS0gLy8gXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX21vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF92aXNpYmxlXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2NoZWNrRm9yRXNjQ2xvc2UpO1xyXG4gIH1cclxuICAvLyAtLS0gQ2xvc2UgbW9kYWwgbWV0aG9kIC0tLSAvL1xyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX3Zpc2libGVcIik7XHJcbiAgICBjb25zb2xlLmxvZyhcIkNoZWNrXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2NoZWNrRm9yRXNjQ2xvc2UpO1xyXG4gIH1cclxuICAvLyAtLS0gQ2xvc2UgbW9kYWwgb24gRVNDIG1ldGhvZCAtLS0gLy9cclxuICBfY2xpY2tFc2NIYW5kbGVyID0gKGV2ZW50KSA9PiB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIC8vIC0tLSBDbG9zZSBtb2RhbCBvbiBjbG9zZSgnWCcpIGJ1dHRvbiAtLS0gLy9cclxuICAgIHRoaXMuX21vZGFsXHJcbiAgICAucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b24nKVxyXG4gICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgdGhpcy5jbG9zZShldmVudCk7XHJcbiAgICB9KTtcclxuICAgIC8vIENsb3NlIG1vZGFsIG9uIG92ZXJsYXkob3V0IG9mIHRoZSBtb2RhbCkgY2xpY2sgLS0tIC8vL1xyXG4gICAgdGhpcy5fbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX3Zpc2libGVcIikpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKGV2ZW50KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59IiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhGb3JtIGV4dGVuZHMgTW9kYWwge1xyXG4gIGNvbnN0cnVjdG9yKHttb2RhbCwgaGFuZGxlU3VibWl0fSkge1xyXG4gICAgc3VwZXIobW9kYWwpO1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gaGFuZGxlU3VibWl0O1xyXG4gICAgdGhpcy5fZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY29udGFpbmVyJyk7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCgnLm1vZGFsX19pbnB1dCcpO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgdGhpcy5fZm9ybUlucHV0VmFsdWVzID0ge307XHJcbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5fZm9ybUlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuaGFuZGxlU3VibWl0KTtcclxuICB9XHJcblxyXG4gIGhhbmRsZVN1Ym1pdCA9IChldmVudCkgPT57XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB0aGlzLl9oYW5kbGVTdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMpO1xyXG5cclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcblxyXG4gIGhhbmRsZVJlbW92ZShoYW5kbGUpIHtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX2Zvcm0ucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5oYW5kbGVTdWJtaXQpO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlZEVsZW1lbnRzID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJlcigpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVkRWxlbWVudHMuZm9yRWFjaCgoaXRlbSkgPT4gdGhpcy5fcmVuZGVyZXIoaXRlbSkpO1xyXG4gIH1cclxuICBcclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoaXRlbSk7XHJcbiAgfVxyXG5cclxuICBwcmVwZW5kSXRlbShpdGVtKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWUsIGpvYiwgYXZhdGFyKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcclxuICAgIHRoaXMuX2pvYiA9IGpvYjtcclxuICAgIHRoaXMuX2F2YXRhciA9IGF2YXRhcjtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuICh0aGlzLl91c2VySW5mbyA9IHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgam9iOiB0aGlzLl9qb2IudGV4dENvbnRlbnRcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8odXNlckluZm8pIHtcclxuICAgIGNvbnN0IHsgbmFtZSwgam9iLCB1c2VyQXZhdGFyIH0gPSB1c2VySW5mbztcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fam9iLnRleHRDb250ZW50ID0gam9iO1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IHVzZXJBdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsIi8vIC0tLSAnRWRpdCBwcm9maWxlJyBtb2RhbCBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfdHlwZV9lZGl0Jyk7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX190aXRsZScpO1xyXG5leHBvcnQgY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX3RpdGxlJyk7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlSm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3N1YnRpdGxlJyk7XHJcbmV4cG9ydCBjb25zdCBqb2JJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW5wdXRfdHlwZV9zdWJ0aXRsZScpO1xyXG5leHBvcnQgY29uc3QgZWRpdENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9lZGl0Jyk7XHJcbi8vIC0tLSAnQXZhdGFyXCIgbW9kYWwgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgdXNlckF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19pbWFnZScpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19pbWFnZS1lZGl0Jyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2F2YXRhcicpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyTW9kYWxJbnB1dCA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW5wdXRfdHlwZV9hdmF0YXInKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhckNsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9hdmF0YXInKVxyXG4vLyAtLS0gJ0FkZC1jYXJkJyBtb2RhbCBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2FkZC1jYXJkJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkSW5wdXRUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW5wdXRfdHlwZV9uYW1lJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkSW5wdXRMaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX2xpbmsnKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UtYnV0dG9uX3R5cGVfYWRkLWNhcmQnKTtcclxuLy8gLS0tICdBZGQtQ2FyZCcgZm9ybSBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zLmFkZDtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtVGl0ZWwgPSBhZGRDYXJkRm9ybS5lbGVtZW50cy50aXRsZTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtTGluayA9IGFkZENhcmRGb3JtLmVsZW1lbnRzLmxpbms7XHJcbi8vIC0tLSBHZW5lcmFsIGNvbnN0IC0tLSAvL1xyXG5leHBvcnQgY29uc3Qgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19zdWJtaXQtYnV0dG9uJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkc19fZ3JpZCcpO1xyXG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NhcmRfX3RlbXBsYXRlJyk7XHJcbi8vIC0tLSBCaWcgaW1hZ2UgbW9kYWwgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgY2FyZEJpZ01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfYmlnLWltYWdlJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkQmlnTW9kYWxJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fYmlnLWltYWdlJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkQmlnTW9kYWxUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbWFnZS1jYXB0aW9uJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkQmlnTW9kYWxDbG9zZUljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX2JpZy1pbWFnZScpO1xyXG4vLyAtLS0gJ0RlbGV0ZSBjYXJkJyBtb2RhbCBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBkZWxldGVDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF90eXBlX2RlbGV0ZS1jYXJkXCIpO1xyXG4vLyAtLS0gRm9ybSBjb25maWcgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgZm9ybUNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19jb250YWluZXJcIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF9lcnJvclwiLFxyXG4gIGVycm9yTWVzc2FnZUNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCJcclxufTtcclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgTW9kYWxXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9Nb2RhbFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgTW9kYWxXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL0FwaS5qc1wiXHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIHByb2ZpbGVOYW1lLFxyXG4gIG5hbWVJbnB1dCxcclxuICBwcm9maWxlSm9iLFxyXG4gIGpvYklucHV0LFxyXG4gIGVkaXRCdXR0b24sXHJcbiAgcHJvZmlsZU1vZGFsLFxyXG4gIGNhcmRUZW1wbGF0ZSxcclxuICBhZGRDYXJkQnV0dG9uLFxyXG4gIGFkZENhcmRNb2RhbCxcclxuICBhdmF0YXJNb2RhbCxcclxuICB1c2VyQXZhdGFyLFxyXG4gIGF2YXRhckVkaXRCdXR0b24sXHJcbiAgY2FyZEJpZ01vZGFsLFxyXG4gIGRlbGV0ZUNhcmQsXHJcbiAgZm9ybUNvbmZpZ1xyXG59IGZyb20gXCIuLi9jb21wb25lbnRzL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuLy8gPT09PT0gTW9kYWxzID09PT09IC8vXHJcbi8vIC0tLSBCaWcgaW1hZ2UgbW9kYWwgaW5zdGFuY2UgLS0tIC8vXHJcbmNvbnN0IGJpZ0ltYWdlID0gbmV3IE1vZGFsV2l0aEltYWdlKGNhcmRCaWdNb2RhbCk7XHJcbmJpZ0ltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbi8vIC0tLSBEZWxldGUgY2FyZCBtb2RhbCBpbnN0YW5jZSBhbmQgZXZlbnRzIC0tLSAvL1xyXG5jb25zdCBkZWxldGVDYXJkTW9kYWwgPSBuZXcgTW9kYWxXaXRoRm9ybSh7XHJcbiAgbW9kYWw6IGRlbGV0ZUNhcmRcclxufSk7XHJcbmRlbGV0ZUNhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4vLyAtLS0gVVggZm9yIG1vZGFscyAtLS0gLy9cclxuZnVuY3Rpb24gbG9hZGluZ01vZGFsKGlzTG9hZGluZywgbW9kYWwpIHtcclxuICBpZiAoaXNMb2FkaW5nKSB7IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIikudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiOyB9IFxyXG4gIGVsc2UgeyBtb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIpLnRleHRDb250ZW50ID0gXCJTYXZlXCI7IH1cclxufVxyXG5cclxuLy8gPT09PT0gQVBJID09PT09IC8vXHJcbi8vIC0tLSBTZXR0aW5nIHRoZSBkZWZhdWx0IGZldGNoaW5nIHVybCBhbmQgdG9rZW4gLS0tIC8vXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxyXG4gIGhlYWRlcnM6IFxyXG4gIHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiNzA5YTBkOWQtZGIwNi00ODkwLWE1OTQtYjA3ZTczMDlhMzUzXCIsXHJcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIFxyXG4gIH1cclxufSk7XHJcbi8vIC0tLSBHZXRBcHBJbmZvIG1ldGhvZCAtLS0gLy9cclxuYXBpXHJcbiAgLmdldEFwcEluZm8oKVxyXG4gIC50aGVuKCAoW2NhcmRMaXN0LCB1c2VyRGF0YV0pID0+IHtcclxuICAgIC8vIC0tLSAnUHJvZmlsZScgaW5mbyBlZGl0aW5nIC0tLSAvL1xyXG4gICAgY29uc3QgcHJvZmlsZSA9IG5ldyBVc2VySW5mbyhwcm9maWxlTmFtZSwgcHJvZmlsZUpvYiwgdXNlckF2YXRhcik7XHJcbiAgICBwcm9maWxlLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcclxuICAgIC8vIC0tLSBOZXcgY2FyZCBhZGRpbmcgLS0tIC8vXHJcbiAgICBjb25zdCBhZGRpbmdOZXdDYXJkID0gKGRhdGEpID0+e1xyXG4gICAgICBjb25zdCBjYXJkSW5zdGFuY2UgPSBuZXcgQ2FyZChkYXRhLCBjYXJkVGVtcGxhdGUsIHVzZXJEYXRhLl9pZCwge1xyXG4gICAgICAgIG9uQ2FyZENsaWNrOiAoe25hbWUsIGxpbmt9KSA9PiB7XHJcbiAgICAgICAgICBiaWdJbWFnZS5vcGVuKGxpbmssIG5hbWUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcmVtb3ZlSGFuZGxlcjogKGNhcmRJZCkgPT4ge1xyXG4gICAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLm9wZW4oKTtcclxuICAgICAgICAgIGRlbGV0ZUNhcmRNb2RhbC5oYW5kbGVSZW1vdmUoKCkgPT4ge1xyXG4gICAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgICAucmVtb3ZlQ2FyZChjYXJkSWQpXHJcbiAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY2FyZEluc3RhbmNlLmRlbGV0ZUNhcmRNb2RhbCgpO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBsaWtlSGFuZGxlcjogKGNhcmRJZCkgPT57XHJcbiAgICAgICAgICBjb25zdCBsaWtlVG9nZ2xlID0gY2FyZEluc3RhbmNlLmlzTGlrZWQoKTtcclxuICAgICAgICAgIGlmKGxpa2VUb2dnbGUpIHtcclxuICAgICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgICAgLnVubGlrZUNhcmQoY2FyZElkKVxyXG4gICAgICAgICAgICAgIC50aGVuKChjb3VudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY2FyZEluc3RhbmNlLnVubGlrZUNhcmQoKTtcclxuICAgICAgICAgICAgICAgIGNhcmRJbnN0YW5jZS5zaG93TGlrZXMoY291bnQubGlrZXMubGVuZ2h0KTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgICAubGlrZUNhcmQoY2FyZElkKVxyXG4gICAgICAgICAgICAgIC50aGVuKChjb3VudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY2FyZEluc3RhbmNlLnVubGlrZUNhcmQoKTtcclxuICAgICAgICAgICAgICAgIGNhcmRJbnN0YW5jZS5zaG93TGlrZXMoY291bnQubGlrZXMubGVuZ2h0KTtcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gY2FyZEluc3RhbmNlO1xyXG4gICAgfTtcclxuICAgIC8vIC0tLSBDYXJkcyBzZWN0aW9uIGNyZWF0aW9uIC0tLSAvL1xyXG4gICAgY29uc3QgY2FyZHNMaXN0ID0gbmV3IFNlY3Rpb24oe1xyXG4gICAgICBpdGVtczogY2FyZExpc3QsXHJcbiAgICAgIHJlbmRlcmVyOiAoZGF0YSkgPT4ge1xyXG4gICAgICAgIGNhcmRzTGlzdC5hZGRJdGVtKGFkZGluZ05ld0NhcmQoZGF0YSkuZ2VuZXJhdGVDYXJkKCkpO1xyXG4gICAgICB9XHJcbiAgICB9LCBcclxuICAgICcuY2FyZHNfX2dyaWQnKTtcclxuICAgIGNvbnNvbGUubG9nKGNhcmRMaXN0KTtcclxuICAgIC8vIC0tLSBSZW5kZXIgY2FyZHMgLS0tIC8vXHJcbiAgICBjYXJkc0xpc3QucmVuZGVyZXIoKTtcclxuICAgIC8vIC0tLSBOZXcgY2FyZCBhZGRpbmcgZm9ybSAtLS0gLy9cclxuICAgIGNvbnN0IGFkZENhcmRGb3JtID0gbmV3IE1vZGFsV2l0aEZvcm0oe1xyXG4gICAgICBtb2RhbDogYWRkQ2FyZE1vZGFsLFxyXG4gICAgICBoYW5kbGVTdWJtaXQ6IChkYXRhKSA9PntcclxuICAgICAgICBsb2FkaW5nTW9kYWwodHJ1ZSwgYWRkQ2FyZE1vZGFsKTtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5hZGRDYXJkKGRhdGEpXHJcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmRzTGlzdC5wcmVwZW5kSXRlbShhZGRpbmdOZXdDYXJkKHJlcykuZ2VuZXJhdGVDYXJkKCkpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgYWRkQ2FyZEZvcm0uY2xvc2UoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgICAgICAgIC5maW5hbGx5KCgpID0+IGxvYWRpbmdNb2RhbChmYWxzZSwgYWRkQ2FyZE1vZGFsKSk7XHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIC8vIC0tLSBBZGQgY2FyZCBidXR0b24gZnVuY3Rpb25hbCBhZGRpbmcgLS0tIC8vXHJcbiAgICBhZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIGFkZENhcmRGb3JtVmFsaWRhdGlvbi5yZXNldFZhbGlkYXRpb24oKTtcclxuICAgICAgYWRkQ2FyZEZvcm0ub3BlbigpO1xyXG4gICAgfSk7XHJcbiAgICAvLyAtLS0gUHJvZmlsZSBlZGl0IGZvcm0gLS0tIC8vXHJcbiAgICBjb25zdCBwcm9maWxlRm9ybSA9IG5ldyBNb2RhbFdpdGhGb3JtKHtcclxuICAgICAgbW9kYWw6IHByb2ZpbGVNb2RhbCwgXHJcbiAgICAgIGhhbmRsZVN1Ym1pdDogKHVzZXJJbmZvKSA9PiB7XHJcbiAgICAgICAgbG9hZGluZ01vZGFsKHRydWUsIHByb2ZpbGVNb2RhbCk7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgLnVwZGF0ZVVzZXJJbmZvKFVzZXJJbmZvKVxyXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIHByb2ZpbGUuc2V0VXNlckluZm8ocmVzKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgcHJvZmlsZUZvcm0uY2xvc2UoKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4gbG9hZGluZ01vZGFsKGZhbHNlLHByb2ZpbGVNb2RhbCkpXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgLy8gLS0tIE9wZW4gJ1Byb2ZpbGUnIGZvcm0gd2l0aCBjdXJyZW50IHZhbHVlcyBhcyBpbnB1dHMgLS0tIC8vXHJcbiAgICBlZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICBwcm9maWxlRm9ybVZhbGlkYXRpb24ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgICAgIGNvbnN0IHsgbmFtZSwgam9iIH0gPSBwcm9maWxlLmdldFVzZXJJbmZvKCk7XHJcbiAgICAgIG5hbWVJbnB1dC52YWx1ZSA9IG5hbWU7XHJcbiAgICAgIGpvYklucHV0LnZhbHVlID0gam9iO1xyXG4gICAgICBwcm9maWxlRm9ybS5vcGVuKCk7XHJcbiAgICB9KTtcclxuICAgIC8vIC0tLSAnQXZhdGFyJyBlZGl0L3VwZGF0ZSBmb3JtIC0tLSAvL1xyXG4gICAgY29uc3QgYXZhdGFyRm9ybSA9IG5ldyBNb2RhbFdpdGhGb3JtKHtcclxuICAgICAgbW9kYWw6IGF2YXRhck1vZGFsLFxyXG4gICAgICBoYW5kbGVTdWJtaXQ6IChpbWdMaW5rKSA9PiB7XHJcbiAgICAgICAgbG9hZGluZ01vZGFsKHRydWUsIGF2YXRhck1vZGFsKTtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC51cGRhdGVVc2VySW5mbyhpbWdMaW5rLmF2YXRhcilcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgcHJvZmlsZS5zZXRVc2VySW5mbyhyZXMpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgYXZhdGFyRm9ybS5jbG9zZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBsb2FkaW5nTW9kYWwoZmFsc2UsIGF2YXRhck1vZGFsKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcbn0pXHJcbi5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuXHJcbi8vID09PT09IEF2YXRhciA9PT09PSAvL1xyXG4vLyAtLS0gJ0F2YXRhcicgZm9ybSBmdW5jdGlvbmFsIC0tLSAvL1xyXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJFZGl0KGRhdGEpIHtcclxuICBsb2FkaW5nTW9kYWwodHJ1ZSwgYXZhdGFyTW9kYWwpO1xyXG4gIGFwaS5zZXRVc2VyQXZhdGFyKHtcclxuICAgIGF2YXRhcjogZGF0YS5hdmF0YXJVUkxcclxuICB9KVxyXG4gIC50aGVuKHJlcyA9PiB7XHJcbiAgICBhdmF0YXJJbWFnZS5zcmMgPSByZXMuYXZhdGFyO1xyXG4gICAgbG9hZGluZ01vZGFsKGZhbHNlLCBhdmF0YXJNb2RhbCk7XHJcbiAgICBlZGl0QXZhdGFyLmNsb3NlKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG59XHJcbi8vIC0tLSAnQXZhdGFyJyBmb3JtIGNyZWF0aW9uIC0tLSAvL1xyXG5jb25zdCBlZGl0QXZhdGFyID0gbmV3IE1vZGFsV2l0aEZvcm0oe1xyXG4gIG1vZGFsOiBhdmF0YXJNb2RhbCxcclxuICBtb2RhbFN1Ym1pdGlvbjogKGRhdGEpID0+IHtcclxuICAgIGhhbmRsZUF2YXRhckVkaXQoZGF0YSlcclxuICB9XHJcbn0pO1xyXG4vLyAtLS0gT3BlbiBhdmF0YXIgZWRpdCBtb2RhbCBvbiBjbGljayAtLS0gLy9cclxuYXZhdGFyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRBdmF0YXIub3BlbigpO1xyXG59KTtcclxuLy8gLS0tICdBdmF0YXInIGZvcm0gaGFuZGxlciAtLS0gLy9cclxuZWRpdEF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gPT09PT0gVmFsaWRhdGlvbiA9PT09PSAvL1xyXG4vLyAtLS0gJ0VkaXQgcHJvZmlsZScgZm9ybSB2YWxpZGF0aW9uIGFkZGluZyAtLS0gLy9cclxuY29uc3QgcHJvZmlsZUZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgcHJvZmlsZU1vZGFsKTtcclxucHJvZmlsZUZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuLy8gLS0tICdBdmF0YXInIGZvcm0gdmFsaWRhdGlvbiBhZGRpbmcgLS0tIC8vXHJcbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgYXZhdGFyTW9kYWwpO1xyXG5hdmF0YXJGb3JtVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbi8vIC0tLSAnQWRkIGNhcmQnIGZvcm0gdmFsaWRhdGlvbiBhZGRpbmcgLS0tIC8vXHJcbmNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGFkZENhcmRNb2RhbCk7XHJcbmFkZENhcmRGb3JtVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxXaXRoSW1hZ2UgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgLy8gLS0tIE9wZW4gYmlnIGltYWdlIG1vZGFsIG1ldGhvZCAtLS0gLy9cclxuICBvcGVudXAgPSAoZXZlbnQpID0+IHtcclxuICAgIGNvbnN0IGJpZ0ltYWdlID0gZXZlbnQudGFyZ2V0O1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2JpZy1pbWFnZVwiKS5zcmMgPSBiaWdJbWFnZS5zcmM7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYmlnLWltYWdlXCIpLmFsdCA9IGJpZ0ltYWdlLmFsdDtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1jYXB0aW9uXCIpLnRleHRDb250ZW50ID0gYmlnSW1hZ2UuYWx0O1xyXG5cclxuICAgIHRoaXMub3BlbigpO1xyXG4gIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICAvLyA9PT0gR2V0dGluZyBpbmZvIGZyb20gc2VydmVyID09PSAvL1xyXG4gIC8vIC0tLSBHZXQgY2FyZCBsaXN0IGZyb20gdGhlIHNlcnZlciAtLS0gLy9cclxuICBnZXRDYXJkTGlzdCgpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkc1wiLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgfSlcclxuICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBQcm9taXNlLnJlamVjdChcIkVycm9yIVwiICsgcmVzLnN0YXR1c1RleHQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICApO1xyXG4gIH1cclxuICAvLyAtLS0gR2V0IHVzZXIgaW5mbyBmcm9tIHRoZSBzZXJ2ZXIgLS0tIC8vXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvdXNlcnMvbWVcIiwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oKHJlcykgPT5cclxuICAgICAgICAgIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChcIkVycm9yIVwiICsgcmVzLnN0YXR1c1RleHQpXHJcbiAgICAgICAgKVxyXG4gICAgKTtcclxuICB9XHJcbiAgLy8gLS0tIENoZWNrIGlmIGFsbCBpbmZvIGZldGNoZWQgLS0tIC8vXHJcbiAgZ2V0QXBwSW5mbygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRDYXJkTGlzdCgpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcclxuICB9XHJcblxyXG4gIC8vID09PSBBZGRpbmcvUmVtb3ZpbmcvRWRpdGluZyA9PT0gLy9cclxuICAvLyAtLS0gQWRkaW5nIG5ldyBjYXJkIC0tLSAvL1xyXG4gIGFkZENhcmQoZGF0YSkge1xyXG4gICAgY29uc3Qge25hbWUsIGxpbmt9ID0gZGF0YTtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHNcIiwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgUHJvbWlzZS5yZWplY3QoXCJFcnJvciFcIiArIHJlcy5zdGF0dXNUZXh0KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8vIC0tLSBSZW1vdmluZyBhIGNhcmQgLS0tIC8vXHJcbiAgcmVtb3ZlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHMvXCIgKyBjYXJkSWQsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgfSkudGhlbigocmVzKSA9PlxyXG4gICAgICByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QoXCJFcnJvciFcIiArIHJlcy5zdGF0dXNUZXh0KVxyXG4gICAgKTtcclxuICB9XHJcbiAgLy8gLS0tIExpa2UgYSBjYXJkIC0tLSAvL1xyXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9saWtlcy9cIiArIGNhcmRJZCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIFByb21pc2UucmVqZWN0KFwiRXJyb3IhXCIgKyByZXMuc3RhdHVzVGV4dCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuICAvLyAtLS0gVW5saWtlIGEgY2FyZCAtLS0gLy9cclxuICB1bmxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9saWtlcy9cIiArIGNhcmRJZCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICB9KS50aGVuKChyZXMpID0+XHJcbiAgICAgIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChcIkVycm9yIVwiICsgcmVzLnN0YXR1c1RleHQpXHJcbiAgICApO1xyXG4gIH1cclxuICAvLyAtLS0gU2V0dGluZyB1c2VyIHByb2ZpbGUgaW5mbyAtLS0gLy9cclxuICBzZXRVc2VySW5mbyggdXNlckluZm8gKSB7XHJcbiAgICBjb25zdCB7IG5hbWUsIGpvYiB9ID0gdXNlckluZm87XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvdXNlcnMvbWVcIiwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgbmFtZSxcclxuICAgICAgICAgIGpvYixcclxuICAgICAgICB9KSxcclxuICAgICAgfSlcclxuICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLm9rXHJcbiAgICAgICAgICAgID8gcmVzLmpzb24oKVxyXG4gICAgICAgICAgICA6IFByb21pc2UucmVqZWN0KFwiRXJyb3IhXCIgKyByZXMuc3RhdHVzVGV4dCArIHJlcy5zdGF0dXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICApO1xyXG4gIH1cclxuICAvLyAtLS0gU2V0dGluZyB1c2VyIHByb2ZpbGUgYXZhdGFyIC0tLSAvL1xyXG4gIHNldFVzZXJBdmF0YXIobGluaykge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi91c2Vycy9tZS9hdmF0YXJcIiwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+XHJcbiAgICAgIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChcIkVycm9yIVwiICsgcmVzLnN0YXR1c1RleHQpXHJcbiAgICApO1xyXG4gIH1cclxuICAvLyAtLS0gVXBkYXRpbmcvRWRpdGluZyB1c2VyIHByb2ZpbGUgaW5mbyAtLS0gLy9cclxuICB1cGRhdGVVc2VySW5mbyh1c2VySW5mbykge1xyXG4gICAgY29uc3QgeyBuYW1lLCBqb2IgfSA9IHVzZXJJbmZvO1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBhYm91dDogam9iLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KFwiRXJyb3IhXCIgKyByZXMuc3RhdHVzVGV4dCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsImZvcm1Db25maWciLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfZm9ybUNvbmZpZyIsIl9mb3JtRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yTWVzc2FnZUNsYXNzIiwiZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dHMiLCJmb3JFYWNoIiwiaW5wdXQiLCJfdG9nZ2xlU3VibWl0QnV0dG9uIiwiX2NoZWNrSW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfY2hlY2tJZkZvcm1WYWxpZCIsImV2ZXJ5IiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiYnV0dG9uRWxlbWVudCIsImRpc2FibGVkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiaW5wdXRTZWxlY3RvciIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJhZGRFdmVudExpc3RlbmVyIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJDYXJkIiwiZGF0YSIsInRlbXBsYXRlIiwidXNlcklkIiwib25DYXJkQ2xpY2siLCJyZW1vdmVIYW5kbGVyIiwibGlrZUhhbmRsZXIiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfbGlrZXMiLCJsaWtlcyIsIl9vd25lcklkIiwib3duZXIiLCJfaWQiLCJfdGVtcGxhdGUiLCJfdXNlcklkIiwiX29uQ2FyZENsaWNrIiwiX2xpa2VIYW5kbGVyIiwiX3JlbW92ZUhhbmRsZXIiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEF0dHJpYnV0ZXMiLCJjYXJkRWxlbWVudCIsImF0dHJpYnMiLCJrZXkiLCJzZXRBdHRyaWJ1dGUiLCJkZWxldGVDYXJkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsIl9jYXJkRWxlbWVudCIsIl9yZW5kZXJMaWtlcyIsImxpa2UiLCJfbGlrZUNhcmQiLCJfdW5saWtlQ2FyZCIsInNob3dMaWtlcyIsImNvdW50IiwiX3Nob3dEZWxldGVJY29uIiwiaXNMaWtlZCIsImxpa2VJY29uIiwiY29udGFpbnMiLCJnZW5lcmF0ZUNhcmQiLCJzcmMiLCJhbHQiLCJsZW5ndGgiLCJNb2RhbCIsIm1vZGFsIiwiX21vZGFsIiwib3BlbiIsIl9jaGVja0ZvckVzY0Nsb3NlIiwiY2xvc2UiLCJjb25zb2xlIiwibG9nIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIl9jbGlja0VzY0hhbmRsZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsIk1vZGFsV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVTdWJtaXQiLCJfZm9ybSIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtSW5wdXRWYWx1ZXMiLCJpbnB1dExpc3QiLCJ2YWx1ZSIsImlucHV0VmFsdWVzIiwiaGFuZGxlUmVtb3ZlIiwiaGFuZGxlIiwicmVzZXQiLCJTZWN0aW9uIiwiaXRlbXMiLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX3JlbmRlcmVkRWxlbWVudHMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiaXRlbSIsImFkZEl0ZW0iLCJhcHBlbmQiLCJwcmVwZW5kSXRlbSIsInByZXBlbmQiLCJVc2VySW5mbyIsImpvYiIsImF2YXRhciIsIl9qb2IiLCJfYXZhdGFyIiwiZ2V0VXNlckluZm8iLCJfdXNlckluZm8iLCJzZXRVc2VySW5mbyIsInVzZXJJbmZvIiwidXNlckF2YXRhciIsImVkaXRCdXR0b24iLCJwcm9maWxlTW9kYWwiLCJwcm9maWxlTmFtZSIsIm5hbWVJbnB1dCIsInByb2ZpbGVKb2IiLCJqb2JJbnB1dCIsImF2YXRhckVkaXRCdXR0b24iLCJhdmF0YXJNb2RhbCIsImFkZENhcmRCdXR0b24iLCJhZGRDYXJkTW9kYWwiLCJhZGRDYXJkRm9ybSIsImZvcm1zIiwiY2FyZFRlbXBsYXRlIiwiZWxlbWVudHMiLCJ0aXRsZSIsImNhcmRCaWdNb2RhbCIsImZvcm1TZWxlY3RvciIsImJpZ0ltYWdlIiwib3BlbnVwIiwiX21vZGFsRWxlbWVudCIsImRlbGV0ZUNhcmRNb2RhbCIsImxvYWRpbmdNb2RhbCIsImlzTG9hZGluZyIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldENhcmRMaXN0IiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1c1RleHQiLCJnZXRBcHBJbmZvIiwiYWxsIiwiYWRkQ2FyZCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwicmVtb3ZlQ2FyZCIsImNhcmRJZCIsImxpa2VDYXJkIiwidW5saWtlQ2FyZCIsInN0YXR1cyIsInNldFVzZXJBdmF0YXIiLCJ1cGRhdGVVc2VySW5mbyIsImFib3V0IiwiYXV0aG9yaXphdGlvbiIsImNhcmRMaXN0IiwidXNlckRhdGEiLCJwcm9maWxlIiwiYWRkaW5nTmV3Q2FyZCIsImNhcmRJbnN0YW5jZSIsImNhdGNoIiwiZXJyIiwibGVuZ2h0IiwiY2FyZHNMaXN0IiwiZmluYWxseSIsImFkZENhcmRGb3JtVmFsaWRhdGlvbiIsInByb2ZpbGVGb3JtIiwicHJvZmlsZUZvcm1WYWxpZGF0aW9uIiwiYXZhdGFyRm9ybSIsImltZ0xpbmsiLCJlZGl0QXZhdGFyIiwibW9kYWxTdWJtaXRpb24iLCJhdmF0YXJVUkwiLCJhdmF0YXJJbWFnZSIsImhhbmRsZUF2YXRhckVkaXQiXSwic291cmNlUm9vdCI6IiJ9