!function(){var e={389:function(){const e=(e,t)=>fetch(e,t).then((e=>{if(e.ok)return e.json();Promise.reject(`ERROR: ${e.statusText}`)}));new class{constructor(e,t){this.baseUrl=e,this.headers=t}getInitialCards(){return e(`${this._baseUrl}/cards`,{headers:this._headers})}getUserInfo(){return e(`${this._baseUrl}/users/me`,{headers:this._headers})}setUserAvatar(t){return e(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t.link})})}sendNewData(t){return e(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t.name,job:t.job})})}createNewCard(t){return e(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t.name,link:t.link})})}removeCard(t){return e(`${this._baseUrl}/cards/${t}`,{method:"DELETE",headers:this._headers})}addLike(t){return e(`${this._baseUrl}/cards/likes/${t}`,{method:"PUT",headers:this._headers})}removeLike(t){return e(`${this._baseUrl}/cards/likes/${t}`,{method:"DELETE",headers:this._headers})}}({baseUrl:"https://around.nomoreparties.co/v1/group-2",headers:{authorization:"709a0d9d-db06-4890-a594-b07e7309a353"}})}},t={};function s(r){var i=t[r];if(void 0!==i)return i.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,s),n.exports}!function(){"use strict";var e=s(389);class t{constructor({cardData:e,user:t,onCardClick:s,removeHandler:r,likeHandler:i},n){this._name=e.name,this._link=e.link,this._cardId=e._id,this._ownerId=e.owner._id,this._userID=t,this._likes=e.likes,this._cardSelector=n,this._onCardClick=s,this._likeHandler=i,this._removeHandler=r}_getTemplate(){return document.querySelector("#card__template").content.querySelector(".card").cloneNode(!0)}deleteCard(){this._item.remove(),this._item=null}_renderLikes(){this.isLiked()?this._item.querySelector(".card__like-button").classList.add("card__like-button_active"):this._item.querySelector(".card__like-button").classList.remove("card__like-button_active"),this._item.querySelector(".card__like-counter").textContent=this._likes.length}isLiked(){return this._likes.some((e=>e._id===this._userId))}updateLikes(e){this._likes=e,this._renderLikes()}_setEventListeners(){this._item.querySelector(".card__like-button").addEventListener("click",(e=>{this._likeCard(e)})),this._item.querySelector(".card__delete-button").addEventListener("click",(()=>{this._removeHandler(this._cardId)})),this._cardImage.addEventListener("click",(e=>{this._onCardClick(e)}))}generateCard(){return this._item=this._getTemplate(),this._ownerId!==this._userId&&this._element.querySelector(".card__delete-button").classList.add("card__delete-button_hidden"),this._cardImage=this._item.querySelector(".card__image"),this._item.querySelector(".card__title").textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=`Image of  ${this._name} `,this._renderLikes(),this._setEventListeners(),this._item}}class r{constructor(e,t){this._formConfig=e,this._formElement=t}_showInputError=(e,t)=>{const{inputErrorClass:s,errorMessageClass:r}=this._formConfig,i=this._formElement.querySelector(` #${e.id}_error `);i.textContent=t,i.classList.add(r),e.classList.add(s)};_hideInputError=e=>{const{inputErrorClass:t,errorMessageClass:s}=this._formConfig,r=this._formElement.querySelector(` #${e.id}_error `);r.textContent="",r.classList.remove(s),e.classList.remove(t)};resetValidation(){this.inputs.forEach((e=>{this._hideInputError(e)})),this._toggleSubmitButton()}_checkInput=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)};_checkIfFormValid=()=>this.inputs.every((e=>e.validity.valid));_toggleSubmitButton(){const{inactiveButtonClass:e,submitButtonSelector:t}=this._formConfig,s=this._formElement.querySelector(t);this._checkIfFormValid()?(s.disabled=!1,s.classList.remove(e)):(s.disabled=!0,s.classList.add(e))}_setEventListeners=()=>{const{inputSelector:e}=this._formConfig;return this.inputs=Array.from(this._formElement.querySelectorAll(e)),this.inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInput(e),this._toggleSubmitButton()}))})),this._formElement};enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const i=document.querySelector(".profile__edit-button"),n=document.forms.profile,a=(n.elements.name,n.elements.job,document.querySelector(".modal__close-button_type_edit"),document.querySelector(".profile__image-edit")),o=document.querySelector(".modal_type_avatar"),l=(document.querySelector(".modal__input_type_avatar"),document.querySelector(".modal__close-button_type_avatar"),document.querySelector(".profile__add-button")),d=document.querySelector(".modal_type_add-card"),c=(document.querySelector(".modal__input_type_name"),document.querySelector(".modal__input_type_link"),document.querySelector(".modal__close-button_type_add-card"),document.forms.add),_=(c.elements.title,c.elements.link,document.querySelector(".modal__submit-button"),document.querySelector(".cards__grid"),document.querySelector(".modal_type_big-image"),document.querySelector(".modal__big-image"),document.querySelector(".modal__image-caption"),document.querySelector(".modal__close-button_type_big-image"),{formSelector:".modal__container",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_error",errorMessageClass:"modal__error_visible"});class m{constructor(e){this._modalElement=document.querySelector(e)}_checkForEscClose=e=>{"Escape"===e.key&&this.close()};open=()=>{this._modalElement.classList.add("modal_visible"),document.addEventListener("keyup",this._checkForEscClose)};close=()=>{this._modalElement.classList.remove("modal_visible"),document.removeEventListener("keyup",this._checkForEscClose)};setEventListeners(){this._modalElement.querySelector(".modal__close-button").addEventListener("click",(e=>{this.close(e)})),this._modalElement.addEventListener("click",(e=>{e.target.classList.contains("modal_visible")&&this.close(e)}))}}class u extends m{constructor(e,t){super(e),this._handleSubmitBtn=t,this._formElement=this._modalElement.querySelector(".modal__container")}getInputValues(){const e=Array.from(this._formElement.querySelectorAll(".modal__input")),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setInputValues(e){Array.from(this._formElement.querySelectorAll(".modal__input")).forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(()=>{this._handleSubmitBtn(this.getInputValues()),this.close(),this._formElement.reset()}))}close(){super.close(),this._formElement.reset()}}class h extends m{constructor(e,t){super(e),this._form=document.querySelector(this._selector),this._handleSubmit=t,this._handleSubmitHandler=this._handleSubmitHandler.bind(this)}_handleSubmitHandler(e){e.preventDefault(),this._handleSubmit(),super.close()}_setEventListeners(){super._setEventListeners(),this._form.addEventListener("submit",this._handleSubmitHandler)}_removeEventListeners(){super._removeEventListeners(),this._form.removeEventListener("submit",this._handleSubmitHandler)}}const p=new class extends m{openup=e=>{const t=e.target;this._modalElement.querySelector(".modal__big-image").src=t.src,this._modalElement.querySelector(".modal__big-image").alt=t.alt,this._modalElement.querySelector(".modal__image-caption").textContent=t.alt,this.open()}}(".modal_type_big-image");new u(".modal_type_delete-card").setEventListeners();const v=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}addItem(e){this._container.prepend(e)}clear(){this._container.innerHTML=""}renderItems(){this.clear(),this._items.forEach((e=>{this._renderer(e)}))}}((s=>{v.addItem(function(s){const r=new t({data:s,user:L,cardSelector:".cards__grid",handleCardClick:e=>{e.preventDefault();const t=e.target,s=t.src,r=t.alt;p.open(s,r),p.setEventListeners()},handleDeleteCard:t=>{h.open(),h.setAction((()=>e.api.deleteCard(t).then((e=>{r.deleteCard(),h.close()})).catch((e=>console.log(e)))))},handleLikes:t=>{r.isLiked()?e.api.removeLike(t).then((e=>{r.updateLikes(e.likes)})).catch((e=>console.log(e))):e.api.addLike(t).then((e=>{r.updateLikes(e.likes)})).catch((e=>console.log(e)))}});return r.generateCard()}(s))}),".cards__grid"),b=new class{constructor({name:e,job:t,avatar:s}){this._name=document.querySelector(`${e}`),this._job=document.querySelector(`${t}`),this._avatar=document.querySelector(`${s}`),this.setUserInfo=this.setUserInfo.bind(this)}getUserInfo(){const e={};return e.userName=this._name.textContent,e.userJob=this._job.textContent,e}setUserInfo(e){this._name.textContent=e.name,this._job.textContent=e.job}setUserAvatar({avatar:e}){this._avatar.style.backgroundImage=`url('${e}')`}}({name:".profile__title",about:".profile__subtitle",avatar:".profile__image"});e.api.getUserInfo().then((e=>{b.setUserInfo(e),L=e._id,b.setUserAvatar(e.avatar)})).catch((e=>console.log(e))),e.api.getInitialCards().then((e=>{v.renderItems(e)})).catch((e=>console.log(e)));const E=new u(".modal_type_edit",(()=>{b.setUserInfo(E.getInputValues()),E.close()}));E.setEventListeners(),i.addEventListener("click",(()=>{E.setInputValues(b.getUserInfo()),g.resetValidation(),E.open()}));const y=new u(".modal_type_avatar",(()=>{}));y.addEventListener(),a.addEventListener("click",(()=>{S.resetValidation(),y.open()}));const f=new u(".modal_type_add-card",(()=>{const e=f.getInputValues();v.addItem(generateCard(e)),f.close()}));f.setEventListeners(),l.addEventListener("click",(()=>{k.resetValidation(),f.open()}));const g=new r(_,n);g.enableValidation();const S=new r(_,o);S.enableValidation();const k=new r(_,d);let L;k.enableValidation()}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoia0NBQUEsTUFBTUEsRUFBWSxDQUFDQyxFQUFLQyxJQUNiQyxNQUFNRixFQUFLQyxHQUFTRSxNQUFNQyxJQUMvQixHQUFJQSxFQUFJQyxHQUNOLE9BQU9ELEVBQUlFLE9BRWJDLFFBQVFDLE9BQVEsVUFBU0osRUFBSUssaUJBMEZ2QixJQXRGWixNQUNFQyxZQUFZQyxFQUFTVixHQUNuQlcsS0FBS0QsUUFBVUEsRUFDZkMsS0FBS1gsUUFBVUEsRUFLakJZLGtCQUNFLE9BQU9kLEVBQVcsR0FBRWEsS0FBS0UsaUJBQWtCLENBQ3pDYixRQUFTVyxLQUFLRyxXQU1sQkMsY0FDRSxPQUFPakIsRUFBVyxHQUFFYSxLQUFLRSxvQkFBcUIsQ0FDNUNiLFFBQVNXLEtBQUtHLFdBT2xCRSxjQUFjQyxHQUNaLE9BQU9uQixFQUFXLEdBQUVhLEtBQUtFLDJCQUE0QixDQUNuREssT0FBUSxRQUNSbEIsUUFBU1csS0FBS0csU0FDZEssS0FBTUMsS0FBS0MsVUFBVSxDQUNuQkMsT0FBUUwsRUFBS00sU0FNbkJDLFlBQVlDLEdBQ1YsT0FBTzNCLEVBQVcsR0FBRWEsS0FBS0Usb0JBQXFCLENBQzVDSyxPQUFRLFFBQ1JsQixRQUFTVyxLQUFLRyxTQUNkSyxLQUFNQyxLQUFLQyxVQUFVLENBQ25CSyxLQUFNRCxFQUFRQyxLQUNkQyxJQUFLRixFQUFRRSxRQU9uQkMsY0FBY0MsR0FDWixPQUFPL0IsRUFBVyxHQUFFYSxLQUFLRSxpQkFBa0IsQ0FDekNLLE9BQVEsT0FDUmxCLFFBQVNXLEtBQUtHLFNBQ2RLLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJLLEtBQU1HLEVBQUtILEtBQ1hILEtBQU1NLEVBQUtOLFNBTWpCTyxXQUFXQyxHQUNULE9BQU9qQyxFQUFXLEdBQUVhLEtBQUtFLGtCQUFrQmtCLElBQVUsQ0FDbkRiLE9BQVEsU0FDUmxCLFFBQVNXLEtBQUtHLFdBS2xCa0IsUUFBUUQsR0FDTixPQUFPakMsRUFBVyxHQUFFYSxLQUFLRSx3QkFBd0JrQixJQUFVLENBQ3pEYixPQUFRLE1BQ1JsQixRQUFTVyxLQUFLRyxXQUtsQm1CLFdBQVdGLEdBQ1QsT0FBT2pDLEVBQVcsR0FBRWEsS0FBS0Usd0JBQXdCa0IsSUFBVSxDQUN6RGIsT0FBUSxTQUNSbEIsUUFBU1csS0FBS0csYUFNQSxDQUNoQkosUUFBUyw2Q0FDVFYsUUFBUyxDQUFFa0MsY0FBZSw0Q0NoRzFCQyxFQUEyQixHQUcvQixTQUFTQyxFQUFvQkMsR0FFNUIsSUFBSUMsRUFBZUgsRUFBeUJFLEdBQzVDLFFBQXFCRSxJQUFqQkQsRUFDSCxPQUFPQSxFQUFhRSxRQUdyQixJQUFJQyxFQUFTTixFQUF5QkUsR0FBWSxDQUdqREcsUUFBUyxJQU9WLE9BSEFFLEVBQW9CTCxHQUFVSSxFQUFRQSxFQUFPRCxRQUFTSixHQUcvQ0ssRUFBT0QsUyxxQ0NyQlIsTUFBTUcsRUFDWGxDLGFBQ0UsU0FBRW1DLEVBQUYsS0FBWUMsRUFBWixZQUFrQkMsRUFBbEIsY0FBK0JDLEVBQS9CLFlBQThDQyxHQUM5Q0MsR0FFQXRDLEtBQUt1QyxNQUFRTixFQUFTbEIsS0FDdEJmLEtBQUt3QyxNQUFRUCxFQUFTckIsS0FDdEJaLEtBQUt5QyxRQUFVUixFQUFTUyxJQUN4QjFDLEtBQUsyQyxTQUFXVixFQUFTVyxNQUFNRixJQUMvQjFDLEtBQUs2QyxRQUFVWCxFQUNmbEMsS0FBSzhDLE9BQVNiLEVBQVNjLE1BQ3ZCL0MsS0FBS2dELGNBQWdCVixFQUVyQnRDLEtBQUtpRCxhQUFlZCxFQUNwQm5DLEtBQUtrRCxhQUFlYixFQUNwQnJDLEtBQUttRCxlQUFpQmYsRUFHeEJnQixlQUtFLE9BSmFDLFNBQ1ZDLGNBQWMsbUJBQ2RDLFFBQVFELGNBQWMsU0FDdEJFLFdBQVUsR0FLZkMsYUFDRXpELEtBQUswRCxNQUFNQyxTQUNYM0QsS0FBSzBELE1BQVEsS0FHZkUsZUFDTTVELEtBQUs2RCxVQUNQN0QsS0FBSzBELE1BQ0ZKLGNBQWMsc0JBQ2RRLFVBQVVDLElBQUksNEJBRWpCL0QsS0FBSzBELE1BQ0ZKLGNBQWMsc0JBQ2RRLFVBQVVILE9BQU8sNEJBRXRCM0QsS0FBSzBELE1BQU1KLGNBQWMsdUJBQXVCVSxZQUM5Q2hFLEtBQUs4QyxPQUFPbUIsT0FJaEJKLFVBQ0UsT0FBTzdELEtBQUs4QyxPQUFPb0IsTUFBTWhDLEdBQVNBLEVBQUtRLE1BQVExQyxLQUFLbUUsVUFJdERDLFlBQVlDLEdBQ1ZyRSxLQUFLOEMsT0FBU3VCLEVBQ2RyRSxLQUFLNEQsZUFJUFUscUJBQ0V0RSxLQUFLMEQsTUFDRkosY0FBYyxzQkFDZGlCLGlCQUFpQixTQUFVQyxJQUMxQnhFLEtBQUt5RSxVQUFVRCxNQUduQnhFLEtBQUswRCxNQUNGSixjQUFjLHdCQUNkaUIsaUJBQWlCLFNBQVMsS0FDekJ2RSxLQUFLbUQsZUFBZW5ELEtBQUt5QyxZQUc3QnpDLEtBQUswRSxXQUFXSCxpQkFBaUIsU0FBVUMsSUFDekN4RSxLQUFLaUQsYUFBYXVCLE1BS3RCRyxlQWlCRSxPQWhCQTNFLEtBQUswRCxNQUFRMUQsS0FBS29ELGVBRWRwRCxLQUFLMkMsV0FBYTNDLEtBQUttRSxTQUN6Qm5FLEtBQUs0RSxTQUNGdEIsY0FBYyx3QkFDZFEsVUFBVUMsSUFBSSw4QkFHbkIvRCxLQUFLMEUsV0FBYTFFLEtBQUswRCxNQUFNSixjQUFjLGdCQUMzQ3RELEtBQUswRCxNQUFNSixjQUFjLGdCQUFnQlUsWUFBY2hFLEtBQUt1QyxNQUM1RHZDLEtBQUswRSxXQUFXRyxJQUFNN0UsS0FBS3dDLE1BQzNCeEMsS0FBSzBFLFdBQVdJLElBQXFCLGFBQUc5RSxLQUFLdUMsU0FDN0N2QyxLQUFLNEQsZUFFTDVELEtBQUtzRSxxQkFFRXRFLEtBQUswRCxPQzlGRCxNQUFNcUIsRUFDbkJqRixZQUFZa0YsRUFBWUMsR0FDdEJqRixLQUFLa0YsWUFBY0YsRUFDbkJoRixLQUFLbUYsYUFBZUYsRUFHdEJHLGdCQUFrQixDQUFDQyxFQUFjQyxLQUMvQixNQUFNLGdCQUFFQyxFQUFGLGtCQUFtQkMsR0FBc0J4RixLQUFLa0YsWUFDOUNPLEVBQWV6RixLQUFLbUYsYUFBYTdCLGNBQWUsS0FBSStCLEVBQWFLLGFBQ3ZFRCxFQUFhekIsWUFBY3NCLEVBQzNCRyxFQUFhM0IsVUFBVUMsSUFBSXlCLEdBQzNCSCxFQUFhdkIsVUFBVUMsSUFBSXdCLElBRzdCSSxnQkFBbUJOLElBQ2pCLE1BQU0sZ0JBQUVFLEVBQUYsa0JBQW1CQyxHQUFzQnhGLEtBQUtrRixZQUM5Q08sRUFBZXpGLEtBQUttRixhQUFhN0IsY0FBZSxLQUFJK0IsRUFBYUssYUFDdkVELEVBQWF6QixZQUFjLEdBQzNCeUIsRUFBYTNCLFVBQVVILE9BQU82QixHQUM5QkgsRUFBYXZCLFVBQVVILE9BQU80QixJQUdoQ0ssa0JBQ0U1RixLQUFLNkYsT0FBT0MsU0FBU0MsSUFDbkIvRixLQUFLMkYsZ0JBQWdCSSxNQUV2Qi9GLEtBQUtnRyxzQkFHUEMsWUFBZVosSUFDUkEsRUFBYWEsU0FBU0MsTUFHekJuRyxLQUFLMkYsZ0JBQWdCTixHQUZyQnJGLEtBQUtvRixnQkFBZ0JDLEVBQWNBLEVBQWFlLG9CQU1wREMsa0JBQW9CLElBQU1yRyxLQUFLNkYsT0FBT1MsT0FBT1AsR0FBVUEsRUFBTUcsU0FBU0MsUUFFdEVILHNCQUNFLE1BQU0sb0JBQUVPLEVBQUYscUJBQXVCQyxHQUF5QnhHLEtBQUtrRixZQUNyRHVCLEVBQWdCekcsS0FBS21GLGFBQWE3QixjQUFja0QsR0FFbER4RyxLQUFLcUcscUJBQ1BJLEVBQWNDLFVBQVcsRUFDekJELEVBQWMzQyxVQUFVSCxPQUFPNEMsS0FFL0JFLEVBQWNDLFVBQVcsRUFDekJELEVBQWMzQyxVQUFVQyxJQUFJd0MsSUFJaENqQyxtQkFBcUIsS0FDbkIsTUFBTSxjQUFFcUMsR0FBa0IzRyxLQUFLa0YsWUFTL0IsT0FSQWxGLEtBQUs2RixPQUFTZSxNQUFNQyxLQUFLN0csS0FBS21GLGFBQWEyQixpQkFBaUJILElBRTVEM0csS0FBSzZGLE9BQU9DLFNBQVNDLElBQ25CQSxFQUFNeEIsaUJBQWlCLFNBQVMsS0FDOUJ2RSxLQUFLaUcsWUFBWUYsR0FDakIvRixLQUFLZ0csNEJBR0ZoRyxLQUFLbUYsY0FHZDRCLG1CQUNFL0csS0FBS21GLGFBQWFaLGlCQUFpQixVQUFXQyxJQUM1Q0EsRUFBTXdDLG9CQUVSaEgsS0FBS3NFLHNCQ3BFRixNQUFNMkMsRUFBYTVELFNBQVNDLGNBQWMseUJBQ3BDNEQsRUFBZTdELFNBQVM4RCxNQUFNckcsUUFLOUJzRyxHQUpZRixFQUFhRyxTQUFTdEcsS0FDdkJtRyxFQUFhRyxTQUFTckcsSUFDZnFDLFNBQVNDLGNBQWMsa0NBRXRCRCxTQUFTQyxjQUFjLHlCQUMxQ2dFLEVBQWNqRSxTQUFTQyxjQUFjLHNCQUlyQ2lFLEdBSG1CbEUsU0FBU0MsY0FBYyw2QkFDdEJELFNBQVNDLGNBQWMsb0NBRTNCRCxTQUFTQyxjQUFjLHlCQUN2Q2tFLEVBQWVuRSxTQUFTQyxjQUFjLHdCQUt0Q21FLEdBSmlCcEUsU0FBU0MsY0FBYywyQkFDeEJELFNBQVNDLGNBQWMsMkJBQ2xCRCxTQUFTQyxjQUFjLHNDQUU5QkQsU0FBUzhELE1BQU1wRCxLQVk3QmlCLEdBWG1CeUMsRUFBWUosU0FBU0ssTUFDdEJELEVBQVlKLFNBQVN6RyxLQUV4QnlDLFNBQVNDLGNBQWMseUJBQzNCRCxTQUFTQyxjQUFjLGdCQUVuQkQsU0FBU0MsY0FBYyx5QkFDbEJELFNBQVNDLGNBQWMscUJBQ3hCRCxTQUFTQyxjQUFjLHlCQUNsQkQsU0FBU0MsY0FBYyx1Q0FFbEMsQ0FDeEJxRSxhQUFjLG9CQUNkaEIsY0FBZSxnQkFDZkgscUJBQXNCLHdCQUN0QkQsb0JBQXFCLGdDQUNyQmhCLGdCQUFpQixxQkFDakJDLGtCQUFtQix5QkNwQ04sTUFBTW9DLEVBQ25COUgsWUFBWStILEdBQ1Y3SCxLQUFLOEgsY0FBZ0J6RSxTQUFTQyxjQUFjdUUsR0FHOUNFLGtCQUFxQnZELElBQ0QsV0FBZEEsRUFBTXdELEtBQ1JoSSxLQUFLaUksU0FJVEMsS0FBTyxLQUNMbEksS0FBSzhILGNBQWNoRSxVQUFVQyxJQUFJLGlCQUNqQ1YsU0FBU2tCLGlCQUFpQixRQUFTdkUsS0FBSytILG9CQUcxQ0UsTUFBUSxLQUNOakksS0FBSzhILGNBQWNoRSxVQUFVSCxPQUFPLGlCQUNwQ04sU0FBUzhFLG9CQUFvQixRQUFTbkksS0FBSytILG9CQUc3Q0ssb0JBRUVwSSxLQUFLOEgsY0FDSnhFLGNBQWMsd0JBQ2RpQixpQkFBaUIsU0FBVUMsSUFDMUJ4RSxLQUFLaUksTUFBTXpELE1BR2J4RSxLQUFLOEgsY0FBY3ZELGlCQUFpQixTQUFVQyxJQUN4Q0EsRUFBTTZELE9BQU92RSxVQUFVd0UsU0FBUyxrQkFDbEN0SSxLQUFLaUksTUFBTXpELE9DN0JKLE1BQU0rRCxVQUFzQlgsRUFDekM5SCxZQUFZK0gsRUFBZVcsR0FDekJDLE1BQU1aLEdBQ043SCxLQUFLMEksaUJBQW1CRixFQUN4QnhJLEtBQUttRixhQUFlbkYsS0FBSzhILGNBQWN4RSxjQUFjLHFCQUd2RHFGLGlCQUNFLE1BQU1DLEVBQVloQyxNQUFNQyxLQUN0QjdHLEtBQUttRixhQUFhMkIsaUJBQWlCLGtCQUUvQitCLEVBQWMsR0FFcEIsT0FEQUQsRUFBVTlDLFNBQVNDLElBQVc4QyxFQUFZOUMsRUFBTWhGLE1BQVFnRixFQUFNK0MsU0FDdkRELEVBR1RFLGVBQWVDLEdBQ0twQyxNQUFNQyxLQUN0QjdHLEtBQUttRixhQUFhMkIsaUJBQWlCLGtCQUUzQmhCLFNBQVNDLElBQVdBLEVBQU0rQyxNQUFRRSxFQUFPakQsRUFBTWhGLFNBRzNEcUgsb0JBQ0VLLE1BQU1MLG9CQUNOcEksS0FBS21GLGFBQWFaLGlCQUFpQixVQUFVLEtBQzNDdkUsS0FBSzBJLGlCQUFpQjFJLEtBQUsySSxrQkFDM0IzSSxLQUFLaUksUUFDTGpJLEtBQUttRixhQUFhOEQsV0FJdEJoQixRQUNFUSxNQUFNUixRQUNOakksS0FBS21GLGFBQWE4RCxTQ2xDUCxNQUFNQyxVQUFnQ3RCLEVBQ25EOUgsWUFBYXFKLEVBQVVYLEdBQ3JCQyxNQUFNVSxHQUNObkosS0FBS29KLE1BQVEvRixTQUFTQyxjQUFjdEQsS0FBS3FKLFdBQ3pDckosS0FBS3NKLGNBQWdCZCxFQUNyQnhJLEtBQUt1SixxQkFBdUJ2SixLQUFLdUoscUJBQXFCQyxLQUFLeEosTUFHN0R1SixxQkFBc0IvRSxHQUNwQkEsRUFBTXdDLGlCQUNOaEgsS0FBS3NKLGdCQUNMYixNQUFNUixRQUdSM0QscUJBQ0VtRSxNQUFNbkUscUJBQ050RSxLQUFLb0osTUFBTTdFLGlCQUFpQixTQUFVdkUsS0FBS3VKLHNCQUc3Q0Usd0JBQ0VoQixNQUFNZ0Isd0JBQ056SixLQUFLb0osTUFBTWpCLG9CQUFvQixTQUFVbkksS0FBS3VKLHVCQ0hsRCxNQUFNRyxFQUFnQixJQ2xCUCxjQUE2QjlCLEVBRTFDK0IsT0FBVW5GLElBQ1IsTUFBTW9GLEVBQVdwRixFQUFNNkQsT0FDdkJySSxLQUFLOEgsY0FBY3hFLGNBQWMscUJBQXFCdUIsSUFBTStFLEVBQVMvRSxJQUNyRTdFLEtBQUs4SCxjQUFjeEUsY0FBYyxxQkFBcUJ3QixJQUFNOEUsRUFBUzlFLElBQ3JFOUUsS0FBSzhILGNBQWN4RSxjQUFjLHlCQUF5QlUsWUFBYzRGLEVBQVM5RSxJQUVqRjlFLEtBQUtrSSxTRFVnQyx5QkFHakIsSUFBSUssRUFBYywyQkFDMUJILG9CQW9EaEIsTUFBTXlCLEVBQWUsSUU1RU4sTUFDYi9KLGFBQVksTUFBRWdLLEVBQUYsU0FBU0MsR0FBWUMsR0FDL0JoSyxLQUFLaUssT0FBU0gsRUFDZDlKLEtBQUtrSyxVQUFZSCxFQUNqQi9KLEtBQUttSyxXQUFhOUcsU0FBU0MsY0FBYzBHLEdBRzNDSSxRQUFRQyxHQUNOckssS0FBS21LLFdBQVdHLFFBQVFELEdBRzFCRSxRQUNFdkssS0FBS21LLFdBQVdLLFVBQVksR0FHOUJDLGNBQ0V6SyxLQUFLdUssUUFFTHZLLEtBQUtpSyxPQUFPbkUsU0FBUzVFLElBQ25CbEIsS0FBS2tLLFVBQVVoSixTRjBEbEJ3SixJQUNDYixFQUFhTyxRQWxEakIsU0FBb0I5SixHQUNsQixNQUFNWSxFQUFPLElBQUljLEVBQUssQ0FDcEIxQixLQUFNQSxFQUNONEIsS0FBTXlJLEVBQ05ySSxhQUFjLGVBQ2RzSSxnQkFBa0JDLElBRWhCQSxFQUFJN0QsaUJBQ0osTUFBTXFCLEVBQVN3QyxFQUFJeEMsT0FDYnpILEVBQU95SCxFQUFPeEQsSUFDZDlELEVBQU9zSCxFQUFPdkQsSUFDcEI0RSxFQUFjeEIsS0FBS3RILEVBQU1HLEdBQ3pCMkksRUFBY3RCLHFCQUVoQjBDLGlCQUFtQjFKLElBQ2pCOEgsRUFBd0JoQixPQUN4QmdCLEVBQXdCNkIsV0FBVSxJQUNoQ0MsRUFBQUEsSUFBQUEsV0FBZTVKLEdBQ1o3QixNQUFNQyxJQUNMMEIsRUFBS3VDLGFBQ0x5RixFQUF3QmpCLFdBRXpCZ0QsT0FBT0MsR0FBUUMsUUFBUUMsSUFBSUYsUUFHbENHLFlBQWNqSyxJQUNJRixFQUFLMkMsVUFFbkJtSCxFQUFBQSxJQUFBQSxXQUFlNUosR0FDWjdCLE1BQU1DLElBQ0wwQixFQUFLa0QsWUFBWTVFLEVBQUl1RCxVQUV0QmtJLE9BQU9DLEdBQVFDLFFBQVFDLElBQUlGLEtBRzlCRixFQUFBQSxJQUFBQSxRQUFZNUosR0FDVDdCLE1BQU1DLElBQ0wwQixFQUFLa0QsWUFBWTVFLEVBQUl1RCxVQUV0QmtJLE9BQU9DLEdBQVFDLFFBQVFDLElBQUlGLFFBTXBDLE9BRGtCaEssRUFBS3lELGVBTUEyRyxDQUFXWixNQUVsQyxnQkFLSWEsRUFBaUIsSUdyRlIsTUFDYnpMLGFBQWEsS0FBQ2lCLEVBQUQsSUFBT0MsRUFBUCxPQUFZTCxJQUN2QlgsS0FBS3VDLE1BQVFjLFNBQVNDLGNBQWUsR0FBRXZDLEtBQ3ZDZixLQUFLd0wsS0FBT25JLFNBQVNDLGNBQWUsR0FBRXRDLEtBQ3RDaEIsS0FBS3lMLFFBQVVwSSxTQUFTQyxjQUFlLEdBQUUzQyxLQUN6Q1gsS0FBSzBMLFlBQWMxTCxLQUFLMEwsWUFBWWxDLEtBQUt4SixNQUczQ0ksY0FDRSxNQUFNdUwsRUFBVyxHQUlqQixPQUhBQSxFQUFTQyxTQUFXNUwsS0FBS3VDLE1BQU15QixZQUMvQjJILEVBQVNFLFFBQVU3TCxLQUFLd0wsS0FBS3hILFlBRXRCMkgsRUFHVEQsWUFBWXBMLEdBQ1ZOLEtBQUt1QyxNQUFNeUIsWUFBYzFELEVBQUtTLEtBQzlCZixLQUFLd0wsS0FBS3hILFlBQWMxRCxFQUFLVSxJQUcvQlgsZUFBZSxPQUFDTSxJQUNkWCxLQUFLeUwsUUFBUUssTUFBTUMsZ0JBQW1CLFFBQU9wTCxRSCtEYixDQUNsQ0ksS0FBTSxrQkFDTmlMLE1BQU8scUJBQ1ByTCxPQUFRLG9CQUdWcUssRUFBQUEsSUFBQUEsY0FDR3pMLE1BQU1DLElBQ0wrTCxFQUFlRyxZQUFZbE0sR0FDM0JtTCxFQUFTbkwsRUFBSWtELElBQ2I2SSxFQUFlbEwsY0FBY2IsRUFBSW1CLFdBRWxDc0ssT0FBT0MsR0FBUUMsUUFBUUMsSUFBSUYsS0FJOUJGLEVBQUFBLElBQUFBLGtCQUFzQnpMLE1BQU1DLElBQzFCcUssRUFBYVksWUFBWWpMLE1BRTFCeUwsT0FBT0MsR0FBUUMsUUFBUUMsSUFBSUYsS0FLNUIsTUFBTWUsRUFBa0IsSUFBSTFELEVBQWMsb0JBQW9CLEtBQzVEZ0QsRUFBZUcsWUFBWU8sRUFBZ0J0RCxrQkFDM0NzRCxFQUFnQmhFLFdBSWxCZ0UsRUFBZ0I3RCxvQkFHaEJuQixFQUFXMUMsaUJBQWlCLFNBQVMsS0FDbkMwSCxFQUFnQmxELGVBQWV3QyxFQUFlbkwsZUFDOUM4TCxFQUFzQnRHLGtCQUN0QnFHLEVBQWdCL0QsVUFJbEIsTUFBTWlFLEVBQWEsSUFBSTVELEVBQWMsc0JBQXNCLFNBSzNENEQsRUFBVzVILG1CQUVYNkMsRUFBaUI3QyxpQkFBaUIsU0FBUyxLQUN6QzZILEVBQXFCeEcsa0JBQ3JCdUcsRUFBV2pFLFVBS2IsTUFBTVQsRUFBYyxJQUFJYyxFQUFjLHdCQUF3QixLQUM1RCxNQUFNOEQsRUFBVTVFLEVBQVlrQixpQkFDNUJrQixFQUFhTyxRQUFRekYsYUFBYTBILElBQ2xDNUUsRUFBWVEsV0FJZFIsRUFBWVcsb0JBR1piLEVBQWNoRCxpQkFBaUIsU0FBUyxLQUN0QytILEVBQXNCMUcsa0JBQ3RCNkIsRUFBWVMsVUFLZCxNQUFNZ0UsRUFBd0IsSUFBSW5ILEVBQWNDLEVBQVlrQyxHQUM1RGdGLEVBQXNCbkYsbUJBR3RCLE1BQU1xRixFQUF1QixJQUFJckgsRUFBY0MsRUFBWXNDLEdBQzNEOEUsRUFBcUJyRixtQkFHckIsTUFBTXVGLEVBQXdCLElBQUl2SCxFQUFjQyxFQUFZd0MsR0FJNUQsSUFBSW1ELEVBSEoyQixFQUFzQnZGLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWwuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9Nb2RhbERlbGV0ZUNvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL0luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZmlyc3RDYWxsID0gKHVybCwgaGVhZGVycykgPT4ge1xyXG4gICAgcmV0dXJuIGZldGNoKHVybCwgaGVhZGVycykudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICBQcm9taXNlLnJlamVjdChgRVJST1I6ICR7cmVzLnN0YXR1c1RleHR9YCk7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihiYXNlVXJsLCBoZWFkZXJzKSB7XHJcbiAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIC8vICsrKysrIEZldGNoaW5nICsrKysrIC8vXHJcbiAgLy8gLS0tIEZldGNoIEluaXRpYWxDYXJkcyBmcm9tIHRoZSBzZXJ2ZXIgLS0tIC8vXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZpcnN0Q2FsbChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gIC8vIC0tLSBGZXRjaCBVc2VySW5mbyBmcm9tIHRoZSBzZXJ2ZXIgLS0tIC8vXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmlyc3RDYWxsKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyArKysrKyBBZGRpbmcvRWRpdGluZy9SZW1vdmluZyBkYXRhICsrKysrIC8vXHJcbiAgLy8gPT09PT0gUHJvZmlsZSA9PT09PSAvL1xyXG4gIC8vIC0tLSBTZXQvVXBkYXRlIHVzZXIgYXZhdGFyIC0tLSAvL1xyXG4gIHNldFVzZXJBdmF0YXIoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZpcnN0Q2FsbChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBkYXRhLmxpbmssXHJcbiAgICAgIH0pXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBTZXQvVXBkYXRlIHVzZXIgaW5mbyAtLS0gLy9cclxuICBzZW5kTmV3RGF0YShwcm9maWxlKSB7XHJcbiAgICByZXR1cm4gZmlyc3RDYWxsKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZSxcclxuICAgICAgICBqb2I6IHByb2ZpbGUuam9iLFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gPT09PT0gQ2FyZHMgPT09PT0gLy9cclxuICAvLyAtLS0gQ3JlYXRpbmcgYSBuZXcgY2FyZCAtLS0gLy9cclxuICBjcmVhdGVOZXdDYXJkKGNhcmQpIHtcclxuICAgIHJldHVybiBmaXJzdENhbGwoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBjYXJkLm5hbWUsXHJcbiAgICAgICAgbGluazogY2FyZC5saW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIFJlbW92aW5nL0RlbGV0aW5nIGNhcmQgLS0tIC8vXHJcbiAgcmVtb3ZlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmaXJzdENhbGwoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBBZGQgbGlrZSB0byBhIGNhcmQgLS0tIC8vXHJcbiAgYWRkTGlrZShjYXJkSWQpIHtcclxuICAgIHJldHVybiBmaXJzdENhbGwoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBSZW1vdmUgbGlrZSBmcm9tIGEgY2FyZCAtLS0gLy9cclxuICByZW1vdmVMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZpcnN0Q2FsbChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gICAgYmFzZVVybDogJ2h0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMicsXHJcbiAgICBoZWFkZXJzOiB7IGF1dGhvcml6YXRpb246IFwiNzA5YTBkOWQtZGIwNi00ODkwLWE1OTQtYjA3ZTczMDlhMzUzXCIgfVxyXG59KTtcclxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsImV4cG9ydCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHsgY2FyZERhdGEsIHVzZXIsIG9uQ2FyZENsaWNrLCByZW1vdmVIYW5kbGVyLCBsaWtlSGFuZGxlciB9LFxyXG4gICAgY2FyZFNlbGVjdG9yXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gY2FyZERhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBjYXJkRGF0YS5saW5rO1xyXG4gICAgdGhpcy5fY2FyZElkID0gY2FyZERhdGEuX2lkO1xyXG4gICAgdGhpcy5fb3duZXJJZCA9IGNhcmREYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX3VzZXJJRCA9IHVzZXI7XHJcbiAgICB0aGlzLl9saWtlcyA9IGNhcmREYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG5cclxuICAgIHRoaXMuX29uQ2FyZENsaWNrID0gb25DYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9saWtlSGFuZGxlciA9IGxpa2VIYW5kbGVyO1xyXG4gICAgdGhpcy5fcmVtb3ZlSGFuZGxlciA9IHJlbW92ZUhhbmRsZXI7XHJcbiAgfVxyXG4gIC8vIC0tLSBHZXR0aW5nIHRoZSB0ZW1wbGF0ZSAtLS0gLy9cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBjYXJkID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZF9fdGVtcGxhdGVcIilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICByZXR1cm4gY2FyZDtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBDYXJkIGRlbGV0aW5nIG1ldGhvZCAtLS0gLy9cclxuICBkZWxldGVDYXJkKCkge1xyXG4gICAgdGhpcy5faXRlbS5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2l0ZW0gPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgX3JlbmRlckxpa2VzKCkge1xyXG4gICAgaWYgKHRoaXMuaXNMaWtlZCgpKSB7XHJcbiAgICAgIHRoaXMuX2l0ZW1cclxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAgIC5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faXRlbVxyXG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgICAgLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9pdGVtLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1jb3VudGVyXCIpLnRleHRDb250ZW50ID1cclxuICAgICAgdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIENoZWNrIGlmIGNhcmQgbGlrZWQgYnkgYW5vdGhlciB1c2VyIC0tLSAvL1xyXG4gIGlzTGlrZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fbGlrZXMuc29tZSgodXNlcikgPT4gdXNlci5faWQgPT09IHRoaXMuX3VzZXJJZCk7XHJcbiAgfVxyXG5cclxuICAvLyAtLS0gVG9nZ2xlIGxpa2UgYnV0dG9uIG1ldGhvZCAtLS0gLy9cclxuICB1cGRhdGVMaWtlcyhuZXdMaWtlcykge1xyXG4gICAgdGhpcy5fbGlrZXMgPSBuZXdMaWtlcztcclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgfVxyXG5cclxuICAvLyAtLS0gU2V0IGV2ZW50cyBsaXN0ZW5lcnMgZm9yIHRoZSBjYXJkcyB0aGF0IHdpbGwgYmUgY3JlYXRlZCEgLS0tIC8vXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faXRlbVxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2xpa2VDYXJkKGV2ZW50KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgdGhpcy5faXRlbVxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3JlbW92ZUhhbmRsZXIodGhpcy5fY2FyZElkKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgdGhpcy5fb25DYXJkQ2xpY2soZXZlbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyAtLS0gQ3JlYXRpbmcgdGhlIGNhcmQgYW5kIGNhcmQgZWxlbWVudHMgLS0tIC8vXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5faXRlbSA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcblxyXG4gICAgaWYgKHRoaXMuX293bmVySWQgIT09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICB0aGlzLl9lbGVtZW50XHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKVxyXG4gICAgICAgIC5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fZGVsZXRlLWJ1dHRvbl9oaWRkZW5cIik7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5faXRlbS5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5faXRlbS5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IFwiSW1hZ2Ugb2YgXCIgKyBgICR7dGhpcy5fbmFtZX0gYDtcclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5faXRlbTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoZm9ybUNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Zvcm1Db25maWcgPSBmb3JtQ29uZmlnO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkgPT4ge1xyXG4gICAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIGVycm9yTWVzc2FnZUNsYXNzIH0gPSB0aGlzLl9mb3JtQ29uZmlnO1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgICMke2lucHV0RWxlbWVudC5pZH1fZXJyb3IgYCk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChlcnJvck1lc3NhZ2VDbGFzcyk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChpbnB1dEVycm9yQ2xhc3MpO1xyXG4gIH07XHJcbiAgXHJcbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIGVycm9yTWVzc2FnZUNsYXNzIH0gPSB0aGlzLl9mb3JtQ29uZmlnO1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgICMke2lucHV0RWxlbWVudC5pZH1fZXJyb3IgYCk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoZXJyb3JNZXNzYWdlQ2xhc3MpO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5wdXRFcnJvckNsYXNzKTtcclxuICB9O1xyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLmlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3RvZ2dsZVN1Ym1pdEJ1dHRvbigpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXQgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2NoZWNrSWZGb3JtVmFsaWQgPSAoKSA9PiB0aGlzLmlucHV0cy5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkKTtcclxuXHJcbiAgX3RvZ2dsZVN1Ym1pdEJ1dHRvbigpIHtcclxuICAgIGNvbnN0IHsgaW5hY3RpdmVCdXR0b25DbGFzcywgc3VibWl0QnV0dG9uU2VsZWN0b3IgfSA9IHRoaXMuX2Zvcm1Db25maWc7XHJcbiAgICBjb25zdCBidXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihzdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gICAgaWYgKHRoaXMuX2NoZWNrSWZGb3JtVmFsaWQoKSkge1xyXG4gICAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShpbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICBjb25zdCB7IGlucHV0U2VsZWN0b3IgfSA9IHRoaXMuX2Zvcm1Db25maWc7XHJcbiAgICB0aGlzLmlucHV0cyA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChpbnB1dFNlbGVjdG9yKSk7XHJcblxyXG4gICAgdGhpcy5pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0KGlucHV0KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVTdWJtaXRCdXR0b24oKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLl9mb3JtRWxlbWVudDtcclxuICB9O1xyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn0iLCIvLyAtLS0gJ0VkaXQgcHJvZmlsZScgbW9kYWwgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZU1vZGFsID0gZG9jdW1lbnQuZm9ybXMucHJvZmlsZTtcclxuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IHByb2ZpbGVNb2RhbC5lbGVtZW50cy5uYW1lO1xyXG5leHBvcnQgY29uc3Qgam9iSW5wdXQgPSBwcm9maWxlTW9kYWwuZWxlbWVudHMuam9iO1xyXG5leHBvcnQgY29uc3QgZWRpdENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9lZGl0Jyk7XHJcbi8vIC0tLSAnQXZhdGFyXCIgbW9kYWwgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgYXZhdGFyRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19pbWFnZS1lZGl0Jyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2F2YXRhcicpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyTW9kYWxJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW5wdXRfdHlwZV9hdmF0YXInKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhckNsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9hdmF0YXInKVxyXG4vLyAtLS0gJ0FkZC1jYXJkJyBtb2RhbCBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2FkZC1jYXJkJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkSW5wdXRUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW5wdXRfdHlwZV9uYW1lJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkSW5wdXRMaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX2xpbmsnKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UtYnV0dG9uX3R5cGVfYWRkLWNhcmQnKTtcclxuLy8gLS0tICdBZGQtQ2FyZCcgZm9ybSBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zLmFkZDtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtVGl0ZWwgPSBhZGRDYXJkRm9ybS5lbGVtZW50cy50aXRsZTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtTGluayA9IGFkZENhcmRGb3JtLmVsZW1lbnRzLmxpbms7XHJcbi8vIC0tLSBHZW5lcmFsIGNvbnN0IC0tLSAvL1xyXG5leHBvcnQgY29uc3Qgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19zdWJtaXQtYnV0dG9uJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkc19fZ3JpZCcpO1xyXG4vLyAtLS0gQmlnIGltYWdlIG1vZGFsIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGNhcmRCaWdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2JpZy1pbWFnZScpO1xyXG5leHBvcnQgY29uc3QgY2FyZEJpZ01vZGFsSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2JpZy1pbWFnZScpO1xyXG5leHBvcnQgY29uc3QgY2FyZEJpZ01vZGFsVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW1hZ2UtY2FwdGlvbicpO1xyXG5leHBvcnQgY29uc3QgY2FyZEJpZ01vZGFsQ2xvc2VJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9iaWctaW1hZ2UnKTtcclxuLy8gLS0tIEZvcm0gY29uZmlnIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGZvcm1Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fY29udGFpbmVyXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfZXJyb3JcIixcclxuICBlcnJvck1lc3NhZ2VDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiXHJcbn07XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG1vZGFsU2VsZWN0b3IpO1xyXG4gIH1cclxuICAvLyAtLS0gQ2xvc2UgbW9kYWwgb24gRVNDIG1ldGhvZCAtLS0gLy9cclxuICBfY2hlY2tGb3JFc2NDbG9zZSA9IChldmVudCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIC0tLSBPcGVuIG1vZGFsIG1ldGhvZCAtLS0gLy8gXHJcbiAgb3BlbiA9ICgpID0+IHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfdmlzaWJsZVwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9jaGVja0ZvckVzY0Nsb3NlKTtcclxuICB9XHJcbiAgLy8gLS0tIENsb3NlIG1vZGFsIG1ldGhvZCAtLS0gLy9cclxuICBjbG9zZSA9ICgpID0+IHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfdmlzaWJsZVwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9jaGVja0ZvckVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gLS0tIENsb3NlIG1vZGFsIG9uIGNsb3NlKCdYJykgYnV0dG9uIC0tLSAvL1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpXHJcbiAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICB0aGlzLmNsb3NlKGV2ZW50KTtcclxuICAgIH0pO1xyXG4gICAgLy8gQ2xvc2UgbW9kYWwgb24gb3ZlcmxheShvdXQgb2YgdGhlIG1vZGFsKSBjbGljayAtLS0gLy8vXHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX3Zpc2libGVcIikpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKGV2ZW50KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59IiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhGb3JtIGV4dGVuZHMgTW9kYWwge1xyXG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdCkge1xyXG4gICAgc3VwZXIobW9kYWxTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXRCdG4gPSBoYW5kbGVTdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jb250YWluZXJcIik7XHJcbiAgfVxyXG5cclxuICBnZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXHJcbiAgICApO1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge2lucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7fSk7XHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRJbnB1dFZhbHVlcyh2YWx1ZXMpIHtcclxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXHJcbiAgICApO1xyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7aW5wdXQudmFsdWUgPSB2YWx1ZXNbaW5wdXQubmFtZV07fSlcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXRCdG4odGhpcy5nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gIH1cclxufSIsImltcG9ydCBNb2RhbCBmcm9tICcuL01vZGFsLmpzJztcclxuICBcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxEZWxldGVDb25maXJtYXRpb24gZXh0ZW5kcyBNb2RhbCB7XHJcbiAgY29uc3RydWN0b3IgKHNlbGVjdG9yLCBoYW5kbGVTdWJtaXQpIHtcclxuICAgIHN1cGVyKHNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Zvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3NlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEhhbmRsZXIgPSB0aGlzLl9oYW5kbGVTdWJtaXRIYW5kbGVyLmJpbmQodGhpcyk7XHJcbiAgfVxyXG4gIFxyXG4gIF9oYW5kbGVTdWJtaXRIYW5kbGVyIChldmVudCkge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcbiAgXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzICgpIHtcclxuICAgIHN1cGVyLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9oYW5kbGVTdWJtaXRIYW5kbGVyKTtcclxuICB9XHJcbiAgXHJcbiAgX3JlbW92ZUV2ZW50TGlzdGVuZXJzICgpIHtcclxuICAgIHN1cGVyLl9yZW1vdmVFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9oYW5kbGVTdWJtaXRIYW5kbGVyKTtcclxuICB9XHJcbn0iLCJpbXBvcnQgeyBhcGkgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IHtcclxuICBlZGl0QnV0dG9uLFxyXG4gIHByb2ZpbGVNb2RhbCxcclxuICBhZGRDYXJkQnV0dG9uLFxyXG4gIGFkZENhcmRNb2RhbCxcclxuICBhdmF0YXJNb2RhbCxcclxuICBhdmF0YXJFZGl0QnV0dG9uLFxyXG4gIGZvcm1Db25maWdcclxufSBmcm9tIFwiLi4vY29tcG9uZW50cy91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IE1vZGFsV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IE1vZGFsV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9Nb2RhbFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBNb2RhbERlbGV0ZUNvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL01vZGFsRGVsZXRlQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcblxyXG4vLyAtLS0gQmlnIGltYWdlIG1vZGFsIGluc3RhbmNlIC0tLSAvL1xyXG5jb25zdCBiaWdJbWFnZU1vZGFsID0gbmV3IE1vZGFsV2l0aEltYWdlKFwiLm1vZGFsX3R5cGVfYmlnLWltYWdlXCIpO1xyXG5cclxuLy8gLS0tIERlbGV0ZSBjYXJkIG1vZGFsIGluc3RhbmNlIGFuZCBldmVudHMgLS0tIC8vXHJcbmNvbnN0IGRlbGV0ZUNhcmRNb2RhbCA9IG5ldyBNb2RhbFdpdGhGb3JtKFwiLm1vZGFsX3R5cGVfZGVsZXRlLWNhcmRcIik7XHJcbmRlbGV0ZUNhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gKysrKysgQ2FyZCBTZWN0aW9uICsrKysrIC8vXHJcbi8vIC0tLSBDYXJkIHJlbmRlciBmdW5jdGlvbiAtLS0gLy9cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcclxuICAgIGRhdGE6IGRhdGEsXHJcbiAgICB1c2VyOiB1c2VySWQsXHJcbiAgICBjYXJkU2VsZWN0b3I6IFwiLmNhcmRzX19ncmlkXCIsXHJcbiAgICBoYW5kbGVDYXJkQ2xpY2s6IChldnQpID0+IHtcclxuICAgICAgLy8gLS0tIE9wZW4gYmlnIGltYWdlIG1vZGFsIC0tLSAvL1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgdGFyZ2V0ID0gZXZ0LnRhcmdldDtcclxuICAgICAgY29uc3QgbGluayA9IHRhcmdldC5zcmM7XHJcbiAgICAgIGNvbnN0IG5hbWUgPSB0YXJnZXQuYWx0O1xyXG4gICAgICBiaWdJbWFnZU1vZGFsLm9wZW4obGluaywgbmFtZSk7XHJcbiAgICAgIGJpZ0ltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH0sXHJcbiAgICBoYW5kbGVEZWxldGVDYXJkOiAoY2FyZElkKSA9PiB7XHJcbiAgICAgIE1vZGFsRGVsZXRlQ29uZmlybWF0aW9uLm9wZW4oKTtcclxuICAgICAgTW9kYWxEZWxldGVDb25maXJtYXRpb24uc2V0QWN0aW9uKCgpID0+XHJcbiAgICAgICAgYXBpLmRlbGV0ZUNhcmQoY2FyZElkKVxyXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcclxuICAgICAgICAgICAgTW9kYWxEZWxldGVDb25maXJtYXRpb24uY2xvc2UoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgICAgKTtcclxuICAgIH0sXHJcbiAgICBoYW5kbGVMaWtlczogKGNhcmRJZCkgPT4ge1xyXG4gICAgICBjb25zdCBpc0xpa2VkID0gY2FyZC5pc0xpa2VkKCk7XHJcbiAgICAgIGlmIChpc0xpa2VkKSB7XHJcbiAgICAgICAgYXBpLnJlbW92ZUxpa2UoY2FyZElkKVxyXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXHJcbiAgICAgIH0gXHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIGFwaS5hZGRMaWtlKGNhcmRJZClcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgY2FyZC51cGRhdGVMaWtlcyhyZXMubGlrZXMpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gIH0pO1xyXG4gIC8vIC0tLSBDbG9uZSBmcm9tIHRlbXBsYXRlIC0tLSAvL1xyXG4gIGNvbnN0IGNhcmRzSXRlbSA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbiAgcmV0dXJuIGNhcmRzSXRlbTtcclxufVxyXG5cclxuY29uc3QgY2FyZHNTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgKGl0ZW0pID0+IHtcclxuICAgIGNhcmRzU2VjdGlvbi5hZGRJdGVtKGNyZWF0ZUNhcmQoaXRlbSkpO1xyXG4gIH0sXHJcbiAgXCIuY2FyZHNfX2dyaWRcIlxyXG4pO1xyXG5cclxuLy8gKysrKysgJ1VzZXIgSW5mbycgKysrKysgLy9cclxuLy8gLS0tIFVzZXJJbmZvIGluc3RhbmNlIC0tLSAvL1xyXG5jb25zdCB1c2VySW5mb1ZhbHVlcyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZTogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBhYm91dDogXCIucHJvZmlsZV9fc3VidGl0bGVcIixcclxuICBhdmF0YXI6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXHJcbn0pO1xyXG4vLyAtLS0gVXNlckluZm8gaW5pdCAtLS0gLy9cclxuYXBpLmdldFVzZXJJbmZvKClcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICB1c2VySW5mb1ZhbHVlcy5zZXRVc2VySW5mbyhyZXMpO1xyXG4gICAgdXNlcklkID0gcmVzLl9pZDtcclxuICAgIHVzZXJJbmZvVmFsdWVzLnNldFVzZXJBdmF0YXIocmVzLmF2YXRhcik7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcblxyXG4vLyArKysrKyBDYXJkIGxpc3QgKysrKysgLy9cclxuLy8gLS0tIENhcmRzIGluaXQgLS0tIC8vXHJcbmFwaS5nZXRJbml0aWFsQ2FyZHMoKS50aGVuKChyZXMpID0+IHtcclxuICBjYXJkc1NlY3Rpb24ucmVuZGVySXRlbXMocmVzKTtcclxufSlcclxuLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG5cclxuLy8gKysrKysgRm9ybXMgKysrKysgLy9cclxuLy8gPT09ICdFZGl0IHByb2ZpbGUnIGZvcm0gPT09IC8vXHJcbi8vIC0tLSBGb3JtIGNyZWF0aW9uIG1ldGhvZCAtLS0gLy9cclxuY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gbmV3IE1vZGFsV2l0aEZvcm0oXCIubW9kYWxfdHlwZV9lZGl0XCIsICgpID0+IHtcclxuICB1c2VySW5mb1ZhbHVlcy5zZXRVc2VySW5mbyhlZGl0UHJvZmlsZUZvcm0uZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgZWRpdFByb2ZpbGVGb3JtLmNsb3NlKCk7XHJcbn0pO1xyXG5cclxuLy8gLS0tIFNldCBldmVudCBsaXN0ZW5lcnMgZm9yIHRoZSBmb3JtIC0tLSAvL1xyXG5lZGl0UHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vIC0tLSBTZXQgdmFsdWVzIGFuZCBvcGVuIHRoZSBmb3JtIC0tLSAvL1xyXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZWRpdFByb2ZpbGVGb3JtLnNldElucHV0VmFsdWVzKHVzZXJJbmZvVmFsdWVzLmdldFVzZXJJbmZvKCkpXHJcbiAgcHJvZmlsZUZvcm1WYWxpZGF0aW9uLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGVkaXRQcm9maWxlRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG5cclxuLy8gPT09ICdBdmF0YXInIGVkaXQgZm9ybSA9PT0gLy9cclxuY29uc3QgYXZhdGFyRm9ybSA9IG5ldyBNb2RhbFdpdGhGb3JtKFwiLm1vZGFsX3R5cGVfYXZhdGFyXCIsICgpID0+IHtcclxuICBcclxufSk7XHJcblxyXG4vLyAtLS0gU2V0IGV2ZW50IGxlc3RlbmVycyB0byB0aGUgZm9ybSAtLS0gLy9cclxuYXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKCk7XHJcblxyXG5hdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYXZhdGFyRm9ybVZhbGlkYXRpb24ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYXZhdGFyRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG5cclxuLy8gPT09ICdBZGQgY2FyZCcgZm9ybSA9PT0gLy9cclxuLy8gLS0tIEZvcm0gY3JlYXRpb24gbWV0aG9kIC0tLSAvL1xyXG5jb25zdCBhZGRDYXJkRm9ybSA9IG5ldyBNb2RhbFdpdGhGb3JtKFwiLm1vZGFsX3R5cGVfYWRkLWNhcmRcIiwgKCkgPT4ge1xyXG4gIGNvbnN0IG5ld0NhcmQgPSBhZGRDYXJkRm9ybS5nZXRJbnB1dFZhbHVlcygpO1xyXG4gIGNhcmRzU2VjdGlvbi5hZGRJdGVtKGdlbmVyYXRlQ2FyZChuZXdDYXJkKSk7XHJcbiAgYWRkQ2FyZEZvcm0uY2xvc2UoKTtcclxufSk7XHJcblxyXG4vLyAtLS0gU2V0IGV2ZW50IGxpc3RlbmVycyBmb3IgJ2FkZCBjYXJkJyBtb2RhbCAtLS0gLy9cclxuYWRkQ2FyZEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vIC0tLSBPcGVuICdBZGQgQ2FyZCcgZm9ybSAtLS0gLy9cclxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZENhcmRGb3JtVmFsaWRhdGlvbi5yZXNldFZhbGlkYXRpb24oKTtcclxuICBhZGRDYXJkRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG5cclxuLy8gKysrKysgVmFsaWRhdGlvbiArKysrKyAvL1xyXG4vLyAtLS0gJ0VkaXQgcHJvZmlsZScgZm9ybSB2YWxpZGF0aW9uIGFkZGluZyAtLS0gLy9cclxuY29uc3QgcHJvZmlsZUZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgcHJvZmlsZU1vZGFsKTtcclxucHJvZmlsZUZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8vIC0tLSAnQXZhdGFyJyBmb3JtIHZhbGlkYXRpb24gYWRkaW5nIC0tLSAvL1xyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGF2YXRhck1vZGFsKTtcclxuYXZhdGFyRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuLy8gLS0tICdBZGQgY2FyZCcgZm9ybSB2YWxpZGF0aW9uIGFkZGluZyAtLS0gLy9cclxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgYWRkQ2FyZE1vZGFsKTtcclxuYWRkQ2FyZEZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8vIC0tLSBTdG9yZSB1c2VyIElEIC0tLSAvL1xyXG5sZXQgdXNlcklkOyIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxXaXRoSW1hZ2UgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgLy8gLS0tIE9wZW4gYmlnIGltYWdlIG1vZGFsIG1ldGhvZCAtLS0gLy9cclxuICBvcGVudXAgPSAoZXZlbnQpID0+IHtcclxuICAgIGNvbnN0IGJpZ0ltYWdlID0gZXZlbnQudGFyZ2V0O1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2JpZy1pbWFnZVwiKS5zcmMgPSBiaWdJbWFnZS5zcmM7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYmlnLWltYWdlXCIpLmFsdCA9IGJpZ0ltYWdlLmFsdDtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1jYXB0aW9uXCIpLnRleHRDb250ZW50ID0gYmlnSW1hZ2UuYWx0O1xyXG5cclxuICAgIHRoaXMub3BlbigpO1xyXG4gIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcblxyXG4gIGNsZWFyICgpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5jbGVhcigpO1xyXG4gICAgXHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChjYXJkKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGNhcmQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcigge25hbWUsIGpvYiwgYXZhdGFyfSApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAke25hbWV9YCk7XHJcbiAgICB0aGlzLl9qb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAke2pvYn1gKTtcclxuICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCR7YXZhdGFyfWApO1xyXG4gICAgdGhpcy5zZXRVc2VySW5mbyA9IHRoaXMuc2V0VXNlckluZm8uYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgY29uc3QgdXNlckluZm8gPSB7fTtcclxuICAgIHVzZXJJbmZvLnVzZXJOYW1lID0gdGhpcy5fbmFtZS50ZXh0Q29udGVudDtcclxuICAgIHVzZXJJbmZvLnVzZXJKb2IgPSB0aGlzLl9qb2IudGV4dENvbnRlbnQ7XHJcblxyXG4gICAgcmV0dXJuIHVzZXJJbmZvO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oZGF0YSkge1xyXG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2pvYi50ZXh0Q29udGVudCA9IGRhdGEuam9iO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckF2YXRhcigge2F2YXRhcn0gKSB7XHJcbiAgICB0aGlzLl9hdmF0YXIuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgnJHthdmF0YXJ9JylgO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiZmlyc3RDYWxsIiwidXJsIiwiaGVhZGVycyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXNUZXh0IiwiY29uc3RydWN0b3IiLCJiYXNlVXJsIiwidGhpcyIsImdldEluaXRpYWxDYXJkcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRVc2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJkYXRhIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhdmF0YXIiLCJsaW5rIiwic2VuZE5ld0RhdGEiLCJwcm9maWxlIiwibmFtZSIsImpvYiIsImNyZWF0ZU5ld0NhcmQiLCJjYXJkIiwicmVtb3ZlQ2FyZCIsImNhcmRJZCIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwiYXV0aG9yaXphdGlvbiIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiQ2FyZCIsImNhcmREYXRhIiwidXNlciIsIm9uQ2FyZENsaWNrIiwicmVtb3ZlSGFuZGxlciIsImxpa2VIYW5kbGVyIiwiY2FyZFNlbGVjdG9yIiwiX25hbWUiLCJfbGluayIsIl9jYXJkSWQiLCJfaWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX3VzZXJJRCIsIl9saWtlcyIsImxpa2VzIiwiX2NhcmRTZWxlY3RvciIsIl9vbkNhcmRDbGljayIsIl9saWtlSGFuZGxlciIsIl9yZW1vdmVIYW5kbGVyIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsImRlbGV0ZUNhcmQiLCJfaXRlbSIsInJlbW92ZSIsIl9yZW5kZXJMaWtlcyIsImlzTGlrZWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsImxlbmd0aCIsInNvbWUiLCJfdXNlcklkIiwidXBkYXRlTGlrZXMiLCJuZXdMaWtlcyIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsIl9saWtlQ2FyZCIsIl9jYXJkSW1hZ2UiLCJnZW5lcmF0ZUNhcmQiLCJfZWxlbWVudCIsInNyYyIsImFsdCIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtQ29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfZm9ybUNvbmZpZyIsIl9mb3JtRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yTWVzc2FnZUNsYXNzIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dHMiLCJmb3JFYWNoIiwiaW5wdXQiLCJfdG9nZ2xlU3VibWl0QnV0dG9uIiwiX2NoZWNrSW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfY2hlY2tJZkZvcm1WYWxpZCIsImV2ZXJ5IiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiYnV0dG9uRWxlbWVudCIsImRpc2FibGVkIiwiaW5wdXRTZWxlY3RvciIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJlZGl0QnV0dG9uIiwicHJvZmlsZU1vZGFsIiwiZm9ybXMiLCJhdmF0YXJFZGl0QnV0dG9uIiwiZWxlbWVudHMiLCJhdmF0YXJNb2RhbCIsImFkZENhcmRCdXR0b24iLCJhZGRDYXJkTW9kYWwiLCJhZGRDYXJkRm9ybSIsInRpdGxlIiwiZm9ybVNlbGVjdG9yIiwiTW9kYWwiLCJtb2RhbFNlbGVjdG9yIiwiX21vZGFsRWxlbWVudCIsIl9jaGVja0ZvckVzY0Nsb3NlIiwia2V5IiwiY2xvc2UiLCJvcGVuIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJNb2RhbFdpdGhGb3JtIiwiaGFuZGxlU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlU3VibWl0QnRuIiwiZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dExpc3QiLCJpbnB1dFZhbHVlcyIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXMiLCJyZXNldCIsIk1vZGFsRGVsZXRlQ29uZmlybWF0aW9uIiwic2VsZWN0b3IiLCJfZm9ybSIsIl9zZWxlY3RvciIsIl9oYW5kbGVTdWJtaXQiLCJfaGFuZGxlU3VibWl0SGFuZGxlciIsImJpbmQiLCJfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMiLCJiaWdJbWFnZU1vZGFsIiwib3BlbnVwIiwiYmlnSW1hZ2UiLCJjYXJkc1NlY3Rpb24iLCJpdGVtcyIsInJlbmRlcmVyIiwiY29udGFpbmVyU2VsZWN0b3IiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiY2xlYXIiLCJpbm5lckhUTUwiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJ1c2VySWQiLCJoYW5kbGVDYXJkQ2xpY2siLCJldnQiLCJoYW5kbGVEZWxldGVDYXJkIiwic2V0QWN0aW9uIiwiYXBpIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiaGFuZGxlTGlrZXMiLCJjcmVhdGVDYXJkIiwidXNlckluZm9WYWx1ZXMiLCJfam9iIiwiX2F2YXRhciIsInNldFVzZXJJbmZvIiwidXNlckluZm8iLCJ1c2VyTmFtZSIsInVzZXJKb2IiLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsImFib3V0IiwiZWRpdFByb2ZpbGVGb3JtIiwicHJvZmlsZUZvcm1WYWxpZGF0aW9uIiwiYXZhdGFyRm9ybSIsImF2YXRhckZvcm1WYWxpZGF0aW9uIiwibmV3Q2FyZCIsImFkZENhcmRGb3JtVmFsaWRhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=