!function(){"use strict";class e{constructor(e,t){this._formConfig=e,this._formElement=t,this.inputs=Array.from(this._formElement.querySelectorAll(this._formConfig.inputSelector)),this._buttonElement=this._formElement.querySelector(this._formConfig.submitButtonSelector)}_showInputError=(e,t)=>{const{inputErrorClass:s,errorMessageClass:r}=this._formConfig,n=this._formElement.querySelector(` #${e.id}_error `);n.textContent=t,n.classList.add(r),e.classList.add(s)};_hideInputError=e=>{const{inputErrorClass:t,errorMessageClass:s}=this._formConfig,r=this._formElement.querySelector(` #${e.id}_error `);r.textContent="",r.classList.remove(s),e.classList.remove(t)};_checkInput=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)};_checkIValid=()=>this.inputs.every((e=>e.validity.valid));_toggleSubmitButton(){this._checkIValid()?(this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._formConfig.inactiveButtonClass)):(this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._formConfig.inactiveButtonClass))}_setEventListeners=()=>(this.inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInput(e),this._toggleSubmitButton()}))})),this._formElement);enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class t{constructor(e,t,s,r,n,i,o){this._name=e.name,this._link=e.link,this._ownerId=e.owner._id,this._cardId=e._id,this._likes=e.likes,this._userId=o,this._template=i,this._onCardClick=t,this._likeAddHandler=r,this._likeRemoveHandler=n,this._removeHandler=s}_getTemplate(){return this._template.content.querySelector(".card").cloneNode(!0)}_setAttributes(e,t){for(const s in t)e.setAttribute(s,t[s])}deleteCard(){const e=document.getElementById(id);e&&e.parentNode.removeChild(e),this._cardElement=null}showLikes(e){this._cardElement.querySelector(".card__like-count").textContent=e}_handelLike(e){e.classList.toggle("card__like-button_active")}_setEventListeners(){this._cardLikeBtn=this._cardElement.querySelector(".card__like-button"),this._cardLikeBtn.addEventListener("click",(()=>{this._cardElement.classList.contains("card__like-button_active")?(this._likeRemoveHandler(this._cardId),this._handelLike(this._cardLikeBtn)):(this._likeAddHandler(this._cardId),this._handelLike(this._cardLikeBtn))})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._removeHandler(this._id)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._onCardClick(this._name,this._link)}))}_showDeleteIcon(){this._userId!=this._ownerId&&this._cardElement.querySelector(".card__delete-button").classList.add("card__delete-button_hidden")}getCardId(){return this._id}generateCard(){return this._cardElement=this._getTemplate(),this._card=this._cardElement,this._setAttributes(this._cardElement.querySelector(".card__image"),{src:this._link,alt:this._name}),this._cardElement.querySelector(".card__title").textContent=this._name,this._showDeleteIcon(),this.showLikes(this._likes.length),this._setEventListeners(),this._cardElement}}class s{constructor(e,t){this._modalElement=document.querySelector(e),this._escapeKeyHandler=this._escapeKeyHandler.bind(this),this._checkKeyPress=t}open(){this._modalElement.classList.add("modal_visible"),document.addEventListener("keyup",this._escapeKeyHandler)}close(){this._modalElement.classList.remove("modal_visible"),document.removeEventListener("keyup",this._escapeKeyHandler)}_escapeKeyHandler(e){this._checkKeyPress(e.key)&&this.close()}setEventListeners(){this._modalElement.addEventListener("click",(e=>{e.target.classList.contains("modal__close-button")&&this.close(),e.target.classList.contains("modal_visible")&&this.close()}))}}class r extends s{constructor(e,t,s){super(e,t),this._handleSubmit=s,this._submitButton=this._modalElement.querySelector(".modal__submit-button"),this._form=document.querySelector(".modal__container"),this._textInButton=this._submitButton.textContent}getInputValues(){this._inputList=this._modalElement.querySelectorAll(".modal__input");const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e||this._entredValue}setInputValues(e){this._entredValue=e}setEventListeners(){super.setEventListeners(),this._modalElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitButton.textContent="Saving...",this._handleSubmit(this.getInputValues())}))}close(){this._submitButton.textContent=this._textInButton,this._form.reset(),super.close()}}class n{constructor({items:e,renderer:t},s){this._renderedElements=e,this._renderer=t,this._container=document.querySelector(s)}renderItems(){this._renderedElements.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const i=document.querySelector(".profile__edit-button"),o=document.querySelector(".modal_type_edit"),a=document.querySelector(".profile__title"),l=document.querySelector(".modal__input_type_title"),d=document.querySelector(".profile__subtitle"),_=document.querySelector(".modal__input_type_subtitle"),c=(document.querySelector(".modal__close-button_type_edit"),document.querySelector(".profile__image")),h=document.querySelector(".profile__image_overlay"),u=document.querySelector(".modal_type_avatar"),m=u.querySelector(".modal__input_type_avatar"),p=(document.querySelector(".modal__close-button_type_avatar"),document.querySelector(".profile__add-button")),y=document.querySelector(".modal_type_add-card"),b=document.querySelector(".modal__input_type_name"),E=document.querySelector(".modal__input_type_link"),v=(document.querySelector(".modal__close-button_type_add-card"),document.forms.add),g=(v.elements.title,v.elements.link,document.querySelector(".modal__submit-button"),document.querySelector(".cards__grid"),document.querySelector("#card__template")),S=document.querySelector(".modal_type_big-image"),f=S.querySelector(".modal__big-image"),k=S.querySelector(".modal__image-caption"),C=(document.querySelector(".modal__close-button_type_big-image"),document.querySelector(".modal_type_delete-card"),{formSelector:".modal__container",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_error",errorMessageClass:"modal__error_visible"}),L=e=>"Escape"===e,I=()=>{b.value="",E.value=""};new e(C,o).enableValidation(),new e(C,u).enableValidation(),new e(C,y).enableValidation();const q=e=>console.log(e),U=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_response(e){return e.ok?e.json():Promise.reject(`Error: ${e.status} - ${e.statusText}`)}getCardList(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._response)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._response)}setUserInfo(e,t){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers,method:"PATCH",body:JSON.stringify(e,t)}).then(this._response)}addCard(e){return console.log(e),fetch(`${this._baseUrl}/cards`,{headers:this._headers,method:"POST",body:JSON.stringify(e.titleInput,e.linkInput)}).then(this._response)}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{headers:this._headers,method:"DELETE"}).then(this._response)}likeCard(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{headers:this._headers,method:"PUT"}).then(this._response)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{headers:this._headers,method:"DELETE"}).then(this._response)}setUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{headers:this._headers,method:"PATCH",body:JSON.stringify(e)}).then(this._response)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"709a0d9d-db06-4890-a594-b07e7309a353","Content-Type":"application/json"}}),w=new class{constructor(e,t,s){this._nameElement=e,this._titleElement=t,this._pictureElement=s}getUserInfo(){return{name:this._name.textContent,job:this._job.textContent}}getUserData(){return this._data}setUserInfo(e,t){this._name=e,this._job=t,this._nameElement.textContent=this._name,this._titleElement.textContent=this._job}}(a,d);U.getUserInfo().then((e=>(w.setUserInfo(e.name,e.about),c.src=e.avatar,w))).then((e=>{U.getCardList().then((s=>{const i=(e,t)=>{A.open(e,t)},o=e=>{$.setInputValues(e),$.open()},a=e=>{U.likeCard(e)},l=e=>{U.unlikeCard(e)},d=e=>new t(e,i,o,a,l,g),_=new n({items:s,renderer:t=>{const s=d(t);_.addItem(s.generateCard(e.id))}},".cards__grid");_.renderItems();const c=new r(".modal_type_add-card",L,(({titleInput:e,linkInput:t})=>{U.addCard({title:e,link:t}).then((()=>{d({title:e,link:t}),_.addItem(cardInstance.generateCard(user.id)),I(),c.close(I)})).catch(q)}));c.setEventListeners(),p.addEventListener("click",(()=>{c.open()}))})).catch(q)})).catch(q);const x=new r(".modal_type_edit",L,(({nameInput:e,jobInput:t})=>{U.setUserInfo({name:e,about:t}).then((()=>{x.close()})).catch(q)}));x.setEventListeners(),i.addEventListener("click",(()=>{l.value=a.textContent,_.value=d.textContent,x.open()}));const B=new r(".modal_type_avatar",L,(({avatarLinkInput:e})=>{U.setUserAvatar({avatar:e}).then((()=>{B.close()})).catch(q)}));B.setEventListeners(),h.addEventListener("click",(()=>{m.value="",B.open()}));const $=new r(".modal_type_delete-card",L,(e=>{U.deleteCard(e.getCardId()).then((()=>{e.deleteCard(),$.close()})).catch(q)}));$.setEventListeners();const A=new class extends s{constructor(e,t){super(e,t),this._modalImage=document.querySelector(".modal__big-image"),this._modalTitle=document.querySelector(".modal__image-caption")}open(e,t){this._modalTitle.textContent=e,this._modalImage.setAttribute("src",t),super.open()}}(".modal_type_big-image",L,f,k);A.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFLbEQsRUFBTUUsR0FDVGxELEtBQUswTixZQUFZeE0sWUFBYzhCLEVBQy9CaEQsS0FBS3lOLFlBQVluSixhQUFhLE1BQU9wQixHQUVyQ3dELE1BQU1SLFNKMkJzQix3QkN3SzlCdUQsRUFDQUgsRUFDQUMsR0FFRkYsRUFBY2hELG9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvSW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGZvcm1Db25maWcsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9mb3JtQ29uZmlnID0gZm9ybUNvbmZpZztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLmlucHV0cyA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9mb3JtQ29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2Zvcm1Db25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSA9PiB7XHJcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JNZXNzYWdlQ2xhc3MgfSA9IHRoaXMuX2Zvcm1Db25maWc7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAgIyR7aW5wdXRFbGVtZW50LmlkfV9lcnJvciBgKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGVycm9yTWVzc2FnZUNsYXNzKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuICBcclxuICBfaGlkZUlucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JNZXNzYWdlQ2xhc3MgfSA9IHRoaXMuX2Zvcm1Db25maWc7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAgIyR7aW5wdXRFbGVtZW50LmlkfV9lcnJvciBgKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShlcnJvck1lc3NhZ2VDbGFzcyk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShpbnB1dEVycm9yQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIF9jaGVja0lucHV0ID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9jaGVja0lWYWxpZCA9ICgpID0+IHRoaXMuaW5wdXRzLmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG5cclxuICBfdG9nZ2xlU3VibWl0QnV0dG9uKCkge1xyXG4gICAgaWYgKHRoaXMuX2NoZWNrSVZhbGlkKCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZm9ybUNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH0gXHJcbiAgICBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9mb3JtQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgdGhpcy5pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0KGlucHV0KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVTdWJtaXRCdXR0b24oKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLl9mb3JtRWxlbWVudDtcclxuICB9O1xyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvciggXHJcbiAgICBkYXRhLCBcclxuICAgIG9uQ2FyZENsaWNrLCBcclxuICAgIHJlbW92ZUhhbmRsZXIsIFxyXG4gICAgbGlrZUFkZEhhbmRsZXIsIFxyXG4gICAgbGlrZVJlbW92ZUhhbmRsZXIsIFxyXG4gICAgdGVtcGxhdGUsIFxyXG4gICAgdXNlcklkICkgXHJcbiAge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl9jYXJkSWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuXHJcbiAgICB0aGlzLl90ZW1wbGF0ZSA9IHRlbXBsYXRlO1xyXG4gICAgdGhpcy5fb25DYXJkQ2xpY2sgPSBvbkNhcmRDbGljaztcclxuICAgIHRoaXMuX2xpa2VBZGRIYW5kbGVyID0gbGlrZUFkZEhhbmRsZXI7XHJcbiAgICB0aGlzLl9saWtlUmVtb3ZlSGFuZGxlciA9IGxpa2VSZW1vdmVIYW5kbGVyO1xyXG4gICAgdGhpcy5fcmVtb3ZlSGFuZGxlciA9IHJlbW92ZUhhbmRsZXI7XHJcbiAgfVxyXG4gIC8vIC0tLSBHZXQgY2FyZCB0ZW1wbGF0ZSAtLS0gLy9cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IHRoaXMuX3RlbXBsYXRlXHJcbiAgICAuY29udGVudFxyXG4gICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJylcclxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3NldEF0dHJpYnV0ZXMoY2FyZEVsZW1lbnQsIGF0dHJpYnMpIHtcclxuICAgIGZvciAoY29uc3Qga2V5IGluIGF0dHJpYnMpIHtcclxuICAgICAgY2FyZEVsZW1lbnQuc2V0QXR0cmlidXRlKGtleSwgYXR0cmlic1trZXldKTtcclxuICAgIH1cclxuICB9XHJcbiAgLy8gLS0tIENhcmQgZGVsZXRpbmcgbWV0aG9kIC0tLSAvL1xyXG4gIGRlbGV0ZUNhcmQoKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcclxuICAgIGlmKGNhcmRFbGVtZW50KXtcclxuICAgICAgY2FyZEVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChjYXJkRWxlbWVudCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG4gIC8vIC0tLSBTaG93IHRoZSBsaWtlIGFtb3VudCAtLS0gLy9cclxuICBzaG93TGlrZXMoY291bnQpe1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtY291bnQnKS50ZXh0Q29udGVudCA9IGNvdW50O1xyXG4gIH1cclxuICAvLyAtLS0gTGlrZSBoYW5kbGVyIC0tLSAvL1xyXG4gIF9oYW5kZWxMaWtlKGxpa2VCdG4pIHtcclxuICAgIGxpa2VCdG4uY2xhc3NMaXN0LnRvZ2dsZSgnY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlJylcclxuICB9XHJcbiAgLy8gLS0tIFNldCBldmVudHMgbGlzdGVuZXJzIGZvciB0aGUgY2FyZHMgdGhhdCB3aWxsIGJlIGNyZWF0ZWQhIC0tLSAvL1xyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2NhcmRMaWtlQnRuID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJyk7XHJcbiAgICB0aGlzLl9jYXJkTGlrZUJ0blxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICBpZighdGhpcy5fY2FyZEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmUnKSkge1xyXG4gICAgICAgICAgdGhpcy5fbGlrZUFkZEhhbmRsZXIodGhpcy5fY2FyZElkKTtcclxuICAgICAgICAgIHRoaXMuX2hhbmRlbExpa2UodGhpcy5fY2FyZExpa2VCdG4pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuX2xpa2VSZW1vdmVIYW5kbGVyKHRoaXMuX2NhcmRJZCk7XHJcbiAgICAgICAgICB0aGlzLl9oYW5kZWxMaWtlKHRoaXMuX2NhcmRMaWtlQnRuKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnV0dG9uJylcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fcmVtb3ZlSGFuZGxlcih0aGlzLl9pZCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9vbkNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBfc2hvd0RlbGV0ZUljb24oKSB7XHJcbiAgICBpZih0aGlzLl91c2VySWQgIT0gdGhpcy5fb3duZXJJZCkge1xyXG4gICAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ1dHRvbicpLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2RlbGV0ZS1idXR0b25faGlkZGVuJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRDYXJkSWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faWQ7XHJcbiAgfVxyXG5cclxuICAvLyAtLS0gQ3JlYXRpbmcgdGhlIGNhcmQgYW5kIGNhcmQgZWxlbWVudHMgLS0tIC8vXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fY2FyZCA9IHRoaXMuX2NhcmRFbGVtZW50O1xyXG5cclxuICAgIHRoaXMuX3NldEF0dHJpYnV0ZXModGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJyksIHtcclxuICAgICAgc3JjOiB0aGlzLl9saW5rLFxyXG4gICAgICBhbHQ6IHRoaXMuX25hbWVcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJykudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuX3Nob3dEZWxldGVJY29uKCk7XHJcbiAgICB0aGlzLnNob3dMaWtlcyh0aGlzLl9saWtlcy5sZW5ndGgpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3RvciggbW9kYWxTZWxlY3RvciwgY2hlY2tLZXlQcmVzcyApIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobW9kYWxTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9lc2NhcGVLZXlIYW5kbGVyID0gdGhpcy5fZXNjYXBlS2V5SGFuZGxlci5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5fY2hlY2tLZXlQcmVzcyA9IGNoZWNrS2V5UHJlc3M7XHJcbiAgfVxyXG4gIC8vIC0tLSBPcGVuIG1vZGFsIG1ldGhvZCAtLS0gLy8gXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfdmlzaWJsZVwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9lc2NhcGVLZXlIYW5kbGVyKTtcclxuICB9XHJcbiAgLy8gLS0tIENsb3NlIG1vZGFsIG1ldGhvZCAtLS0gLy9cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfdmlzaWJsZVwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9lc2NhcGVLZXlIYW5kbGVyKTtcclxuICB9XHJcbiAgLy8gLS0tIENsb3NlIG1vZGFsIG9uIEVTQyBtZXRob2QgLS0tIC8vXHJcbiAgX2VzY2FwZUtleUhhbmRsZXIoZXZlbnQpIHtcclxuICAgIGlmICh0aGlzLl9jaGVja0tleVByZXNzKGV2ZW50LmtleSkpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnRcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgICAvLyAtLS0gQ2xvc2UgbW9kYWwgb24gY2xvc2UoJ1gnKSBidXR0b24gLS0tIC8vXHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX19jbG9zZS1idXR0b24nKSkge1xyXG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBDbG9zZSBtb2RhbCBvbiBvdmVybGF5KG91dCBvZiB0aGUgbW9kYWwpIGNsaWNrIC0tLSAvLy9cclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfdmlzaWJsZScpKSB7XHJcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufSIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxXaXRoRm9ybSBleHRlbmRzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3RvcihzZWxlY3RvciwgY2hlY2tLZXlQcmVzcywgaGFuZGxlU3VibWl0ICkge1xyXG4gICAgc3VwZXIoc2VsZWN0b3IsIGNoZWNrS2V5UHJlc3MpO1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gaGFuZGxlU3VibWl0O1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fc3VibWl0LWJ1dHRvbicpO1xyXG4gICAgdGhpcy5fZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY29udGFpbmVyJyk7XHJcbiAgICB0aGlzLl90ZXh0SW5CdXR0b24gPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBnZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubW9kYWxfX2lucHV0Jyk7XHJcbiAgICBjb25zdCBmb3JtSW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdFxyXG4gICAgICAuZm9yRWFjaCgoaW5wdXQpID0+IHsgZm9ybUlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWUgfVxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gZm9ybUlucHV0VmFsdWVzIHx8IHRoaXMuX2VudHJlZFZhbHVlO1xyXG4gIH1cclxuXHJcbiAgc2V0SW5wdXRWYWx1ZXMoZW50cmVkVmFsdWUpIHtcclxuICAgIHRoaXMuX2VudHJlZFZhbHVlID0gZW50cmVkVmFsdWU7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgLy8gLS0tIFVYIGZvciBtb2RhbHMgLS0tIC8vXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCh0aGlzLmdldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fdGV4dEluQnV0dG9uO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZWRFbGVtZW50cyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlZEVsZW1lbnRzLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSlcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShpdGVtKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcclxuICB9XHJcbn1cclxuIiwiLy8gLS0tICdFZGl0IHByb2ZpbGUnIG1vZGFsIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2VkaXQnKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3RpdGxlJyk7XHJcbmV4cG9ydCBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lucHV0X3R5cGVfdGl0bGUnKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fc3VidGl0bGUnKTtcclxuZXhwb3J0IGNvbnN0IGpvYklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX3N1YnRpdGxlJyk7XHJcbmV4cG9ydCBjb25zdCBlZGl0Q2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX2VkaXQnKTtcclxuLy8gLS0tICdBdmF0YXJcIiBtb2RhbCBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCB1c2VyQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlJyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlX292ZXJsYXknKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfYXZhdGFyJyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJNb2RhbElucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX2F2YXRhcicpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX2F2YXRhcicpXHJcbi8vIC0tLSAnQWRkLWNhcmQnIG1vZGFsIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfYWRkLWNhcmQnKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRJbnB1dFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX25hbWUnKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRJbnB1dExpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lucHV0X3R5cGVfbGluaycpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9hZGQtY2FyZCcpO1xyXG4vLyAtLS0gJ0FkZC1DYXJkJyBmb3JtIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXMuYWRkO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm1UaXRlbCA9IGFkZENhcmRGb3JtLmVsZW1lbnRzLnRpdGxlO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm1MaW5rID0gYWRkQ2FyZEZvcm0uZWxlbWVudHMubGluaztcclxuLy8gLS0tIEdlbmVyYWwgY29uc3QgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3N1Ym1pdC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRzX19ncmlkJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZF9fdGVtcGxhdGUnKTtcclxuLy8gLS0tIEJpZyBpbWFnZSBtb2RhbCBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBiaWdJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfYmlnLWltYWdlJyk7XHJcbmV4cG9ydCBjb25zdCBiaWdJbWFnZSA9IGJpZ0ltYWdlTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19iaWctaW1hZ2UnKTtcclxuZXhwb3J0IGNvbnN0IGJpZ0ltYWdlVGl0bGUgPSBiaWdJbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW1hZ2UtY2FwdGlvbicpO1xyXG5leHBvcnQgY29uc3QgY2FyZEJpZ01vZGFsQ2xvc2VJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9iaWctaW1hZ2UnKTtcclxuLy8gLS0tICdEZWxldGUgY2FyZCcgbW9kYWwgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2RlbGV0ZS1jYXJkJyk7XHJcbi8vIC0tLSBTZWxlY3RvcnMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlTW9kYWxTZWxlY3RvciA9ICcubW9kYWxfdHlwZV9lZGl0JztcclxuZXhwb3J0IGNvbnN0IGF2YXRhck1vZGFsU2VsZWN0b3IgPSAnLm1vZGFsX3R5cGVfYXZhdGFyJztcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbFNlbGVjdG9yID0gJy5tb2RhbF90eXBlX2FkZC1jYXJkJztcclxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmRTZWxlY3RvciA9ICcubW9kYWxfdHlwZV9kZWxldGUtY2FyZCc7XHJcbmV4cG9ydCBjb25zdCBiaWdJbWFnZVNlbGVjdG9yID0gJy5tb2RhbF90eXBlX2JpZy1pbWFnZSc7XHJcbmV4cG9ydCBjb25zdCBjYXJkTGlzdFNlbGVjdG9yID0gJy5jYXJkc19fZ3JpZCdcclxuLy8gLS0tIEZvcm0gY29uZmlnIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGZvcm1Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fY29udGFpbmVyXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfZXJyb3JcIixcclxuICBlcnJvck1lc3NhZ2VDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiXHJcbn07XHJcbi8vIC0tLSBBUEkgY29uc3QgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBhcGlDb25maWcgPSB7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgaGVhZGVyczogXHJcbiAge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI3MDlhMGQ5ZC1kYjA2LTQ4OTAtYTU5NC1iMDdlNzMwOWEzNTNcIixcclxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgXHJcbiAgfSxcclxufTsiLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBNb2RhbFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBNb2RhbFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvQXBpLmpzXCJcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgcHJvZmlsZU5hbWUsXHJcbiAgcHJvZmlsZUpvYixcclxuICBlZGl0QnV0dG9uLFxyXG4gIGNhcmRMaXN0U2VsZWN0b3IsXHJcbiAgcHJvZmlsZU1vZGFsLFxyXG4gIHByb2ZpbGVNb2RhbFNlbGVjdG9yLFxyXG4gIGNhcmRUZW1wbGF0ZSxcclxuICBhZGRDYXJkQnV0dG9uLFxyXG4gIGFkZENhcmRNb2RhbCxcclxuICBhZGRDYXJkTW9kYWxTZWxlY3RvcixcclxuICBjYXJkSW5wdXRUaXRsZSxcclxuICBjYXJkSW5wdXRMaW5rLFxyXG4gIGF2YXRhck1vZGFsLFxyXG4gIGF2YXRhck1vZGFsU2VsZWN0b3IsXHJcbiAgYXZhdGFyTW9kYWxJbnB1dCxcclxuICB1c2VyQXZhdGFyLFxyXG4gIGF2YXRhckVkaXRCdXR0b24sXHJcbiAgYmlnSW1hZ2VTZWxlY3RvcixcclxuICBiaWdJbWFnZSxcclxuICBiaWdJbWFnZVRpdGxlLFxyXG4gIGRlbGV0ZUNhcmRTZWxlY3RvcixcclxuICBhcGlDb25maWcsXHJcbiAgZm9ybUNvbmZpZyxcclxuICBuYW1lSW5wdXQsXHJcbiAgam9iSW5wdXRcclxufSBmcm9tIFwiLi4vY29tcG9uZW50cy91dGlscy9jb25zdGFudHMuanNcIjtcclxuXHJcbi8vID09PT09IE1vZGFscyA9PT09PSAvL1xyXG4vLyAtLS0gJ0VzYycgY2hlY2sgLS0tIC8vXHJcbmNvbnN0IGNoZWNrRm9yRXNjUHJlc3NlZCA9IChrZXkpID0+IGtleSA9PT0gXCJFc2NhcGVcIjtcclxuLy8gLS0tIEFkZCBtb2RhbCByZXNldCBpbnB1dCAtLS0gLy9cclxuY29uc3QgbW9kYWxSZXNldElucHV0cyA9ICgpID0+IHtcclxuICBjYXJkSW5wdXRUaXRsZS52YWx1ZSA9IFwiXCI7XHJcbiAgY2FyZElucHV0TGluay52YWx1ZSA9IFwiXCI7XHJcbn1cclxuXHJcbi8vID09PT09IFZhbGlkYXRpb24gPT09PT0gLy9cclxuLy8gLS0tICdFZGl0IHByb2ZpbGUnIGZvcm0gdmFsaWRhdGlvbiAtLS0gLy9cclxuY29uc3QgcHJvZmlsZUZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgcHJvZmlsZU1vZGFsKTtcclxucHJvZmlsZUZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuLy8gLS0tICdBdmF0YXInIGZvcm0gdmFsaWRhdGlvbiAtLS0gLy9cclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBhdmF0YXJNb2RhbCk7XHJcbmF2YXRhckZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuLy8gLS0tICdBZGQgY2FyZCcgZm9ybSB2YWxpZGF0aW9uIC0tLSAvL1xyXG5jb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBhZGRDYXJkTW9kYWwpO1xyXG5hZGRDYXJkRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuLy8gPT09PT0gQVBJICYgQ2FyZCA9PT09PSAvL1xyXG4vLyAtLS0gQVBJIGVycm9yIGhhbmRsZXIgLS0tIC8vIFxyXG5jb25zdCBhcGlFcnIgPSAoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpO1xyXG4vLyAtLS0gU2V0dGluZyB0aGUgZGVmYXVsdCBmZXRjaGluZyBtZXRob2QgLS0tIC8vXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoYXBpQ29uZmlnKTtcclxuLy8gLS0tIFNldCB3aGF0ICdwcm9maWxlJyB3aWxsIGNvbnRhaW5zIC0tLSAvL1xyXG5jb25zdCBwcm9maWxlID0gbmV3IFVzZXJJbmZvKFxyXG4gIHByb2ZpbGVOYW1lLCBcclxuICBwcm9maWxlSm9iXHJcbik7XHJcbmFwaVxyXG4gIC8vIC0tLSBHZXQgdXNlciBpbmZvIG1ldGhvZCAtLS0gLy9cclxuICAuZ2V0VXNlckluZm8oKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIHByb2ZpbGUuc2V0VXNlckluZm8ocmVzLm5hbWUsIHJlcy5hYm91dCk7XHJcbiAgICB1c2VyQXZhdGFyLnNyYyA9IHJlcy5hdmF0YXI7XHJcbiAgICByZXR1cm4gcHJvZmlsZTtcclxuICB9KVxyXG4gIC8vIC0tLSBVc2UgdXNlciBpbmZvIGZvciBjcmVhdGlvbiBvZiBuZXcgY2FyZHMgYW5kIGNhcmQgc2VjdGlvbiAtLS0gLy8gXHJcbiAgLnRoZW4oKHByb2ZpbGUpID0+IHtcclxuICAgIGFwaVxyXG4gICAgICAuZ2V0Q2FyZExpc3QoKVxyXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIC8vIC0tLSBPbiBjYXJkIGNsaWNrIGhhbmRsZXIgLS0tIC8vXHJcbiAgICAgICAgY29uc3Qgb25DYXJkQ2xpY2sgPSAoIG5hbWUsIGxpbmsgKSA9PiB7XHJcbiAgICAgICAgICBiaWdJbWFnZU1vZGFsLm9wZW4obmFtZSwgbGluayk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyAtLS0gRGVsZXRlIGNhcmQgYnV0dG9uIGhhbmRsZXIgLS0tIC8vXHJcbiAgICAgICAgY29uc3QgZGVsZXRlQ2FyZEhhbmRsZXIgPSAoY2FyZCkgPT4ge1xyXG4gICAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLnNldElucHV0VmFsdWVzKGNhcmQpO1xyXG4gICAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLm9wZW4oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gLS0tIExpa2UgYnV0dG9uIGNsaWNrIGhhbmRsZXIgLS0tIC8vXHJcbiAgICAgICAgY29uc3QgbGlrZUFkZEhhbmRsZXIgPSAoY2FyZElkKSA9PiB7XHJcbiAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgLmxpa2VDYXJkKGNhcmRJZCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBsaWtlUmVtb3ZlSGFuZGxlciA9IChjYXJkSWQpID0+IHtcclxuICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAudW5saWtlQ2FyZChjYXJkSWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyAtLS0gTmV3IGNhcmQgaW5zdGFuY2UgYWRkaW5nIC0tLSAvL1xyXG4gICAgICAgIGNvbnN0IG5ld0NhcmRJbnN0YW5jZSA9IChkYXRhKSA9PiB7IFxyXG4gICAgICAgICAgY29uc3QgY2FyZEluc3RhbmNlID0gbmV3IENhcmQoXHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIG9uQ2FyZENsaWNrLFxyXG4gICAgICAgICAgICBkZWxldGVDYXJkSGFuZGxlcixcclxuICAgICAgICAgICAgbGlrZUFkZEhhbmRsZXIsXHJcbiAgICAgICAgICAgIGxpa2VSZW1vdmVIYW5kbGVyLFxyXG4gICAgICAgICAgICBjYXJkVGVtcGxhdGVcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgICByZXR1cm4gY2FyZEluc3RhbmNlO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbiAoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaXRlbXM6IGRhdGEsXHJcbiAgICAgICAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2FyZEluc3RhbmNlID0gbmV3Q2FyZEluc3RhbmNlKGl0ZW0pO1xyXG4gICAgICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRJbnN0YW5jZS5nZW5lcmF0ZUNhcmQocHJvZmlsZS5pZCkpXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2FyZExpc3RTZWxlY3RvclxyXG4gICAgICApO1xyXG4gICAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG5cclxuICAgICAgY29uc3QgYWRkTmV3Q2FyZE1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0gKFxyXG4gICAgICAgIGFkZENhcmRNb2RhbFNlbGVjdG9yLFxyXG4gICAgICAgIGNoZWNrRm9yRXNjUHJlc3NlZCxcclxuICAgICAgICAoe3RpdGxlSW5wdXQ6dGl0bGUsIGxpbmtJbnB1dDpsaW5rfSkgPT4ge1xyXG4gICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgIC5hZGRDYXJkKHt0aXRsZSxsaW5rfSlcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgIG5ld0NhcmRJbnN0YW5jZSh7dGl0bGUsbGlua30pO1xyXG4gICAgICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEluc3RhbmNlLmdlbmVyYXRlQ2FyZCh1c2VyLmlkKSk7XHJcbiAgICAgICAgICAgICAgbW9kYWxSZXNldElucHV0cygpO1xyXG4gICAgICAgICAgICAgIGFkZE5ld0NhcmRNb2RhbC5jbG9zZShtb2RhbFJlc2V0SW5wdXRzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGFwaUVycilcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcbiAgICAgIGFkZE5ld0NhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICBhZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgYWRkTmV3Q2FyZE1vZGFsLm9wZW4oKTtcclxuICAgICAgfSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGFwaUVycik7XHJcbn0pXHJcbi5jYXRjaChhcGlFcnIpO1xyXG5cclxuXHJcbi8vID09PT09ICdFZGl0JyBwcm9maWxlID09PT09IC8vXHJcbi8vIC0tLSBFZGl0IHByb2ZpbGUgbW9kYWwgLS0tIC8vXHJcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBuZXcgTW9kYWxXaXRoRm9ybSAoXHJcbiAgcHJvZmlsZU1vZGFsU2VsZWN0b3IsXHJcbiAgY2hlY2tGb3JFc2NQcmVzc2VkLFxyXG4gICh7bmFtZUlucHV0OiBuYW1lLCBqb2JJbnB1dDphYm91dH0pID0+IFxyXG4gIHtcclxuICAgIGFwaVxyXG4gICAgICAuc2V0VXNlckluZm8oe25hbWUsYWJvdXR9KVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgZWRpdFByb2ZpbGVNb2RhbC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goYXBpRXJyKTtcclxuICB9XHJcbilcclxuZWRpdFByb2ZpbGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4vLyAtLS0gRWRpdCBidXR0b24gaGFuZGxlciAtLS0gLy8gXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIgLCAoKSA9PiB7XHJcbiAgbmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgam9iSW5wdXQudmFsdWUgPSBwcm9maWxlSm9iLnRleHRDb250ZW50O1xyXG4gIGVkaXRQcm9maWxlTW9kYWwub3BlbigpO1xyXG59KTtcclxuLy8gLS0tIEF2YXRhciBlZGl0IG1vZGFsIC0tLSAvL1xyXG5jb25zdCBhdmF0YXJFZGl0TW9kYWwgPSBuZXcgTW9kYWxXaXRoRm9ybSAoXHJcbiAgYXZhdGFyTW9kYWxTZWxlY3RvcixcclxuICBjaGVja0ZvckVzY1ByZXNzZWQsXHJcbiAgKHsgYXZhdGFyTGlua0lucHV0OmF2YXRhciB9KSA9PiBcclxuICB7XHJcbiAgICBhcGlcclxuICAgICAgLnNldFVzZXJBdmF0YXIoe2F2YXRhcn0pXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBhdmF0YXJFZGl0TW9kYWwuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGFwaUVycik7XHJcbiAgfVxyXG4pO1xyXG5hdmF0YXJFZGl0TW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuLy8gLS0tIEF2YXRhciBlZGl0IGJ1dHRvbiAtLS0gLy9cclxuYXZhdGFyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGF2YXRhck1vZGFsSW5wdXQudmFsdWUgPSBcIlwiO1xyXG4gIGF2YXRhckVkaXRNb2RhbC5vcGVuKCk7XHJcbn0pXHJcblxyXG4vLyAtLS0gRGVsZXRlIGNhcmQgbW9kYWwgaW5zdGFuY2UgYW5kIGV2ZW50cyAtLS0gLy9cclxuY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oXHJcbiAgZGVsZXRlQ2FyZFNlbGVjdG9yLFxyXG4gIGNoZWNrRm9yRXNjUHJlc3NlZCxcclxuICAoY2FyZCkgPT4ge1xyXG4gICAgYXBpXHJcbiAgICAgIC5kZWxldGVDYXJkKGNhcmQuZ2V0Q2FyZElkKCkpXHJcbiAgICAgIC50aGVuKCgpID0+e1xyXG4gICAgICAgIGNhcmQuZGVsZXRlQ2FyZCgpO1xyXG4gICAgICAgIGRlbGV0ZUNhcmRNb2RhbC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goYXBpRXJyKTtcclxuICB9XHJcbik7XHJcbmRlbGV0ZUNhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4vLyAtLS0gQmlnIGltYWdlIG1vZGFsIGluc3RhbmNlIC0tLSAvL1xyXG5jb25zdCBiaWdJbWFnZU1vZGFsID0gbmV3IE1vZGFsV2l0aEltYWdlKFxyXG4gIGJpZ0ltYWdlU2VsZWN0b3IsXHJcbiAgY2hlY2tGb3JFc2NQcmVzc2VkLFxyXG4gIGJpZ0ltYWdlLFxyXG4gIGJpZ0ltYWdlVGl0bGVcclxuKTtcclxuYmlnSW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGNvbmZpZy5iYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzO1xyXG4gIH1cclxuICAvLyAtLS0gR2xvYmFsIEFQSSByZXNwb25zZSBtZXRob2QgLS0tIC8vXHJcbiAgX3Jlc3BvbnNlKHJlcykge1xyXG4gICAgcmV0dXJuIHJlcy5va1xyXG4gICAgPyByZXMuanNvbigpXHJcbiAgICA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfSAtICR7cmVzLnN0YXR1c1RleHR9YCk7XHJcbiAgfVxyXG4gIC8vIC0tLSBHZXQgY2FyZCBsaXN0IGZyb20gdGhlIHNlcnZlciAtLS0gLy9cclxuICBnZXRDYXJkTGlzdCgpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fcmVzcG9uc2UpXHJcbiAgICApO1xyXG4gIH1cclxuICAvLyAtLS0gR2V0IHVzZXIgaW5mbyBmcm9tIHRoZSBzZXJ2ZXIgLS0tIC8vXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9yZXNwb25zZSlcclxuICB9XHJcbiAgLy8gLS0tIFVwZGF0aW5nL0VkaXRpbmcgdXNlciBwcm9maWxlIGluZm8gLS0tIC8vXHJcbiAgc2V0VXNlckluZm8obmFtZSwgYWJvdXQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KFxyXG4gICAgICAgIG5hbWUsIFxyXG4gICAgICAgIGFib3V0XHJcbiAgICAgIClcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9yZXNwb25zZSlcclxuICB9XHJcbiAgLy8gLS0tIEFkZGluZyBuZXcgY2FyZCAtLS0gLy9cclxuICBhZGRDYXJkKGRhdGEpIHtcclxuICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShcclxuICAgICAgICBkYXRhLnRpdGxlSW5wdXQsIFxyXG4gICAgICAgIGRhdGEubGlua0lucHV0XHJcbiAgICAgIClcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9yZXNwb25zZSlcclxuICB9XHJcbiAgLy8gLS0tIFJlbW92aW5nIGEgY2FyZCAtLS0gLy9cclxuICByZW1vdmVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fcmVzcG9uc2UpXHJcbiAgfVxyXG4gIC8vIC0tLSBMaWtlIGEgY2FyZCAtLS0gLy9cclxuICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIlxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX3Jlc3BvbnNlKVxyXG4gIH1cclxuICAvLyAtLS0gVW5saWtlIGEgY2FyZCAtLS0gLy9cclxuICB1bmxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIlxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX3Jlc3BvbnNlKVxyXG4gIH1cclxuICAvLyAtLS0gU2V0dGluZyB1c2VyIHByb2ZpbGUgYXZhdGFyIC0tLSAvL1xyXG4gIHNldFVzZXJBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoXHJcbiAgICAgICAgICBhdmF0YXJcclxuICAgICAgKVxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX3Jlc3BvbnNlKVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoIG5hbWVFbGVtZW50LCB0aXRsZUVsZW1lbnQsIHBpY3R1cmVFbGVtZW50ICkge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBuYW1lRWxlbWVudDtcclxuICAgIHRoaXMuX3RpdGxlRWxlbWVudCA9IHRpdGxlRWxlbWVudDtcclxuICAgIHRoaXMuX3BpY3R1cmVFbGVtZW50ID0gcGljdHVyZUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGpvYjogdGhpcy5fam9iLnRleHRDb250ZW50XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckRhdGEoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZGF0YTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKG5hbWUsIGpvYikge1xyXG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2IgPSBqb2I7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl90aXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9qb2I7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxXaXRoSW1hZ2UgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgY29uc3RydWN0b3IoIG1vZGFsLCBjaGVja0tleVByZXNzICl7XHJcbiAgICBzdXBlciggbW9kYWwsIGNoZWNrS2V5UHJlc3MgKTtcclxuICAgIHRoaXMuX21vZGFsSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2JpZy1pbWFnZScpO1xyXG4gICAgdGhpcy5fbW9kYWxUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW1hZ2UtY2FwdGlvbicpO1xyXG4gIH1cclxuICAvLyAtLS0gT3BlbiBiaWcgaW1hZ2UgbW9kYWwgbWV0aG9kIC0tLSAvL1xyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgdGhpcy5fbW9kYWxUaXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9tb2RhbEltYWdlLnNldEF0dHJpYnV0ZShcInNyY1wiLCBsaW5rKTsgXHJcblxyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJmb3JtQ29uZmlnIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2Zvcm1Db25maWciLCJfZm9ybUVsZW1lbnQiLCJpbnB1dHMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsIl9idXR0b25FbGVtZW50IiwicXVlcnlTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JNZXNzYWdlQ2xhc3MiLCJlcnJvckVsZW1lbnQiLCJpZCIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiX2hpZGVJbnB1dEVycm9yIiwicmVtb3ZlIiwiX2NoZWNrSW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfY2hlY2tJVmFsaWQiLCJldmVyeSIsImlucHV0IiwiX3RvZ2dsZVN1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9zZXRFdmVudExpc3RlbmVycyIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJDYXJkIiwiZGF0YSIsIm9uQ2FyZENsaWNrIiwicmVtb3ZlSGFuZGxlciIsImxpa2VBZGRIYW5kbGVyIiwibGlrZVJlbW92ZUhhbmRsZXIiLCJ0ZW1wbGF0ZSIsInVzZXJJZCIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9vd25lcklkIiwib3duZXIiLCJfaWQiLCJfY2FyZElkIiwiX2xpa2VzIiwibGlrZXMiLCJfdXNlcklkIiwiX3RlbXBsYXRlIiwiX29uQ2FyZENsaWNrIiwiX2xpa2VBZGRIYW5kbGVyIiwiX2xpa2VSZW1vdmVIYW5kbGVyIiwiX3JlbW92ZUhhbmRsZXIiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEF0dHJpYnV0ZXMiLCJjYXJkRWxlbWVudCIsImF0dHJpYnMiLCJrZXkiLCJzZXRBdHRyaWJ1dGUiLCJkZWxldGVDYXJkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsIl9jYXJkRWxlbWVudCIsInNob3dMaWtlcyIsImNvdW50IiwiX2hhbmRlbExpa2UiLCJsaWtlQnRuIiwidG9nZ2xlIiwiX2NhcmRMaWtlQnRuIiwiY29udGFpbnMiLCJfc2hvd0RlbGV0ZUljb24iLCJnZXRDYXJkSWQiLCJnZW5lcmF0ZUNhcmQiLCJfY2FyZCIsInNyYyIsImFsdCIsImxlbmd0aCIsIk1vZGFsIiwibW9kYWxTZWxlY3RvciIsImNoZWNrS2V5UHJlc3MiLCJfbW9kYWxFbGVtZW50IiwiX2VzY2FwZUtleUhhbmRsZXIiLCJiaW5kIiwiX2NoZWNrS2V5UHJlc3MiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJNb2RhbFdpdGhGb3JtIiwic2VsZWN0b3IiLCJoYW5kbGVTdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVTdWJtaXQiLCJfc3VibWl0QnV0dG9uIiwiX2Zvcm0iLCJfdGV4dEluQnV0dG9uIiwiZ2V0SW5wdXRWYWx1ZXMiLCJfaW5wdXRMaXN0IiwiZm9ybUlucHV0VmFsdWVzIiwidmFsdWUiLCJfZW50cmVkVmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsImVudHJlZFZhbHVlIiwicmVzZXQiLCJTZWN0aW9uIiwiaXRlbXMiLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX3JlbmRlcmVkRWxlbWVudHMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsInByZXBlbmQiLCJlZGl0QnV0dG9uIiwicHJvZmlsZU1vZGFsIiwicHJvZmlsZU5hbWUiLCJuYW1lSW5wdXQiLCJwcm9maWxlSm9iIiwiam9iSW5wdXQiLCJ1c2VyQXZhdGFyIiwiYXZhdGFyRWRpdEJ1dHRvbiIsImF2YXRhck1vZGFsIiwiYXZhdGFyTW9kYWxJbnB1dCIsImFkZENhcmRCdXR0b24iLCJhZGRDYXJkTW9kYWwiLCJjYXJkSW5wdXRUaXRsZSIsImNhcmRJbnB1dExpbmsiLCJhZGRDYXJkRm9ybSIsImZvcm1zIiwiY2FyZFRlbXBsYXRlIiwiZWxlbWVudHMiLCJ0aXRsZSIsImJpZ0ltYWdlTW9kYWwiLCJiaWdJbWFnZSIsImJpZ0ltYWdlVGl0bGUiLCJmb3JtU2VsZWN0b3IiLCJjaGVja0ZvckVzY1ByZXNzZWQiLCJtb2RhbFJlc2V0SW5wdXRzIiwiYXBpRXJyIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImFwaSIsImNvbmZpZyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsIl9yZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwiZ2V0Q2FyZExpc3QiLCJmZXRjaCIsInRoZW4iLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZENhcmQiLCJ0aXRsZUlucHV0IiwibGlua0lucHV0IiwicmVtb3ZlQ2FyZCIsImNhcmRJZCIsImxpa2VDYXJkIiwidW5saWtlQ2FyZCIsInNldFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwicHJvZmlsZSIsIm5hbWVFbGVtZW50IiwidGl0bGVFbGVtZW50IiwicGljdHVyZUVsZW1lbnQiLCJfbmFtZUVsZW1lbnQiLCJfdGl0bGVFbGVtZW50IiwiX3BpY3R1cmVFbGVtZW50Iiwiam9iIiwiX2pvYiIsImdldFVzZXJEYXRhIiwiX2RhdGEiLCJkZWxldGVDYXJkSGFuZGxlciIsImNhcmQiLCJkZWxldGVDYXJkTW9kYWwiLCJuZXdDYXJkSW5zdGFuY2UiLCJjYXJkU2VjdGlvbiIsImNhcmRJbnN0YW5jZSIsImFkZE5ld0NhcmRNb2RhbCIsInVzZXIiLCJjYXRjaCIsImVkaXRQcm9maWxlTW9kYWwiLCJhdmF0YXJFZGl0TW9kYWwiLCJhdmF0YXJMaW5rSW5wdXQiLCJtb2RhbCIsIl9tb2RhbEltYWdlIiwiX21vZGFsVGl0bGUiXSwic291cmNlUm9vdCI6IiJ9