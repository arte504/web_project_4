!function(){"use strict";var e={};(function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e),new class{constructor({baseUrl:e,headers:t}){this.baseUrl=e,this.headers=t}getInitialCards(){return fetch(this.baseUrl+"/cards",{headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch(this.baseUrl+"/users/me",{headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addCard({name:e,link:t}){return fetch(this.baseUrl+"/cards",{headers:this.headers,method:"POST",body:JSON.stringify({name:e,link:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}removeCard(e){return fetch(this.baseUrl+"/cards/"+e,{headers:this.headers,method:"DELETE"}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}addLike(e){return fetch(this.baseUrl+"/cards/likes/"+e.getId(),{headers:this.headers,method:"PUT"}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}removeLike(e){return fetch(this.baseUrl+"/cards/likes/"+e.getId(),{headers:this.headers,method:"DELETE"}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateUserInfo({name:e,about:t}){return fetch(this.baseUrl+"/users/me",{headers:this.headers,method:"PATCH",body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setUserAvatar({avatar:e}){return fetch(this.baseUrl+"/users/me/avatar",{headers:this.headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"709a0d9d-db06-4890-a594-b07e7309a353","Content-Type":"application/json"}});class t{constructor({cardData:e,user:t,onCardClick:s,removeHandler:r,likeHandler:i},n){this._name=e.name,this._link=e.link,this._cardId=e._id,this._ownerId=e.owner._id,this._userID=t,this._likes=e.likes,this._cardSelector=n,this._onCardClick=s,this._likeHandler=i,this._removeHandler=r}_getTemplate(){return document.querySelector("#card__template").content.querySelector(".card").cloneNode(!0)}deleteCard(){this._item.remove(),this._item=null}_renderLikes(){this.isLiked()?this._item.querySelector(".card__like-button").classList.add("card__like-button_active"):this._item.querySelector(".card__like-button").classList.remove("card__like-button_active"),this._item.querySelector(".card__like-counter").textContent=this._likes.length}isLiked(){return this._likes.some((e=>e._id===this._userId))}updateLikes(e){this._likes=e,this._renderLikes()}_setEventListeners(){this._item.querySelector(".card__like-button").addEventListener("click",(e=>{this._likeCard(e)})),this._item.querySelector(".card__delete-button").addEventListener("click",(()=>{this._removeHandler(this._cardId)})),this._cardImage.addEventListener("click",(e=>{this._onCardClick(e)}))}generateCard(){return this._item=this._getTemplate(),this._ownerId!==this._userId&&this._element.querySelector(".card__delete-button").classList.add("card__delete-button_hidden"),this._cardImage=this._item.querySelector(".card__image"),this._item.querySelector(".card__title").textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=`Image of  ${this._name} `,this._renderLikes(),this._setEventListeners(),this._item}}class s{constructor(e,t){this._formConfig=e,this._formElement=t}_showInputError=(e,t)=>{const{inputErrorClass:s,errorMessageClass:r}=this._formConfig,i=this._formElement.querySelector(` #${e.id}_error `);i.textContent=t,i.classList.add(r),e.classList.add(s)};_hideInputError=e=>{const{inputErrorClass:t,errorMessageClass:s}=this._formConfig,r=this._formElement.querySelector(` #${e.id}_error `);r.textContent="",r.classList.remove(s),e.classList.remove(t)};resetValidation(){this.inputs.forEach((e=>{this._hideInputError(e)})),this._toggleSubmitButton()}_checkInput=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)};_checkIfFormValid=()=>this.inputs.every((e=>e.validity.valid));_toggleSubmitButton(){const{inactiveButtonClass:e,submitButtonSelector:t}=this._formConfig,s=this._formElement.querySelector(t);this._checkIfFormValid()?(s.disabled=!1,s.classList.remove(e)):(s.disabled=!0,s.classList.add(e))}_setEventListeners=()=>{const{inputSelector:e}=this._formConfig;return this.inputs=Array.from(this._formElement.querySelectorAll(e)),this.inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInput(e),this._toggleSubmitButton()}))})),this._formElement};enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const r=document.querySelector(".profile__edit-button"),i=document.forms.profile,n=(i.elements.name,i.elements.job,document.querySelector(".modal__close-button_type_edit"),document.querySelector(".profile__add-button"),document.querySelector(".modal_type_add-card")),o=(document.querySelector(".modal__input_type_name"),document.querySelector(".modal__input_type_link"),document.querySelector(".modal__close-button_type_add-card"),document.forms.add),a=(o.elements.title,o.elements.link,document.querySelector(".modal__submit-button"),document.querySelector(".cards__grid"),document.querySelector(".modal_type_big-image"),document.querySelector(".modal__big-image"),document.querySelector(".modal__image-caption"),document.querySelector(".modal__close-button_type_big-image"),{formSelector:".modal__container",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_error",errorMessageClass:"modal__error_visible"});class l{constructor(e){this._modalElement=document.querySelector(e)}_checkForEscClose=e=>{"Escape"===e.key&&this.close()};open=()=>{this._modalElement.classList.add("modal_visible"),document.addEventListener("keyup",this._checkForEscClose)};close=()=>{this._modalElement.classList.remove("modal_visible"),document.removeEventListener("keyup",this._checkForEscClose)};setEventListeners(){this._modalElement.querySelector(".modal__close-button").addEventListener("click",(e=>{this.close(e)})),this._modalElement.addEventListener("click",(e=>{e.target.classList.contains("modal_visible")&&this.close(e)}))}}class d extends l{constructor(e,t){super(e),this._handleSubmitBtn=t,this._formElement=this._modalElement.querySelector(".modal__container")}getInputValues(){const e=Array.from(this._formElement.querySelectorAll(".modal__input")),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setInputValues(e){Array.from(this._formElement.querySelectorAll(".modal__input")).forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(()=>{this._handleSubmitBtn(this.getInputValues()),this.close(),this._formElement.reset()}))}close(){super.close(),this._formElement.reset()}}class c extends l{constructor(e,t){super(e),this._form=document.querySelector(this._selector),this._handleSubmit=t,this._handleSubmitHandler=this._handleSubmitHandler.bind(this)}_handleSubmitHandler(e){e.preventDefault(),this._handleSubmit(),super.close()}_setEventListeners(){super._setEventListeners(),this._form.addEventListener("submit",this._handleSubmitHandler)}_removeEventListeners(){super._removeEventListeners(),this._form.removeEventListener("submit",this._handleSubmitHandler)}}const _=new class extends l{openup=e=>{const t=e.target;this._modalElement.querySelector(".modal__big-image").src=t.src,this._modalElement.querySelector(".modal__big-image").alt=t.alt,this._modalElement.querySelector(".modal__image-caption").textContent=t.alt,this.open()}}(".modal_type_big-image");new d(".modal_type_delete-card").setEventListeners();const m=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}addItem(e){this._container.prepend(e)}clear(){this._container.innerHTML=""}renderItems(){this.clear(),this._items.forEach((e=>{this._renderer(e)}))}}((s=>{m.addItem(function(s){const r=new t({data:s,user:f,cardSelector:".cards__grid",handleCardClick:e=>{e.preventDefault();const t=e.target,s=t.src,r=t.alt;_.open(s,r),_.setEventListeners()},handleDeleteCard:t=>{c.open(),c.setAction((()=>e.default.deleteCard(t).then((e=>{r.deleteCard(),c.close()})).catch((e=>console.log(e)))))},handleLikes:t=>{r.isLiked()?e.default.dislike(t).then((e=>{r.updateLikes(e.likes)})).catch((e=>console.log(e))):e.default.addLike(t).then((e=>{r.updateLikes(e.likes)})).catch((e=>console.log(e)))}});return r.generateCard()}(s))}),".cards__grid"),u=new class{constructor({name:e,job:t,avatar:s}){this._name=document.querySelector(`${e}`),this._job=document.querySelector(`${t}`),this._avatar=document.querySelector(`${s}`)}getUserInfo(){return{name:this._name.textContent,job:this._job.textContent,avatar:this._avatar.src}}setUserInfo({name:e,job:t}){this._name.textContent=e,this._job.textContent=t}setUserAvatar({avatar:e}){this._avatar.src=e}}({name:".profile__title",about:".profile__subtitle",avatar:".profile__image"});e.default.getUserInfo().then((e=>{u.setUserInfo(e),f=e._id,u.setAvatar(e.avatar)})).catch((e=>console.log(e))),e.default.getInitialCards().then((e=>{m.renderItems(e)})).catch((e=>console.log(e)));const h=new d(".modal_type_edit",(()=>{u.setUserInfo(h.getInputValues()),h.close()}));h.setEventListeners(),r.addEventListener("click",(()=>{h.setInputValues(u.getUserInfo()),p.resetValidation(),h.open()}));const b=new d(".modal_type_add-card",(()=>{const e=b.getInputValues();m.addItem(generateCard(e)),b.close()}));b.setEventListeners();const p=new s(a,i);let f;p.enableValidation(),new s(a,avatarModal).enableValidation(),new s(a,n).enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFZVyxvQkFJWixNQUFNMEQsRUFBd0IsSUFBSTlHLEVBQWNDLEVBQVlrQyxHQVM1RCxJQUFJd0QsRUFSSm1CLEVBQXNCOUUsbUJBRU8sSUFBSWhDLEVBQWNDLEVBQVkrRyxhQUN0Q2hGLG1CQUVTLElBQUloQyxFQUFjQyxFQUFZcUMsR0FDdENOLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80L3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxEZWxldGVDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9JbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9Nb2RhbFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLmhlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIEdFVCBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzIC0tLSAvL1xyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLmJhc2VVcmwgKyBcIi9jYXJkc1wiLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBHRVQgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi91c2Vycy9tZSAtLS0gLy9cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLmJhc2VVcmwgKyBcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBQT1NUIGh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvY2FyZHMgLS0tIC8vXHJcbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuYmFzZVVybCArIFwiL2NhcmRzXCIsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGxpbmsgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyAtLS0gREVMRVRFIGh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvY2FyZHMvY2FyZElEIC0tLSAvL1xyXG4gIHJlbW92ZUNhcmQoY2FyZElEKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5iYXNlVXJsICsgXCIvY2FyZHMvXCIgKyBjYXJkSUQsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBBZGQvcmVtb3ZlIGxpa2VzIC0tLSAvL1xyXG4gIC8vIC0tLSBQVVQgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cElkL2NhcmRzL2xpa2VzL2NhcmRJZCAtLS0gLy9cclxuICBhZGRMaWtlKGNhcmQpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLmJhc2VVcmwgKyBcIi9jYXJkcy9saWtlcy9cIiArIGNhcmQuZ2V0SWQoKSwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBERUxFVEUgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cElkL2NhcmRzL2xpa2VzL2NhcmRJZCAtLS0gLy9cclxuICByZW1vdmVMaWtlKGNhcmQpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLmJhc2VVcmwgKyBcIi9jYXJkcy9saWtlcy9cIiArIGNhcmQuZ2V0SWQoKSwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBFZGl0aW5nIFByb2ZpbGUgaW5mbyAtLS0gLy9cclxuICAvLyAtLS0gUEFUQ0ggaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cElkL3VzZXJzL21lIC0tLSAvL1xyXG4gIHVwZGF0ZVVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuYmFzZVVybCArIFwiL3VzZXJzL21lXCIsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gUEFUQ0ggaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cElkL3VzZXJzL21lL2F2YXRhclxyXG4gIHNldFVzZXJBdmF0YXIoeyBhdmF0YXIgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuYmFzZVVybCArIFwiL3VzZXJzL21lL2F2YXRhclwiLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiNzA5YTBkOWQtZGIwNi00ODkwLWE1OTQtYjA3ZTczMDlhMzUzXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuIiwiZXhwb3J0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgeyBjYXJkRGF0YSwgdXNlciwgb25DYXJkQ2xpY2ssIHJlbW92ZUhhbmRsZXIsIGxpa2VIYW5kbGVyIH0sXHJcbiAgICBjYXJkU2VsZWN0b3JcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGNhcmREYXRhLmxpbms7XHJcbiAgICB0aGlzLl9jYXJkSWQgPSBjYXJkRGF0YS5faWQ7XHJcbiAgICB0aGlzLl9vd25lcklkID0gY2FyZERhdGEub3duZXIuX2lkO1xyXG4gICAgdGhpcy5fdXNlcklEID0gdXNlcjtcclxuICAgIHRoaXMuX2xpa2VzID0gY2FyZERhdGEubGlrZXM7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcblxyXG4gICAgdGhpcy5fb25DYXJkQ2xpY2sgPSBvbkNhcmRDbGljaztcclxuICAgIHRoaXMuX2xpa2VIYW5kbGVyID0gbGlrZUhhbmRsZXI7XHJcbiAgICB0aGlzLl9yZW1vdmVIYW5kbGVyID0gcmVtb3ZlSGFuZGxlcjtcclxuICB9XHJcbiAgLy8gLS0tIEdldHRpbmcgdGhlIHRlbXBsYXRlIC0tLSAvL1xyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIiNjYXJkX190ZW1wbGF0ZVwiKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHJldHVybiBjYXJkO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIENhcmQgZGVsZXRpbmcgbWV0aG9kIC0tLSAvL1xyXG4gIGRlbGV0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9pdGVtLnJlbW92ZSgpO1xyXG4gICAgdGhpcy5faXRlbSA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBfcmVuZGVyTGlrZXMoKSB7XHJcbiAgICBpZiAodGhpcy5pc0xpa2VkKCkpIHtcclxuICAgICAgdGhpcy5faXRlbVxyXG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgICAgLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9pdGVtXHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgICAgICAuY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuICAgIHRoaXMuX2l0ZW0ucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWNvdW50ZXJcIikudGV4dENvbnRlbnQgPVxyXG4gICAgICB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgfVxyXG5cclxuICAvLyAtLS0gQ2hlY2sgaWYgY2FyZCBsaWtlZCBieSBhbm90aGVyIHVzZXIgLS0tIC8vXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKCh1c2VyKSA9PiB1c2VyLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBUb2dnbGUgbGlrZSBidXR0b24gbWV0aG9kIC0tLSAvL1xyXG4gIHVwZGF0ZUxpa2VzKG5ld0xpa2VzKSB7XHJcbiAgICB0aGlzLl9saWtlcyA9IG5ld0xpa2VzO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBTZXQgZXZlbnRzIGxpc3RlbmVycyBmb3IgdGhlIGNhcmRzIHRoYXQgd2lsbCBiZSBjcmVhdGVkISAtLS0gLy9cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pdGVtXHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgdGhpcy5fbGlrZUNhcmQoZXZlbnQpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9pdGVtXHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fcmVtb3ZlSGFuZGxlcih0aGlzLl9jYXJkSWQpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9vbkNhcmRDbGljayhldmVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBDcmVhdGluZyB0aGUgY2FyZCBhbmQgY2FyZCBlbGVtZW50cyAtLS0gLy9cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9pdGVtID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuXHJcbiAgICBpZiAodGhpcy5fb3duZXJJZCAhPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpXHJcbiAgICAgICAgLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19kZWxldGUtYnV0dG9uX2hpZGRlblwiKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9pdGVtLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9pdGVtLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gXCJJbWFnZSBvZiBcIiArIGAgJHt0aGlzLl9uYW1lfSBgO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9pdGVtO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihmb3JtQ29uZmlnLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fZm9ybUNvbmZpZyA9IGZvcm1Db25maWc7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSA9PiB7XHJcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JNZXNzYWdlQ2xhc3MgfSA9IHRoaXMuX2Zvcm1Db25maWc7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAgIyR7aW5wdXRFbGVtZW50LmlkfV9lcnJvciBgKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGVycm9yTWVzc2FnZUNsYXNzKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuICBcclxuICBfaGlkZUlucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JNZXNzYWdlQ2xhc3MgfSA9IHRoaXMuX2Zvcm1Db25maWc7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAgIyR7aW5wdXRFbGVtZW50LmlkfV9lcnJvciBgKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShlcnJvck1lc3NhZ2VDbGFzcyk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShpbnB1dEVycm9yQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fdG9nZ2xlU3VibWl0QnV0dG9uKCk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dCA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJZkZvcm1WYWxpZCA9ICgpID0+IHRoaXMuaW5wdXRzLmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG5cclxuICBfdG9nZ2xlU3VibWl0QnV0dG9uKCkge1xyXG4gICAgY29uc3QgeyBpbmFjdGl2ZUJ1dHRvbkNsYXNzLCBzdWJtaXRCdXR0b25TZWxlY3RvciB9ID0gdGhpcy5fZm9ybUNvbmZpZztcclxuICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuXHJcbiAgICBpZiAodGhpcy5fY2hlY2tJZkZvcm1WYWxpZCgpKSB7XHJcbiAgICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChpbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcclxuICAgIGNvbnN0IHsgaW5wdXRTZWxlY3RvciB9ID0gdGhpcy5fZm9ybUNvbmZpZztcclxuICAgIHRoaXMuaW5wdXRzID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGlucHV0U2VsZWN0b3IpKTtcclxuXHJcbiAgICB0aGlzLmlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXQoaW5wdXQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZVN1Ym1pdEJ1dHRvbigpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1FbGVtZW50O1xyXG4gIH07XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufSIsIi8vIC0tICdFZGl0IHByb2ZpbGUnIG1vZGFsIGNvbnN0cyAtLSAvL1xyXG5leHBvcnQgY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZU1vZGFsID0gZG9jdW1lbnQuZm9ybXMucHJvZmlsZTtcclxuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IHByb2ZpbGVNb2RhbC5lbGVtZW50cy5uYW1lO1xyXG5leHBvcnQgY29uc3Qgam9iSW5wdXQgPSBwcm9maWxlTW9kYWwuZWxlbWVudHMuam9iO1xyXG5leHBvcnQgY29uc3QgZWRpdENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9lZGl0Jyk7XHJcbi8vIC0tICdBZGQtY2FyZCcgbW9kYWwgY29uc3RzIC0tIC8vXHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2FkZC1jYXJkJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkSW5wdXRUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW5wdXRfdHlwZV9uYW1lJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkSW5wdXRMaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX2xpbmsnKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UtYnV0dG9uX3R5cGVfYWRkLWNhcmQnKTtcclxuLy8gLS0tICdBZGQtQ2FyZCcgZm9ybSBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zLmFkZDtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtVGl0ZWwgPSBhZGRDYXJkRm9ybS5lbGVtZW50cy50aXRsZTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtTGluayA9IGFkZENhcmRGb3JtLmVsZW1lbnRzLmxpbms7XHJcbi8vIC0tLSBHZW5lcmFsIGNvbnN0IC0tLSAvL1xyXG5leHBvcnQgY29uc3Qgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19zdWJtaXQtYnV0dG9uJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkc19fZ3JpZCcpO1xyXG4vLyAtLS0gQmlnIGltYWdlIG1vZGFsIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGNhcmRCaWdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2JpZy1pbWFnZScpO1xyXG5leHBvcnQgY29uc3QgY2FyZEJpZ01vZGFsSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2JpZy1pbWFnZScpO1xyXG5leHBvcnQgY29uc3QgY2FyZEJpZ01vZGFsVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW1hZ2UtY2FwdGlvbicpO1xyXG5leHBvcnQgY29uc3QgY2FyZEJpZ01vZGFsQ2xvc2VJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9iaWctaW1hZ2UnKTtcclxuLy8gLS0tIEZvcm0gY29uZmlnIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGZvcm1Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fY29udGFpbmVyXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfZXJyb3JcIixcclxuICBlcnJvck1lc3NhZ2VDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiXHJcbn07XHJcbi8vIC0tLSBpbml0Q2FyZHMgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgaW5pdENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xha2UtbG91aXNlLmpwZ1wiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIlxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzZS5qcGdcIlxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiXHJcbiAgfVxyXG5dOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG1vZGFsU2VsZWN0b3IpO1xyXG4gIH1cclxuICAvLyAtLS0gQ2xvc2UgbW9kYWwgb24gRVNDIG1ldGhvZCAtLS0gLy9cclxuICBfY2hlY2tGb3JFc2NDbG9zZSA9IChldmVudCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIC0tLSBPcGVuIG1vZGFsIG1ldGhvZCAtLS0gLy8gXHJcbiAgb3BlbiA9ICgpID0+IHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfdmlzaWJsZVwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9jaGVja0ZvckVzY0Nsb3NlKTtcclxuICB9XHJcbiAgLy8gLS0tIENsb3NlIG1vZGFsIG1ldGhvZCAtLS0gLy9cclxuICBjbG9zZSA9ICgpID0+IHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfdmlzaWJsZVwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9jaGVja0ZvckVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gLS0tIENsb3NlIG1vZGFsIG9uIGNsb3NlKCdYJykgYnV0dG9uIC0tLSAvL1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpXHJcbiAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICB0aGlzLmNsb3NlKGV2ZW50KTtcclxuICAgIH0pO1xyXG4gICAgLy8gQ2xvc2UgbW9kYWwgb24gb3ZlcmxheShvdXQgb2YgdGhlIG1vZGFsKSBjbGljayAtLS0gLy8vXHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX3Zpc2libGVcIikpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKGV2ZW50KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59IiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhGb3JtIGV4dGVuZHMgTW9kYWwge1xyXG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdCkge1xyXG4gICAgc3VwZXIobW9kYWxTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXRCdG4gPSBoYW5kbGVTdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jb250YWluZXJcIik7XHJcbiAgfVxyXG5cclxuICBnZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXHJcbiAgICApO1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge2lucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7fSk7XHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRJbnB1dFZhbHVlcyh2YWx1ZXMpIHtcclxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXHJcbiAgICApO1xyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7aW5wdXQudmFsdWUgPSB2YWx1ZXNbaW5wdXQubmFtZV07fSlcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXRCdG4odGhpcy5nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gIH1cclxufSIsImltcG9ydCBNb2RhbCBmcm9tICcuL01vZGFsLmpzJztcclxuICBcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxEZWxldGVDb25maXJtYXRpb24gZXh0ZW5kcyBNb2RhbCB7XHJcbiAgY29uc3RydWN0b3IgKHNlbGVjdG9yLCBoYW5kbGVTdWJtaXQpIHtcclxuICAgIHN1cGVyKHNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Zvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3NlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEhhbmRsZXIgPSB0aGlzLl9oYW5kbGVTdWJtaXRIYW5kbGVyLmJpbmQodGhpcyk7XHJcbiAgfVxyXG4gIFxyXG4gIF9oYW5kbGVTdWJtaXRIYW5kbGVyIChldmVudCkge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcbiAgXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzICgpIHtcclxuICAgIHN1cGVyLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9oYW5kbGVTdWJtaXRIYW5kbGVyKTtcclxuICB9XHJcbiAgXHJcbiAgX3JlbW92ZUV2ZW50TGlzdGVuZXJzICgpIHtcclxuICAgIHN1cGVyLl9yZW1vdmVFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9oYW5kbGVTdWJtaXRIYW5kbGVyKTtcclxuICB9XHJcbn0iLCJpbXBvcnQgYXBpIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvQXBpLmpzXCI7XHJcbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGVkaXRCdXR0b24sXHJcbiAgcHJvZmlsZU1vZGFsLFxyXG4gIGFkZENhcmRCdXR0b24sXHJcbiAgYWRkQ2FyZE1vZGFsLFxyXG4gIGZvcm1Db25maWdcclxufSBmcm9tIFwiLi4vY29tcG9uZW50cy91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IE1vZGFsV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IE1vZGFsV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9Nb2RhbFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBNb2RhbERlbGV0ZUNvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL01vZGFsRGVsZXRlQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcblxyXG4vLyAtLS0gQmlnIGltYWdlIG1vZGFsIGluc3RhbmNlIC0tLSAvL1xyXG5jb25zdCBiaWdJbWFnZU1vZGFsID0gbmV3IE1vZGFsV2l0aEltYWdlKFwiLm1vZGFsX3R5cGVfYmlnLWltYWdlXCIpO1xyXG5cclxuLy8gLS0tIERlbGV0ZSBjYXJkIG1vZGFsIGluc3RhbmNlIGFuZCBldmVudHMgLS0tIC8vXHJcbmNvbnN0IGRlbGV0ZUNhcmRNb2RhbCA9IG5ldyBNb2RhbFdpdGhGb3JtKFwiLm1vZGFsX3R5cGVfZGVsZXRlLWNhcmRcIik7XHJcbmRlbGV0ZUNhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gKysrKysgQ2FyZCBTZWN0aW9uICsrKysrIC8vXHJcbi8vIC0tLSBDYXJkIHJlbmRlciBmdW5jdGlvbiAtLS0gLy9cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcclxuICAgIGRhdGE6IGRhdGEsXHJcbiAgICB1c2VyOiB1c2VySWQsXHJcbiAgICBjYXJkU2VsZWN0b3I6IFwiLmNhcmRzX19ncmlkXCIsXHJcbiAgICBoYW5kbGVDYXJkQ2xpY2s6IChldnQpID0+IHtcclxuICAgICAgLy8gLS0tIE9wZW4gYmlnIGltYWdlIG1vZGFsIC0tLSAvL1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgdGFyZ2V0ID0gZXZ0LnRhcmdldDtcclxuICAgICAgY29uc3QgbGluayA9IHRhcmdldC5zcmM7XHJcbiAgICAgIGNvbnN0IG5hbWUgPSB0YXJnZXQuYWx0O1xyXG4gICAgICBiaWdJbWFnZU1vZGFsLm9wZW4obGluaywgbmFtZSk7XHJcbiAgICAgIGJpZ0ltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH0sXHJcbiAgICBoYW5kbGVEZWxldGVDYXJkOiAoY2FyZElkKSA9PiB7XHJcbiAgICAgIE1vZGFsRGVsZXRlQ29uZmlybWF0aW9uLm9wZW4oKTtcclxuICAgICAgTW9kYWxEZWxldGVDb25maXJtYXRpb24uc2V0QWN0aW9uKCgpID0+XHJcbiAgICAgICAgYXBpLmRlbGV0ZUNhcmQoY2FyZElkKS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIGNhcmQuZGVsZXRlQ2FyZCgpO1xyXG4gICAgICAgICAgTW9kYWxEZWxldGVDb25maXJtYXRpb24uY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgICApO1xyXG4gICAgfSxcclxuICAgIGhhbmRsZUxpa2VzOiAoY2FyZElkKSA9PiB7XHJcbiAgICAgIGNvbnN0IGlzTGlrZWQgPSBjYXJkLmlzTGlrZWQoKTtcclxuICAgICAgaWYgKGlzTGlrZWQpIHtcclxuICAgICAgICBhcGkuZGlzbGlrZShjYXJkSWQpLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgY2FyZC51cGRhdGVMaWtlcyhyZXMubGlrZXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXHJcbiAgICAgIH0gXHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIGFwaS5hZGRMaWtlKGNhcmRJZCkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgICAgfVxyXG4gICAgfSxcclxuICB9KTtcclxuICAvLyAtLS0gQ2xvbmUgZnJvbSB0ZW1wbGF0ZSAtLS0gLy9cclxuICBjb25zdCBjYXJkc0l0ZW0gPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG4gIHJldHVybiBjYXJkc0l0ZW07XHJcbn1cclxuXHJcbmNvbnN0IGNhcmRzU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIChpdGVtKSA9PiB7XHJcbiAgICBjYXJkc1NlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGl0ZW0pKTtcclxuICB9LFxyXG4gIFwiLmNhcmRzX19ncmlkXCJcclxuKTtcclxuXHJcbi8vICsrKysrICdVc2VyIEluZm8nICsrKysrIC8vXHJcbi8vIC0tLSBVc2VySW5mbyBpbnN0YW5jZSAtLS0gLy9cclxuY29uc3QgdXNlckluZm9WYWx1ZXMgPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWU6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXHJcbiAgYWJvdXQ6IFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIsXHJcbiAgYXZhdGFyOiBcIi5wcm9maWxlX19pbWFnZVwiLFxyXG59KTtcclxuLy8gLS0tIFVzZXJJbmZvIGluaXQgLS0tIC8vXHJcbmFwaS5nZXRVc2VySW5mbygpLnRoZW4oKHJlcykgPT4ge1xyXG4gIHVzZXJJbmZvVmFsdWVzLnNldFVzZXJJbmZvKHJlcyk7XHJcbiAgdXNlcklkID0gcmVzLl9pZDtcclxuICB1c2VySW5mb1ZhbHVlcy5zZXRBdmF0YXIocmVzLmF2YXRhcik7XHJcbn0pXHJcbi5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuXHJcbi8vICsrKysrIENhcmQgbGlzdCArKysrKyAvL1xyXG4vLyAtLS0gQ2FyZHMgaW5pdCAtLS0gLy9cclxuYXBpLmdldEluaXRpYWxDYXJkcygpLnRoZW4oKHJlcykgPT4ge1xyXG4gIGNhcmRzU2VjdGlvbi5yZW5kZXJJdGVtcyhyZXMpO1xyXG59KVxyXG4uY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcblxyXG4vLyArKysrKyBGb3JtcyArKysrKyAvL1xyXG4vLyA9PT0gJ0VkaXQgcHJvZmlsZScgZm9ybSA9PT0gLy9cclxuLy8gLS0tIEZvcm0gY3JlYXRpb24gbWV0aG9kIC0tLSAvL1xyXG5jb25zdCBlZGl0UHJvZmlsZUZvcm0gPSBuZXcgTW9kYWxXaXRoRm9ybShcIi5tb2RhbF90eXBlX2VkaXRcIiwgKCkgPT4ge1xyXG4gIHVzZXJJbmZvVmFsdWVzLnNldFVzZXJJbmZvKGVkaXRQcm9maWxlRm9ybS5nZXRJbnB1dFZhbHVlcygpKTtcclxuICBlZGl0UHJvZmlsZUZvcm0uY2xvc2UoKTtcclxufSk7XHJcbi8vIC0tLSBTZXQgZXZlbnQgbGlzdGVuZXJzIGZvciB0aGUgZm9ybSAtLS0gLy9cclxuZWRpdFByb2ZpbGVGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbi8vIC0tLSBTZXQgdmFsdWVzIGFuZCBvcGVuIHRoZSBmb3JtIC0tLSAvL1xyXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZWRpdFByb2ZpbGVGb3JtLnNldElucHV0VmFsdWVzKHVzZXJJbmZvVmFsdWVzLmdldFVzZXJJbmZvKCkpXHJcbiAgcHJvZmlsZUZvcm1WYWxpZGF0aW9uLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGVkaXRQcm9maWxlRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG4vLyA9PT0gJ0FkZCBjYXJkJyBmb3JtID09PSAvL1xyXG4vLyAtLS0gRm9ybSBjcmVhdGlvbiBtZXRob2QgLS0tIC8vXHJcbmNvbnN0IGFkZENhcmRGb3JtID0gbmV3IE1vZGFsV2l0aEZvcm0oXCIubW9kYWxfdHlwZV9hZGQtY2FyZFwiLCAoKSA9PiB7XHJcbiAgY29uc3QgbmV3Q2FyZCA9IGFkZENhcmRGb3JtLmdldElucHV0VmFsdWVzKCk7XHJcbiAgY2FyZHNTZWN0aW9uLmFkZEl0ZW0oZ2VuZXJhdGVDYXJkKG5ld0NhcmQpKTtcclxuICBhZGRDYXJkRm9ybS5jbG9zZSgpO1xyXG59KTtcclxuLy8gLS0tIFNldCBldmVudCBsaXN0ZW5lcnMgZm9yICdhZGQgY2FyZCcgbW9kYWwgLS0tIC8vXHJcbmFkZENhcmRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLyArKysrKyBWYWxpZGF0aW9uICsrKysrIC8vXHJcbi8vIC0tLSAnRWRpdCBwcm9maWxlJyBmb3JtIHZhbGlkYXRpb24gYWRkaW5nIC0tLSAvL1xyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBwcm9maWxlTW9kYWwpO1xyXG5wcm9maWxlRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4vLyAtLS0gIC0tLSAvL1xyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGF2YXRhck1vZGFsKTtcclxuYXZhdGFyRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4vLyAtLS0gJ0FkZCBjYXJkJyBmb3JtIHZhbGlkYXRpb24gYWRkaW5nIC0tLSAvL1xyXG5jb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBhZGRDYXJkTW9kYWwpO1xyXG5hZGRDYXJkRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxubGV0IHVzZXJJZDsiLCJpbXBvcnQgTW9kYWwgZnJvbSBcIi4vTW9kYWwuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsV2l0aEltYWdlIGV4dGVuZHMgTW9kYWwge1xyXG4gIC8vIC0tLSBPcGVuIGJpZyBpbWFnZSBtb2RhbCBtZXRob2QgLS0tIC8vXHJcbiAgb3BlbnVwID0gKGV2ZW50KSA9PiB7XHJcbiAgICBjb25zdCBiaWdJbWFnZSA9IGV2ZW50LnRhcmdldDtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19iaWctaW1hZ2VcIikuc3JjID0gYmlnSW1hZ2Uuc3JjO1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2JpZy1pbWFnZVwiKS5hbHQgPSBiaWdJbWFnZS5hbHQ7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtY2FwdGlvblwiKS50ZXh0Q29udGVudCA9IGJpZ0ltYWdlLmFsdDtcclxuXHJcbiAgICB0aGlzLm9wZW4oKTtcclxuICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICBjbGVhciAoKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIuaW5uZXJIVE1MID0gJyc7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuY2xlYXIoKTtcclxuICAgIFxyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoY2FyZCkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihjYXJkKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoIHtuYW1lLCBqb2IsIGF2YXRhcn0gKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgJHtuYW1lfWApO1xyXG4gICAgdGhpcy5fam9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgJHtqb2J9YCk7XHJcbiAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAke2F2YXRhcn1gKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgIG5hbWUgOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxyXG4gICAgam9iIDogdGhpcy5fam9iLnRleHRDb250ZW50LFxyXG4gICAgYXZhdGFyOiB0aGlzLl9hdmF0YXIuc3JjXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oIHtuYW1lLCBqb2J9ICkge1xyXG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2IudGV4dENvbnRlbnQgPSBqb2I7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VyQXZhdGFyKCB7YXZhdGFyfSApIHtcclxuICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJleHBvcnRzIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiY29uc3RydWN0b3IiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm8iLCJhZGRDYXJkIiwibmFtZSIsImxpbmsiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInJlbW92ZUNhcmQiLCJjYXJkSUQiLCJnZXRBcHBJbmZvIiwiYWxsIiwiYWRkTGlrZSIsImNhcmQiLCJnZXRJZCIsInJlbW92ZUxpa2UiLCJ1cGRhdGVVc2VySW5mbyIsImFib3V0Iiwic2V0VXNlckF2YXRhciIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJDYXJkIiwiY2FyZERhdGEiLCJ1c2VyIiwib25DYXJkQ2xpY2siLCJyZW1vdmVIYW5kbGVyIiwibGlrZUhhbmRsZXIiLCJjYXJkU2VsZWN0b3IiLCJfbmFtZSIsIl9saW5rIiwiX2NhcmRJZCIsIl9pZCIsIl9vd25lcklkIiwib3duZXIiLCJfdXNlcklEIiwiX2xpa2VzIiwibGlrZXMiLCJfY2FyZFNlbGVjdG9yIiwiX29uQ2FyZENsaWNrIiwiX2xpa2VIYW5kbGVyIiwiX3JlbW92ZUhhbmRsZXIiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZGVsZXRlQ2FyZCIsIl9pdGVtIiwicmVtb3ZlIiwiX3JlbmRlckxpa2VzIiwiaXNMaWtlZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwibGVuZ3RoIiwic29tZSIsIl91c2VySWQiLCJ1cGRhdGVMaWtlcyIsIm5ld0xpa2VzIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiX2xpa2VDYXJkIiwiX2NhcmRJbWFnZSIsImdlbmVyYXRlQ2FyZCIsIl9lbGVtZW50Iiwic3JjIiwiYWx0IiwiRm9ybVZhbGlkYXRvciIsImZvcm1Db25maWciLCJmb3JtRWxlbWVudCIsIl9mb3JtQ29uZmlnIiwiX2Zvcm1FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JNZXNzYWdlQ2xhc3MiLCJlcnJvckVsZW1lbnQiLCJpZCIsIl9oaWRlSW5wdXRFcnJvciIsInJlc2V0VmFsaWRhdGlvbiIsImlucHV0cyIsImZvckVhY2giLCJpbnB1dCIsIl90b2dnbGVTdWJtaXRCdXR0b24iLCJfY2hlY2tJbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9jaGVja0lmRm9ybVZhbGlkIiwiZXZlcnkiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJidXR0b25FbGVtZW50IiwiZGlzYWJsZWQiLCJpbnB1dFNlbGVjdG9yIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsImVkaXRCdXR0b24iLCJwcm9maWxlTW9kYWwiLCJmb3JtcyIsInByb2ZpbGUiLCJhZGRDYXJkTW9kYWwiLCJlbGVtZW50cyIsImpvYiIsImFkZENhcmRGb3JtIiwidGl0bGUiLCJmb3JtU2VsZWN0b3IiLCJNb2RhbCIsIm1vZGFsU2VsZWN0b3IiLCJfbW9kYWxFbGVtZW50IiwiX2NoZWNrRm9yRXNjQ2xvc2UiLCJrZXkiLCJjbG9zZSIsIm9wZW4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIk1vZGFsV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVTdWJtaXRCdG4iLCJnZXRJbnB1dFZhbHVlcyIsImlucHV0TGlzdCIsImlucHV0VmFsdWVzIiwic2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXMiLCJyZXNldCIsIk1vZGFsRGVsZXRlQ29uZmlybWF0aW9uIiwic2VsZWN0b3IiLCJfZm9ybSIsIl9zZWxlY3RvciIsIl9oYW5kbGVTdWJtaXQiLCJfaGFuZGxlU3VibWl0SGFuZGxlciIsImJpbmQiLCJfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMiLCJiaWdJbWFnZU1vZGFsIiwib3BlbnVwIiwiYmlnSW1hZ2UiLCJjYXJkc1NlY3Rpb24iLCJpdGVtcyIsInJlbmRlcmVyIiwiY29udGFpbmVyU2VsZWN0b3IiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiY2xlYXIiLCJpbm5lckhUTUwiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJkYXRhIiwidXNlcklkIiwiaGFuZGxlQ2FyZENsaWNrIiwiZXZ0IiwiaGFuZGxlRGVsZXRlQ2FyZCIsImNhcmRJZCIsInNldEFjdGlvbiIsImFwaSIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImhhbmRsZUxpa2VzIiwiY3JlYXRlQ2FyZCIsInVzZXJJbmZvVmFsdWVzIiwiX2pvYiIsIl9hdmF0YXIiLCJzZXRVc2VySW5mbyIsInNldEF2YXRhciIsImVkaXRQcm9maWxlRm9ybSIsInByb2ZpbGVGb3JtVmFsaWRhdGlvbiIsIm5ld0NhcmQiLCJhdmF0YXJNb2RhbCJdLCJzb3VyY2VSb290IjoiIn0=