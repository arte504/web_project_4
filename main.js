!function(){"use strict";class e{constructor(e,t){this._formConfig=e,this._formElement=t,this.inputs=Array.from(this._formElement.querySelectorAll(this._formConfig.inputSelector)),this._buttonElement=this._formElement.querySelector(this._formConfig.submitButtonSelector)}_showInputError=(e,t)=>{const{inputErrorClass:s,errorMessageClass:r}=this._formConfig,n=this._formElement.querySelector(` #${e.id}_error `);n.textContent=t,n.classList.add(r),e.classList.add(s)};_hideInputError=e=>{const{inputErrorClass:t,errorMessageClass:s}=this._formConfig,r=this._formElement.querySelector(` #${e.id}_error `);r.textContent="",r.classList.remove(s),e.classList.remove(t)};_checkInput=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)};_checkIValid=()=>this.inputs.every((e=>e.validity.valid));_toggleSubmitButton(){this._checkIValid()?(this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._formConfig.inactiveButtonClass)):(this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._formConfig.inactiveButtonClass))}_setEventListeners=()=>(this.inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInput(e),this._toggleSubmitButton()}))})),this._formElement);enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class t{constructor(e,t,s,r,n,i){this._name=e.name,this._link=e.link,this._likes=e.likes,this._ownerId=e.owner._id,this._id=e._id,this._template=n,this._userId=i,this._onCardClick=t,this._likeHandler=r,this._removeHandler=s}_getTemplate(){return this._template.content.querySelector(".card").cloneNode(!0)}_setAttributes(e,t){for(const s in t)e.setAttribute(s,t[s])}deleteCard(){const e=document.getElementById(id);e&&e.parentNode.removeChild(e),this._cardElement=null}_renderLikes(){this._likes.forEach((e=>e._id===this._userId?this._likeCard():this._unlikeCard()))}showLikes(e){this._cardElement.querySelector(".card__like-count").textContent=e}isLiked(){return this._liked}_checkForLike(e){return this._likes.find((t=>t._id===e))?this._liked=!0:this._liked=!1,this._liked}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(e=>{this._likeCard(e)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._removeHandler(this._id)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._onCardClick(this._name,this._link)}))}_showDeleteIcon(){this._userId!=this._ownerId&&this._cardElement.querySelector(".card__delete-button").classList.add("card__delete-button_hidden")}getCardId(){return this._id}generateCard(){return this._cardElement=this._getTemplate(),this.likeIcon=this._cardElement.querySelector(".card__like-button"),this._setAttributes(this._cardElement.querySelector(".card__image"),{src:this._link,alt:this._name}),this._cardElement.querySelector(".card__title").textContent=this._name,this._showDeleteIcon(),this.showLikes(this._likes.length),this._setEventListeners(),this._renderLikes(),this._cardElement}_likeCard(){this.likeIcon.classList.add("card__like-button_active")}_unlikeCard(){this.likeIcon.classList.remove("card__like-button_active")}updateCard(){this._likes=data.likes,this._checkForLike(user.id)?this._likeCard:this._unlikeCard,this._cardElement.querySelector(".card__like-count").textContent=this._likes.length}}class s{constructor(e,t){this._modalElement=document.querySelector(e),this._escapeKeyHandler=this._escapeKeyHandler.bind(this),this._checkKeyPress=t}open(){this._modalElement.classList.add("modal_visible"),document.addEventListener("keyup",this._escapeKeyHandler)}close(){this._modalElement.classList.remove("modal_visible"),document.removeEventListener("keyup",this._escapeKeyHandler)}_escapeKeyHandler(e){this._checkKeyPress(e.key)&&this.close()}setEventListeners(){this._modalElement.addEventListener("click",(e=>{e.target.classList.contains("modal__close-button")&&this.close(),e.target.classList.contains("modal_visible")&&this.close()}))}}class r extends s{constructor(e,t,s){super(e,t),this._handleSubmit=s,this._submitButton=this._modalElement.querySelector(".modal__submit-button"),this._form=document.querySelector(".modal__container"),this._textInButton=this._submitButton.textContent}getInputValues(){this._inputList=this._modalElement.querySelectorAll(".modal__input");const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e||this._entredValue}setInputValues(e){this._entredValue=e}setEventListeners(){super.setEventListeners(),this._modalElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitButton.textContent="Saving...",this._handleSubmit(this.getInputValues())}))}close(){this._submitButton.textContent=this._textInButton,this._form.reset(),super.close()}}class n{constructor({items:e,renderer:t},s){this._renderedElements=e,this._renderer=t,this._container=document.querySelector(s)}renderItems(){this._renderedElements.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const i=document.querySelector(".profile__edit-button"),o=document.querySelector(".modal_type_edit"),a=document.querySelector(".profile__title"),l=document.querySelector(".modal__input_type_title"),d=document.querySelector(".profile__subtitle"),_=document.querySelector(".modal__input_type_subtitle"),c=(document.querySelector(".modal__close-button_type_edit"),document.querySelector(".profile__image")),h=document.querySelector(".profile__image_overlay"),u=document.querySelector(".modal_type_avatar"),m=u.querySelector(".modal__input_type_avatar"),p=(document.querySelector(".modal__close-button_type_avatar"),document.querySelector(".profile__add-button")),y=document.querySelector(".modal_type_add-card"),b=document.querySelector(".modal__input_type_name"),E=document.querySelector(".modal__input_type_link"),v=(document.querySelector(".modal__close-button_type_add-card"),document.forms.add),k=(v.elements.title,v.elements.link,document.querySelector(".modal__submit-button"),document.querySelector(".cards__grid"),document.querySelector("#card__template")),C=document.querySelector(".modal_type_big-image"),g=C.querySelector(".modal__big-image"),f=C.querySelector(".modal__image-caption"),S=(document.querySelector(".modal__close-button_type_big-image"),document.querySelector(".modal_type_delete-card"),{formSelector:".modal__container",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_error",errorMessageClass:"modal__error_visible"}),L=e=>"Escape"===e,I=()=>{b.value="",E.value=""};new e(S,o).enableValidation(),new e(S,u).enableValidation(),new e(S,y).enableValidation();const q=e=>console.log(e),U=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_response(e){return e.ok?e.json():Promise.reject(`Error: ${e.status} - ${e.statusText}`)}getCardList(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._response)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._response)}setUserInfo(e,t){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers,method:"PATCH",body:JSON.stringify({name:e,about:t})}).then(this._response)}addCard(e){return fetch(`${this._baseUrl}/cards`,{headers:this._headers,method:"POST",body:JSON.stringify(e)}).then(this._response)}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{headers:this._headers,method:"DELETE"}).then(this._response)}likeCard(e,t){return fetch(`${this._baseUrl}/cards/likes/${e}`,{headers:this._headers,method:"PUT",body:JSON.stringify(t)}).then(this._response)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{headers:this._headers,method:"DELETE"}).then(this._response)}setUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then(this._response)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"709a0d9d-db06-4890-a594-b07e7309a353","Content-Type":"application/json"}}),w=new class{constructor(e,t,s){this._nameElement=e,this._titleElement=t,this._pictureElement=s}getUserInfo(){return{name:this._name.textContent,job:this._job.textContent}}getUserData(){return this._data}setUserInfo(e,t){this._name=e,this._job=t,this._nameElement.textContent=this._name,this._titleElement.textContent=this._job}}(a,d);U.getUserInfo().then((e=>(w.setUserInfo(e.name,e.about),c.src=e.avatar,w))).then((e=>{U.getCardList().then((s=>{const i=(e,t)=>{T.open(e,t)},o=e.getUserInfo(),a=e=>{B.setInputValues(e),B.open()},l=t=>{t.isLiked()?U.unlikeCard(t.getCardId()).then((e=>{t.updateCard(e,o)})).catch(q):U.likeCard(t.getCardId(),e.getUserInfo()).then((e=>{t.updateCard(e,o)})).catch(q)},d=e=>new t(e,i,a,l,k),_=new n({items:s,renderer:t=>{const s=d(t);_.addItem(s.generateCard(e.id))}},".cards__grid");_.renderItems();const c=new r(".modal_type_add-card",L,(e=>{U.addCard(e).then((e=>{const t=d(e);_.addItem(t.generateCard(user.id)),I(),c.close(I)})).catch(q)}));c.setEventListeners(),p.addEventListener("click",(()=>{c.open()}))})).catch(q)})).catch(q);const x=new r(".modal_type_edit",L,(({name:e,job:t})=>{U.setUserInfo({name:e,job:t}).then((e=>{w.setUserInfo(e.avatar),x.close()})).catch(q)}));x.setEventListeners(),i.addEventListener("click",(()=>{l.value=a.textContent,_.value=d.textContent,x.open()}));const $=new r(".modal_type_avatar",L,(({avatarLink:e})=>{U.setUserAvatar({avatar:e}).then((e=>{w.setUserInfo(e),$.close()})).catch(q)}));$.setEventListeners(),h.addEventListener("click",(()=>{m.value="",$.open()}));const B=new r(".modal_type_delete-card",L,(e=>{U.deleteCard(e.getCardId()).then((()=>{e.deleteCard(),B.close()})).catch(q)}));B.setEventListeners();const T=new class extends s{constructor(e,t){super(e,t),this._modalImage=document.querySelector(".modal__big-image"),this._modalTitle=document.querySelector(".modal__image-caption")}open(e,t){this._modalTitle.textContent=e,this._modalImage.setAttribute("src",t),super.open()}}(".modal_type_big-image",L,g,f);T.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Z0JySCxXQUVqQitHLE1BQU10RCxNQUdiNEQsRUFBZ0JuSCxvQkFFaEJxQyxFQUFpQnpHLGlCQUFpQixTQUFTLEtBQ3pDMkcsRUFBaUJ6QixNQUFRLEdBQ3pCcUcsRUFBZ0J0SCxVQUlsQixNQUFNOEcsRUFBa0IsSUFBSXhHLEVEdEtNLDBCQ3dLaENrRCxHQUNDcUQsSUFDQy9DLEVBQ0c5RixXQUFXNkksRUFBSzNILGFBQ2hCNEYsTUFBSyxLQUNKK0IsRUFBSzdJLGFBQ0w4SSxFQUFnQjdHLFdBRWpCK0csTUFBTXRELE1BR2JvRCxFQUFnQjNHLG9CQUVoQixNQUFNaUQsRUFBZ0IsSUcxTlAsY0FBNkIzRCxFQUMxQ2hHLFlBQWE4TixFQUFPNUgsR0FDbEJjLE1BQU84RyxFQUFPNUgsR0FDZC9GLEtBQUs0TixZQUFjdkosU0FBUzVELGNBQWMscUJBQzFDVCxLQUFLNk4sWUFBY3hKLFNBQVM1RCxjQUFjLHlCQUc1QzJGLEtBQUtyRCxFQUFNRSxHQUNUakQsS0FBSzZOLFlBQVkzTSxZQUFjNkIsRUFDL0IvQyxLQUFLNE4sWUFBWXpKLGFBQWEsTUFBT2xCLEdBRXJDNEQsTUFBTVQsU0oyQnNCLHdCQ3NMOUJ3RCxFQUNBSCxFQUNBQyxHQUVGRixFQUFjakQsb0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWwuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9JbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoSW1hZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoZm9ybUNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Zvcm1Db25maWcgPSBmb3JtQ29uZmlnO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuaW5wdXRzID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2Zvcm1Db25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fZm9ybUNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpID0+IHtcclxuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvck1lc3NhZ2VDbGFzcyB9ID0gdGhpcy5fZm9ybUNvbmZpZztcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCAjJHtpbnB1dEVsZW1lbnQuaWR9X2Vycm9yIGApO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoZXJyb3JNZXNzYWdlQ2xhc3MpO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5wdXRFcnJvckNsYXNzKTtcclxuICB9O1xyXG4gIFxyXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvck1lc3NhZ2VDbGFzcyB9ID0gdGhpcy5fZm9ybUNvbmZpZztcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCAjJHtpbnB1dEVsZW1lbnQuaWR9X2Vycm9yIGApO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGVycm9yTWVzc2FnZUNsYXNzKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuXHJcbiAgX2NoZWNrSW5wdXQgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2NoZWNrSVZhbGlkID0gKCkgPT4gdGhpcy5pbnB1dHMuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcblxyXG4gIF90b2dnbGVTdWJtaXRCdXR0b24oKSB7XHJcbiAgICBpZiAodGhpcy5fY2hlY2tJVmFsaWQoKSkge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9mb3JtQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfSBcclxuICAgIGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Zvcm1Db25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICB0aGlzLmlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXQoaW5wdXQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZVN1Ym1pdEJ1dHRvbigpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1FbGVtZW50O1xyXG4gIH07XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKCBkYXRhLCBvbkNhcmRDbGljaywgcmVtb3ZlSGFuZGxlciwgbGlrZUhhbmRsZXIsIHRlbXBsYXRlLCB1c2VySWQgKSBcclxuICB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl90ZW1wbGF0ZSA9IHRlbXBsYXRlO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG5cclxuICAgIHRoaXMuX29uQ2FyZENsaWNrID0gb25DYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9saWtlSGFuZGxlciA9IGxpa2VIYW5kbGVyO1xyXG4gICAgdGhpcy5fcmVtb3ZlSGFuZGxlciA9IHJlbW92ZUhhbmRsZXI7XHJcbiAgfVxyXG4gIC8vIC0tLSBHZXQgY2FyZCB0ZW1wbGF0ZSAtLS0gLy9cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IHRoaXMuX3RlbXBsYXRlXHJcbiAgICAuY29udGVudFxyXG4gICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJylcclxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3NldEF0dHJpYnV0ZXMoY2FyZEVsZW1lbnQsIGF0dHJpYnMpIHtcclxuICAgIGZvciAoY29uc3Qga2V5IGluIGF0dHJpYnMpIHtcclxuICAgICAgY2FyZEVsZW1lbnQuc2V0QXR0cmlidXRlKGtleSwgYXR0cmlic1trZXldKTtcclxuICAgIH1cclxuICB9XHJcbiAgLy8gLS0tIENhcmQgZGVsZXRpbmcgbWV0aG9kIC0tLSAvL1xyXG4gIGRlbGV0ZUNhcmQoKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcclxuICAgIGlmKGNhcmRFbGVtZW50KXtcclxuICAgICAgY2FyZEVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChjYXJkRWxlbWVudCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG4gIC8vIC0tLSAgLS0tIC8vXHJcbiAgX3JlbmRlckxpa2VzICgpIHtcclxuICAgIHRoaXMuX2xpa2VzLmZvckVhY2goKGxpa2UpID0+IFxyXG4gICAgICBsaWtlLl9pZCA9PT0gdGhpcy5fdXNlcklkID8gdGhpcy5fbGlrZUNhcmQoKSA6IHRoaXMuX3VubGlrZUNhcmQoKVxyXG4gICAgKTtcclxuICB9XHJcbiAgLy8gLS0tIFNob3cgdGhlIGxpa2UgYW1vdW50IC0tLSAvL1xyXG4gIHNob3dMaWtlcyhjb3VudCl7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudCcpLnRleHRDb250ZW50ID0gY291bnQ7XHJcbiAgfVxyXG5cclxuICBpc0xpa2VkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VkO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrRm9yTGlrZSh1c2VyKSB7XHJcbiAgICBpZiAodGhpcy5fbGlrZXMuZmluZCgobGlrZSkgPT4gbGlrZS5faWQgPT09IHVzZXIpKSB7XHJcbiAgICAgIHRoaXMuX2xpa2VkID0gdHJ1ZTtcclxuICAgIH0gXHJcbiAgICBlbHNlIHtcclxuICAgICAgdGhpcy5fbGlrZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLl9saWtlZDtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBTZXQgZXZlbnRzIGxpc3RlbmVycyBmb3IgdGhlIGNhcmRzIHRoYXQgd2lsbCBiZSBjcmVhdGVkISAtLS0gLy9cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJylcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgICB0aGlzLl9saWtlQ2FyZChldmVudCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ1dHRvbicpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3JlbW92ZUhhbmRsZXIodGhpcy5faWQpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJylcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fb25DYXJkQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dEZWxldGVJY29uKCkge1xyXG4gICAgaWYodGhpcy5fdXNlcklkICE9IHRoaXMuX293bmVySWQpIHtcclxuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKS5jbGFzc0xpc3QuYWRkKCdjYXJkX19kZWxldGUtYnV0dG9uX2hpZGRlbicpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0Q2FyZElkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lkO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIENyZWF0aW5nIHRoZSBjYXJkIGFuZCBjYXJkIGVsZW1lbnRzIC0tLSAvL1xyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMubGlrZUljb24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKTtcclxuICAgIHRoaXMuX3NldEF0dHJpYnV0ZXModGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJyksIHtcclxuICAgICAgc3JjOiB0aGlzLl9saW5rLFxyXG4gICAgICBhbHQ6IHRoaXMuX25hbWVcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJykudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuX3Nob3dEZWxldGVJY29uKCk7XHJcbiAgICB0aGlzLnNob3dMaWtlcyh0aGlzLl9saWtlcy5sZW5ndGgpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX2xpa2VDYXJkKCkge1xyXG4gICAgdGhpcy5saWtlSWNvbi5jbGFzc0xpc3QuYWRkKCdjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmUnKTtcclxuICB9XHJcblxyXG4gIF91bmxpa2VDYXJkKCkge1xyXG4gICAgdGhpcy5saWtlSWNvbi5jbGFzc0xpc3QucmVtb3ZlKCdjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmUnKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcblxyXG4gICAgaWYgKHRoaXMuX2NoZWNrRm9yTGlrZSh1c2VyLmlkKSkge1xyXG4gICAgICB0aGlzLl9saWtlQ2FyZDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICB0aGlzLl91bmxpa2VDYXJkO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtY291bnQnKVxyXG4gICAgICAudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3RvciggbW9kYWxTZWxlY3RvciwgY2hlY2tLZXlQcmVzcyApIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobW9kYWxTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9lc2NhcGVLZXlIYW5kbGVyID0gdGhpcy5fZXNjYXBlS2V5SGFuZGxlci5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5fY2hlY2tLZXlQcmVzcyA9IGNoZWNrS2V5UHJlc3M7XHJcbiAgfVxyXG4gIC8vIC0tLSBPcGVuIG1vZGFsIG1ldGhvZCAtLS0gLy8gXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfdmlzaWJsZVwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9lc2NhcGVLZXlIYW5kbGVyKTtcclxuICB9XHJcbiAgLy8gLS0tIENsb3NlIG1vZGFsIG1ldGhvZCAtLS0gLy9cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfdmlzaWJsZVwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9lc2NhcGVLZXlIYW5kbGVyKTtcclxuICB9XHJcbiAgLy8gLS0tIENsb3NlIG1vZGFsIG9uIEVTQyBtZXRob2QgLS0tIC8vXHJcbiAgX2VzY2FwZUtleUhhbmRsZXIoZXZlbnQpIHtcclxuICAgIGlmICh0aGlzLl9jaGVja0tleVByZXNzKGV2ZW50LmtleSkpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnRcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgICAvLyAtLS0gQ2xvc2UgbW9kYWwgb24gY2xvc2UoJ1gnKSBidXR0b24gLS0tIC8vXHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX19jbG9zZS1idXR0b24nKSkge1xyXG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBDbG9zZSBtb2RhbCBvbiBvdmVybGF5KG91dCBvZiB0aGUgbW9kYWwpIGNsaWNrIC0tLSAvLy9cclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfdmlzaWJsZScpKSB7XHJcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufSIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxXaXRoRm9ybSBleHRlbmRzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3RvcihzZWxlY3RvciwgY2hlY2tLZXlQcmVzcywgaGFuZGxlU3VibWl0ICkge1xyXG4gICAgc3VwZXIoc2VsZWN0b3IsIGNoZWNrS2V5UHJlc3MpO1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gaGFuZGxlU3VibWl0O1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fc3VibWl0LWJ1dHRvbicpO1xyXG4gICAgdGhpcy5fZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY29udGFpbmVyJyk7XHJcbiAgICB0aGlzLl90ZXh0SW5CdXR0b24gPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBnZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubW9kYWxfX2lucHV0Jyk7XHJcbiAgICBjb25zdCBmb3JtSW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdFxyXG4gICAgICAuZm9yRWFjaCgoaW5wdXQpID0+IHsgZm9ybUlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWUgfVxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gZm9ybUlucHV0VmFsdWVzIHx8IHRoaXMuX2VudHJlZFZhbHVlO1xyXG4gIH1cclxuXHJcbiAgc2V0SW5wdXRWYWx1ZXMoZW50cmVkVmFsdWUpIHtcclxuICAgIHRoaXMuX2VudHJlZFZhbHVlID0gZW50cmVkVmFsdWU7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgLy8gLS0tIFVYIGZvciBtb2RhbHMgLS0tIC8vXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCh0aGlzLmdldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fdGV4dEluQnV0dG9uO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZWRFbGVtZW50cyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlZEVsZW1lbnRzLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSlcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShpdGVtKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcclxuICB9XHJcbn1cclxuIiwiLy8gLS0tICdFZGl0IHByb2ZpbGUnIG1vZGFsIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2VkaXQnKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3RpdGxlJyk7XHJcbmV4cG9ydCBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lucHV0X3R5cGVfdGl0bGUnKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fc3VidGl0bGUnKTtcclxuZXhwb3J0IGNvbnN0IGpvYklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX3N1YnRpdGxlJyk7XHJcbmV4cG9ydCBjb25zdCBlZGl0Q2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX2VkaXQnKTtcclxuLy8gLS0tICdBdmF0YXJcIiBtb2RhbCBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCB1c2VyQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlJyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlX292ZXJsYXknKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfYXZhdGFyJyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJNb2RhbElucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX2F2YXRhcicpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX2F2YXRhcicpXHJcbi8vIC0tLSAnQWRkLWNhcmQnIG1vZGFsIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfYWRkLWNhcmQnKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRJbnB1dFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX25hbWUnKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRJbnB1dExpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lucHV0X3R5cGVfbGluaycpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9hZGQtY2FyZCcpO1xyXG4vLyAtLS0gJ0FkZC1DYXJkJyBmb3JtIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXMuYWRkO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm1UaXRlbCA9IGFkZENhcmRGb3JtLmVsZW1lbnRzLnRpdGxlO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm1MaW5rID0gYWRkQ2FyZEZvcm0uZWxlbWVudHMubGluaztcclxuLy8gLS0tIEdlbmVyYWwgY29uc3QgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3N1Ym1pdC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRzX19ncmlkJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZF9fdGVtcGxhdGUnKTtcclxuLy8gLS0tIEJpZyBpbWFnZSBtb2RhbCBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBiaWdJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfYmlnLWltYWdlJyk7XHJcbmV4cG9ydCBjb25zdCBiaWdJbWFnZSA9IGJpZ0ltYWdlTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19iaWctaW1hZ2UnKTtcclxuZXhwb3J0IGNvbnN0IGJpZ0ltYWdlVGl0bGUgPSBiaWdJbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW1hZ2UtY2FwdGlvbicpO1xyXG5leHBvcnQgY29uc3QgY2FyZEJpZ01vZGFsQ2xvc2VJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9iaWctaW1hZ2UnKTtcclxuLy8gLS0tICdEZWxldGUgY2FyZCcgbW9kYWwgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2RlbGV0ZS1jYXJkJyk7XHJcbi8vIC0tLSBTZWxlY3RvcnMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlTW9kYWxTZWxlY3RvciA9ICcubW9kYWxfdHlwZV9lZGl0JztcclxuZXhwb3J0IGNvbnN0IGF2YXRhck1vZGFsU2VsZWN0b3IgPSAnLm1vZGFsX3R5cGVfYXZhdGFyJztcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbFNlbGVjdG9yID0gJy5tb2RhbF90eXBlX2FkZC1jYXJkJztcclxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmRTZWxlY3RvciA9ICcubW9kYWxfdHlwZV9kZWxldGUtY2FyZCc7XHJcbmV4cG9ydCBjb25zdCBiaWdJbWFnZVNlbGVjdG9yID0gJy5tb2RhbF90eXBlX2JpZy1pbWFnZSc7XHJcbmV4cG9ydCBjb25zdCBjYXJkTGlzdFNlbGVjdG9yID0gJy5jYXJkc19fZ3JpZCdcclxuLy8gLS0tIEZvcm0gY29uZmlnIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGZvcm1Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fY29udGFpbmVyXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfZXJyb3JcIixcclxuICBlcnJvck1lc3NhZ2VDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiXHJcbn07XHJcbi8vIC0tLSBBUEkgY29uc3QgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBhcGlDb25maWcgPSB7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgaGVhZGVyczogXHJcbiAge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI3MDlhMGQ5ZC1kYjA2LTQ4OTAtYTU5NC1iMDdlNzMwOWEzNTNcIixcclxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgXHJcbiAgfSxcclxufTsiLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBNb2RhbFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBNb2RhbFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvQXBpLmpzXCJcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgcHJvZmlsZU5hbWUsXHJcbiAgcHJvZmlsZUpvYixcclxuICBlZGl0QnV0dG9uLFxyXG4gIGNhcmRMaXN0U2VsZWN0b3IsXHJcbiAgcHJvZmlsZU1vZGFsLFxyXG4gIHByb2ZpbGVNb2RhbFNlbGVjdG9yLFxyXG4gIGNhcmRUZW1wbGF0ZSxcclxuICBhZGRDYXJkQnV0dG9uLFxyXG4gIGFkZENhcmRNb2RhbCxcclxuICBhZGRDYXJkTW9kYWxTZWxlY3RvcixcclxuICBjYXJkSW5wdXRUaXRsZSxcclxuICBjYXJkSW5wdXRMaW5rLFxyXG4gIGF2YXRhck1vZGFsLFxyXG4gIGF2YXRhck1vZGFsU2VsZWN0b3IsXHJcbiAgYXZhdGFyTW9kYWxJbnB1dCxcclxuICB1c2VyQXZhdGFyLFxyXG4gIGF2YXRhckVkaXRCdXR0b24sXHJcbiAgYmlnSW1hZ2VTZWxlY3RvcixcclxuICBiaWdJbWFnZSxcclxuICBiaWdJbWFnZVRpdGxlLFxyXG4gIGRlbGV0ZUNhcmRTZWxlY3RvcixcclxuICBhcGlDb25maWcsXHJcbiAgZm9ybUNvbmZpZyxcclxuICBuYW1lSW5wdXQsXHJcbiAgam9iSW5wdXRcclxufSBmcm9tIFwiLi4vY29tcG9uZW50cy91dGlscy9jb25zdGFudHMuanNcIjtcclxuXHJcbi8vID09PT09IE1vZGFscyA9PT09PSAvL1xyXG4vLyAtLS0gJ0VzYycgY2hlY2sgLS0tIC8vXHJcbmNvbnN0IGNoZWNrRm9yRXNjUHJlc3NlZCA9IChrZXkpID0+IGtleSA9PT0gXCJFc2NhcGVcIjtcclxuLy8gLS0tIEFkZCBtb2RhbCByZXNldCBpbnB1dCAtLS0gLy9cclxuY29uc3QgbW9kYWxSZXNldElucHV0cyA9ICgpID0+IHtcclxuICBjYXJkSW5wdXRUaXRsZS52YWx1ZSA9IFwiXCI7XHJcbiAgY2FyZElucHV0TGluay52YWx1ZSA9IFwiXCI7XHJcbn1cclxuXHJcbi8vID09PT09IFZhbGlkYXRpb24gPT09PT0gLy9cclxuLy8gLS0tICdFZGl0IHByb2ZpbGUnIGZvcm0gdmFsaWRhdGlvbiAtLS0gLy9cclxuY29uc3QgcHJvZmlsZUZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgcHJvZmlsZU1vZGFsKTtcclxucHJvZmlsZUZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuLy8gLS0tICdBdmF0YXInIGZvcm0gdmFsaWRhdGlvbiAtLS0gLy9cclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBhdmF0YXJNb2RhbCk7XHJcbmF2YXRhckZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuLy8gLS0tICdBZGQgY2FyZCcgZm9ybSB2YWxpZGF0aW9uIC0tLSAvL1xyXG5jb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBhZGRDYXJkTW9kYWwpO1xyXG5hZGRDYXJkRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuLy8gPT09PT0gQVBJICYgQ2FyZCA9PT09PSAvL1xyXG4vLyAtLS0gQVBJIGVycm9yIGhhbmRsZXIgLS0tIC8vIFxyXG5jb25zdCBhcGlFcnIgPSAoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpO1xyXG4vLyAtLS0gU2V0dGluZyB0aGUgZGVmYXVsdCBmZXRjaGluZyBtZXRob2QgLS0tIC8vXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoYXBpQ29uZmlnKTtcclxuLy8gLS0tIFNldCB3aGF0ICdwcm9maWxlJyB3aWxsIGNvbnRhaW5zIC0tLSAvL1xyXG5jb25zdCBwcm9maWxlID0gbmV3IFVzZXJJbmZvKFxyXG4gIHByb2ZpbGVOYW1lLCBcclxuICBwcm9maWxlSm9iXHJcbik7XHJcbmFwaVxyXG4gIC8vIC0tLSBHZXQgdXNlciBpbmZvIG1ldGhvZCAtLS0gLy9cclxuICAuZ2V0VXNlckluZm8oKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIHByb2ZpbGUuc2V0VXNlckluZm8ocmVzLm5hbWUsIHJlcy5hYm91dCk7XHJcbiAgICB1c2VyQXZhdGFyLnNyYyA9IHJlcy5hdmF0YXI7XHJcbiAgICByZXR1cm4gcHJvZmlsZTtcclxuICB9KVxyXG4gIC8vIC0tLSBVc2UgdXNlciBpbmZvIGZvciBjcmVhdGlvbiBvZiBuZXcgY2FyZHMgYW5kIGNhcmQgc2VjdGlvbiAtLS0gLy8gXHJcbiAgLnRoZW4oKHByb2ZpbGUpID0+IHtcclxuICAgIGFwaVxyXG4gICAgICAuZ2V0Q2FyZExpc3QoKVxyXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIC8vIC0tLSBPbiBjYXJkIGNsaWNrIGhhbmRsZXIgLS0tIC8vXHJcbiAgICAgICAgY29uc3Qgb25DYXJkQ2xpY2sgPSAoIG5hbWUsIGxpbmsgKSA9PiB7XHJcbiAgICAgICAgICBiaWdJbWFnZU1vZGFsLm9wZW4obmFtZSwgbGluayk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCB1c2VySW5mbyA9IHByb2ZpbGUuZ2V0VXNlckluZm8oKTtcclxuICAgICAgICAvLyAtLS0gRGVsZXRlIGNhcmQgYnV0dG9uIGhhbmRsZXIgLS0tIC8vXHJcbiAgICAgICAgY29uc3QgZGVsZXRlQ2FyZEhhbmRsZXIgPSAoY2FyZCkgPT4ge1xyXG4gICAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLnNldElucHV0VmFsdWVzKGNhcmQpO1xyXG4gICAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLm9wZW4oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gLS0tIExpa2UgYnV0dG9uIGNsaWNrIGhhbmRsZXIgLS0tIC8vXHJcbiAgICAgICAgY29uc3QgbGlrZUJ1dHRvbkNsaWNrSGFuZGxlciA9IChjYXJkKSA9PiB7XHJcbiAgICAgICAgICBpZihjYXJkLmlzTGlrZWQoKSkgXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAgIC51bmxpa2VDYXJkKGNhcmQuZ2V0Q2FyZElkKCkpXHJcbiAgICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgIGNhcmQudXBkYXRlQ2FyZChkYXRhLCB1c2VySW5mbyk7XHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAuY2F0Y2goYXBpRXJyKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2UgXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAgIC5saWtlQ2FyZChjYXJkLmdldENhcmRJZCgpLCBwcm9maWxlLmdldFVzZXJJbmZvKCkpXHJcbiAgICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgIGNhcmQudXBkYXRlQ2FyZChkYXRhLCB1c2VySW5mbyk7XHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAuY2F0Y2goYXBpRXJyKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIC0tLSBOZXcgY2FyZCBpbnN0YW5jZSBhZGRpbmcgLS0tIC8vXHJcbiAgICAgICAgY29uc3QgbmV3Q2FyZEluc3RhbmNlID0gKGRhdGEpID0+IHsgXHJcbiAgICAgICAgICBjb25zdCBjYXJkSW5zdGFuY2UgPSBuZXcgQ2FyZChcclxuICAgICAgICAgICAgZGF0YSxcclxuICAgICAgICAgICAgb25DYXJkQ2xpY2ssXHJcbiAgICAgICAgICAgIGRlbGV0ZUNhcmRIYW5kbGVyLFxyXG4gICAgICAgICAgICBsaWtlQnV0dG9uQ2xpY2tIYW5kbGVyLFxyXG4gICAgICAgICAgICBjYXJkVGVtcGxhdGVcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgICByZXR1cm4gY2FyZEluc3RhbmNlO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbiAoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaXRlbXM6IGRhdGEsXHJcbiAgICAgICAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2FyZEluc3RhbmNlID0gbmV3Q2FyZEluc3RhbmNlKGl0ZW0pO1xyXG4gICAgICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRJbnN0YW5jZS5nZW5lcmF0ZUNhcmQocHJvZmlsZS5pZCkpXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2FyZExpc3RTZWxlY3RvclxyXG4gICAgICApO1xyXG4gICAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG5cclxuICAgICAgY29uc3QgYWRkTmV3Q2FyZE1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0gKFxyXG4gICAgICAgIGFkZENhcmRNb2RhbFNlbGVjdG9yLFxyXG4gICAgICAgIGNoZWNrRm9yRXNjUHJlc3NlZCxcclxuICAgICAgICAoaW5wdXRzKSA9PiB7XHJcbiAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgLmFkZENhcmQoaW5wdXRzKVxyXG4gICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc3QgY2FyZEluc3RhbmNlID0gbmV3Q2FyZEluc3RhbmNlKHJlcyk7XHJcbiAgICAgICAgICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkSW5zdGFuY2UuZ2VuZXJhdGVDYXJkKHVzZXIuaWQpKTtcclxuICAgICAgICAgICAgICBtb2RhbFJlc2V0SW5wdXRzKCk7XHJcbiAgICAgICAgICAgICAgYWRkTmV3Q2FyZE1vZGFsLmNsb3NlKG1vZGFsUmVzZXRJbnB1dHMpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goYXBpRXJyKVxyXG4gICAgICAgIH1cclxuICAgICAgKTtcclxuICAgICAgYWRkTmV3Q2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgIGFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICBhZGROZXdDYXJkTW9kYWwub3BlbigpO1xyXG4gICAgICB9KTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goYXBpRXJyKTtcclxufSlcclxuLmNhdGNoKGFwaUVycik7XHJcblxyXG5cclxuLy8gPT09PT0gJ0VkaXQnIHByb2ZpbGUgPT09PT0gLy9cclxuLy8gLS0tIEVkaXQgcHJvZmlsZSBtb2RhbCAtLS0gLy9cclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IG5ldyBNb2RhbFdpdGhGb3JtIChcclxuICBwcm9maWxlTW9kYWxTZWxlY3RvcixcclxuICBjaGVja0ZvckVzY1ByZXNzZWQsXHJcbiAgKHtuYW1lLCBqb2J9KSA9PiBcclxuICB7XHJcbiAgICBhcGlcclxuICAgICAgLnNldFVzZXJJbmZvKHtuYW1lLGpvYn0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBwcm9maWxlLnNldFVzZXJJbmZvKHJlcy5hdmF0YXIpO1xyXG4gICAgICAgIGVkaXRQcm9maWxlTW9kYWwuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGFwaUVycik7XHJcbiAgfVxyXG4pXHJcbmVkaXRQcm9maWxlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuLy8gLS0tIEVkaXQgYnV0dG9uIGhhbmRsZXIgLS0tIC8vIFxyXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiICwgKCkgPT4ge1xyXG4gIG5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIGpvYklucHV0LnZhbHVlID0gcHJvZmlsZUpvYi50ZXh0Q29udGVudDtcclxuICBlZGl0UHJvZmlsZU1vZGFsLm9wZW4oKTtcclxufSk7XHJcbi8vIC0tLSBBdmF0YXIgZWRpdCBtb2RhbCAtLS0gLy9cclxuY29uc3QgYXZhdGFyRWRpdE1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0gKFxyXG4gIGF2YXRhck1vZGFsU2VsZWN0b3IsXHJcbiAgY2hlY2tGb3JFc2NQcmVzc2VkLFxyXG4gICh7IFwiYXZhdGFyTGlua1wiOmF2YXRhciB9KSA9PiBcclxuICB7XHJcbiAgICBhcGlcclxuICAgICAgLnNldFVzZXJBdmF0YXIoe2F2YXRhcn0pXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgcHJvZmlsZS5zZXRVc2VySW5mbyhkYXRhKTtcclxuICAgICAgICBhdmF0YXJFZGl0TW9kYWwuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGFwaUVycik7XHJcbiAgfVxyXG4pO1xyXG5hdmF0YXJFZGl0TW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuLy8gLS0tIEF2YXRhciBlZGl0IGJ1dHRvbiAtLS0gLy9cclxuYXZhdGFyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGF2YXRhck1vZGFsSW5wdXQudmFsdWUgPSBcIlwiO1xyXG4gIGF2YXRhckVkaXRNb2RhbC5vcGVuKCk7XHJcbn0pXHJcblxyXG4vLyAtLS0gRGVsZXRlIGNhcmQgbW9kYWwgaW5zdGFuY2UgYW5kIGV2ZW50cyAtLS0gLy9cclxuY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oXHJcbiAgZGVsZXRlQ2FyZFNlbGVjdG9yLFxyXG4gIGNoZWNrRm9yRXNjUHJlc3NlZCxcclxuICAoY2FyZCkgPT4ge1xyXG4gICAgYXBpXHJcbiAgICAgIC5kZWxldGVDYXJkKGNhcmQuZ2V0Q2FyZElkKCkpXHJcbiAgICAgIC50aGVuKCgpID0+e1xyXG4gICAgICAgIGNhcmQuZGVsZXRlQ2FyZCgpO1xyXG4gICAgICAgIGRlbGV0ZUNhcmRNb2RhbC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goYXBpRXJyKTtcclxuICB9XHJcbik7XHJcbmRlbGV0ZUNhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4vLyAtLS0gQmlnIGltYWdlIG1vZGFsIGluc3RhbmNlIC0tLSAvL1xyXG5jb25zdCBiaWdJbWFnZU1vZGFsID0gbmV3IE1vZGFsV2l0aEltYWdlKFxyXG4gIGJpZ0ltYWdlU2VsZWN0b3IsXHJcbiAgY2hlY2tGb3JFc2NQcmVzc2VkLFxyXG4gIGJpZ0ltYWdlLFxyXG4gIGJpZ0ltYWdlVGl0bGVcclxuKTtcclxuYmlnSW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGNvbmZpZy5iYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzO1xyXG4gIH1cclxuICAvLyAtLS0gR2xvYmFsIEFQSSByZXNwb25zZSBtZXRob2QgLS0tIC8vXHJcbiAgX3Jlc3BvbnNlKHJlcykge1xyXG4gICAgcmV0dXJuIHJlcy5va1xyXG4gICAgPyByZXMuanNvbigpXHJcbiAgICA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfSAtICR7cmVzLnN0YXR1c1RleHR9YCk7XHJcbiAgfVxyXG4gIC8vIC0tLSBHZXQgY2FyZCBsaXN0IGZyb20gdGhlIHNlcnZlciAtLS0gLy9cclxuICBnZXRDYXJkTGlzdCgpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fcmVzcG9uc2UpXHJcbiAgICApO1xyXG4gIH1cclxuICAvLyAtLS0gR2V0IHVzZXIgaW5mbyBmcm9tIHRoZSBzZXJ2ZXIgLS0tIC8vXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9yZXNwb25zZSlcclxuICB9XHJcbiAgLy8gLS0tIFVwZGF0aW5nL0VkaXRpbmcgdXNlciBwcm9maWxlIGluZm8gLS0tIC8vXHJcbiAgc2V0VXNlckluZm8obmFtZSwgYWJvdXQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7bmFtZSwgYWJvdXR9KVxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX3Jlc3BvbnNlKVxyXG4gIH1cclxuICAvLyAtLS0gQWRkaW5nIG5ldyBjYXJkIC0tLSAvL1xyXG4gIGFkZENhcmQoY2FyZERhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoY2FyZERhdGEpXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fcmVzcG9uc2UpXHJcbiAgfVxyXG4gIC8vIC0tLSBSZW1vdmluZyBhIGNhcmQgLS0tIC8vXHJcbiAgcmVtb3ZlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIlxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX3Jlc3BvbnNlKVxyXG4gIH1cclxuICAvLyAtLS0gTGlrZSBhIGNhcmQgLS0tIC8vXHJcbiAgbGlrZUNhcmQoY2FyZElkLCB1c2VyRGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh1c2VyRGF0YSlcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9yZXNwb25zZSlcclxuICB9XHJcbiAgLy8gLS0tIFVubGlrZSBhIGNhcmQgLS0tIC8vXHJcbiAgdW5saWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gICwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCJcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9yZXNwb25zZSlcclxuICB9XHJcbiAgLy8gLS0tIFNldHRpbmcgdXNlciBwcm9maWxlIGF2YXRhciAtLS0gLy9cclxuICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyIH0pXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fcmVzcG9uc2UpXHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3RvciggbmFtZUVsZW1lbnQsIHRpdGxlRWxlbWVudCwgcGljdHVyZUVsZW1lbnQgKSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IG5hbWVFbGVtZW50O1xyXG4gICAgdGhpcy5fdGl0bGVFbGVtZW50ID0gdGl0bGVFbGVtZW50O1xyXG4gICAgdGhpcy5fcGljdHVyZUVsZW1lbnQgPSBwaWN0dXJlRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgam9iOiB0aGlzLl9qb2IudGV4dENvbnRlbnRcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBnZXRVc2VyRGF0YSgpIHtcclxuICAgIHJldHVybiB0aGlzLl9kYXRhO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgam9iKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcclxuICAgIHRoaXMuX2pvYiA9IGpvYjtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX3RpdGxlRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX2pvYjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhJbWFnZSBleHRlbmRzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3RvciggbW9kYWwsIGNoZWNrS2V5UHJlc3MgKXtcclxuICAgIHN1cGVyKCBtb2RhbCwgY2hlY2tLZXlQcmVzcyApO1xyXG4gICAgdGhpcy5fbW9kYWxJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fYmlnLWltYWdlJyk7XHJcbiAgICB0aGlzLl9tb2RhbFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbWFnZS1jYXB0aW9uJyk7XHJcbiAgfVxyXG4gIC8vIC0tLSBPcGVuIGJpZyBpbWFnZSBtb2RhbCBtZXRob2QgLS0tIC8vXHJcbiAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICB0aGlzLl9tb2RhbFRpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX21vZGFsSW1hZ2Uuc2V0QXR0cmlidXRlKFwic3JjXCIsIGxpbmspOyBcclxuXHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsImZvcm1Db25maWciLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfZm9ybUNvbmZpZyIsIl9mb3JtRWxlbWVudCIsImlucHV0cyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvck1lc3NhZ2VDbGFzcyIsImVycm9yRWxlbWVudCIsImlkIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9jaGVja0lWYWxpZCIsImV2ZXJ5IiwiaW5wdXQiLCJfdG9nZ2xlU3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsIkNhcmQiLCJkYXRhIiwib25DYXJkQ2xpY2siLCJyZW1vdmVIYW5kbGVyIiwibGlrZUhhbmRsZXIiLCJ0ZW1wbGF0ZSIsInVzZXJJZCIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9saWtlcyIsImxpa2VzIiwiX293bmVySWQiLCJvd25lciIsIl9pZCIsIl90ZW1wbGF0ZSIsIl91c2VySWQiLCJfb25DYXJkQ2xpY2siLCJfbGlrZUhhbmRsZXIiLCJfcmVtb3ZlSGFuZGxlciIsIl9nZXRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfc2V0QXR0cmlidXRlcyIsImNhcmRFbGVtZW50IiwiYXR0cmlicyIsImtleSIsInNldEF0dHJpYnV0ZSIsImRlbGV0ZUNhcmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwiX2NhcmRFbGVtZW50IiwiX3JlbmRlckxpa2VzIiwibGlrZSIsIl9saWtlQ2FyZCIsIl91bmxpa2VDYXJkIiwic2hvd0xpa2VzIiwiY291bnQiLCJpc0xpa2VkIiwiX2xpa2VkIiwiX2NoZWNrRm9yTGlrZSIsInVzZXIiLCJmaW5kIiwiX3Nob3dEZWxldGVJY29uIiwiZ2V0Q2FyZElkIiwiZ2VuZXJhdGVDYXJkIiwibGlrZUljb24iLCJzcmMiLCJhbHQiLCJsZW5ndGgiLCJ1cGRhdGVDYXJkIiwiTW9kYWwiLCJtb2RhbFNlbGVjdG9yIiwiY2hlY2tLZXlQcmVzcyIsIl9tb2RhbEVsZW1lbnQiLCJfZXNjYXBlS2V5SGFuZGxlciIsImJpbmQiLCJfY2hlY2tLZXlQcmVzcyIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiTW9kYWxXaXRoRm9ybSIsInNlbGVjdG9yIiwiaGFuZGxlU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlU3VibWl0IiwiX3N1Ym1pdEJ1dHRvbiIsIl9mb3JtIiwiX3RleHRJbkJ1dHRvbiIsImdldElucHV0VmFsdWVzIiwiX2lucHV0TGlzdCIsImZvcm1JbnB1dFZhbHVlcyIsInZhbHVlIiwiX2VudHJlZFZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJlbnRyZWRWYWx1ZSIsInJlc2V0IiwiU2VjdGlvbiIsIml0ZW1zIiwicmVuZGVyZXIiLCJjb250YWluZXJTZWxlY3RvciIsIl9yZW5kZXJlZEVsZW1lbnRzIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJwcmVwZW5kIiwiZWRpdEJ1dHRvbiIsInByb2ZpbGVNb2RhbCIsInByb2ZpbGVOYW1lIiwibmFtZUlucHV0IiwicHJvZmlsZUpvYiIsImpvYklucHV0IiwidXNlckF2YXRhciIsImF2YXRhckVkaXRCdXR0b24iLCJhdmF0YXJNb2RhbCIsImF2YXRhck1vZGFsSW5wdXQiLCJhZGRDYXJkQnV0dG9uIiwiYWRkQ2FyZE1vZGFsIiwiY2FyZElucHV0VGl0bGUiLCJjYXJkSW5wdXRMaW5rIiwiYWRkQ2FyZEZvcm0iLCJmb3JtcyIsImNhcmRUZW1wbGF0ZSIsImVsZW1lbnRzIiwidGl0bGUiLCJiaWdJbWFnZU1vZGFsIiwiYmlnSW1hZ2UiLCJiaWdJbWFnZVRpdGxlIiwiZm9ybVNlbGVjdG9yIiwiY2hlY2tGb3JFc2NQcmVzc2VkIiwibW9kYWxSZXNldElucHV0cyIsImFwaUVyciIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJhcGkiLCJjb25maWciLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfcmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwic3RhdHVzVGV4dCIsImdldENhcmRMaXN0IiwiZmV0Y2giLCJ0aGVuIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhZGRDYXJkIiwiY2FyZERhdGEiLCJyZW1vdmVDYXJkIiwiY2FyZElkIiwibGlrZUNhcmQiLCJ1c2VyRGF0YSIsInVubGlrZUNhcmQiLCJzZXRVc2VyQXZhdGFyIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsInByb2ZpbGUiLCJuYW1lRWxlbWVudCIsInRpdGxlRWxlbWVudCIsInBpY3R1cmVFbGVtZW50IiwiX25hbWVFbGVtZW50IiwiX3RpdGxlRWxlbWVudCIsIl9waWN0dXJlRWxlbWVudCIsImpvYiIsIl9qb2IiLCJnZXRVc2VyRGF0YSIsIl9kYXRhIiwidXNlckluZm8iLCJkZWxldGVDYXJkSGFuZGxlciIsImNhcmQiLCJkZWxldGVDYXJkTW9kYWwiLCJsaWtlQnV0dG9uQ2xpY2tIYW5kbGVyIiwiY2F0Y2giLCJuZXdDYXJkSW5zdGFuY2UiLCJjYXJkU2VjdGlvbiIsImNhcmRJbnN0YW5jZSIsImFkZE5ld0NhcmRNb2RhbCIsImVkaXRQcm9maWxlTW9kYWwiLCJhdmF0YXJFZGl0TW9kYWwiLCJtb2RhbCIsIl9tb2RhbEltYWdlIiwiX21vZGFsVGl0bGUiXSwic291cmNlUm9vdCI6IiJ9