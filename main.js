!function(){"use strict";class e{constructor({baseUrl:e,headers:t}){this.baseUrl=e,this.headers=t}getInitialCards(){return fetch(this.baseUrl+"/cards",{headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch(this.baseUrl+"/users/me",{headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addCard({name:e,link:t}){return fetch(this.baseUrl+"/cards",{headers:this.headers,method:"POST",body:JSON.stringify({name:e,link:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}removeCard(e){return fetch(this.baseUrl+"/cards/"+e,{headers:this.headers,method:"DELETE"}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}addLike(e){return fetch(this.baseUrl+"/cards/likes/"+e.getId(),{headers:this.headers,method:"PUT"}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}removeLike(e){return fetch(this.baseUrl+"/cards/likes/"+e.getId(),{headers:this.headers,method:"DELETE"}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateUserInfo({name:e,about:t}){return fetch(this.baseUrl+"/users/me",{headers:this.headers,method:"PATCH",body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setUserAvatar({avatar:e}){return fetch(this.baseUrl+"/users/me/avatar",{headers:this.headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}new e({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"709a0d9d-db06-4890-a594-b07e7309a353","Content-Type":"application/json"}});class t{constructor({cardData:e,user:t,onCardClick:s,removeHandler:r,likeHandler:i},n){this._name=e.name,this._link=e.link,this._cardId=e._id,this._ownerId=e.owner._id,this._userID=t,this._likes=e.likes,this._cardSelector=n,this._onCardClick=s,this._likeHandler=i,this._removeHandler=r}_getTemplate(){return document.querySelector("#card__template").content.querySelector(".card").cloneNode(!0)}deleteCard(){this._item.remove(),this._item=null}_renderLikes(){this.isLiked()?this._item.querySelector(".card__like-button").classList.add("card__like-button_active"):this._item.querySelector(".card__like-button").classList.remove("card__like-button_active"),this._item.querySelector(".card__like-counter").textContent=this._likes.length}isLiked(){return this._likes.some((e=>e._id===this._userId))}updateLikes(e){this._likes=e,this._renderLikes()}_setEventListeners(){this._item.querySelector(".card__like-button").addEventListener("click",(e=>{this._likeCard(e)})),this._item.querySelector(".card__delete-button").addEventListener("click",(()=>{this._removeHandler(this._cardId)})),this._cardImage.addEventListener("click",(e=>{this._onCardClick(e)}))}generateCard(){return this._item=this._getTemplate(),this._ownerId!==this._userId&&this._element.querySelector(".card__delete-button").classList.add("card__delete-button_hidden"),this._cardImage=this._item.querySelector(".card__image"),this._item.querySelector(".card__title").textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=`Image of  ${this._name} `,this._renderLikes(),this._setEventListeners(),this._item}}class s{constructor(e,t){this._formConfig=e,this._formElement=t}_showInputError=(e,t)=>{const{inputErrorClass:s,errorMessageClass:r}=this._formConfig,i=this._formElement.querySelector(` #${e.id}_error `);i.textContent=t,i.classList.add(r),e.classList.add(s)};_hideInputError=e=>{const{inputErrorClass:t,errorMessageClass:s}=this._formConfig,r=this._formElement.querySelector(` #${e.id}_error `);r.textContent="",r.classList.remove(s),e.classList.remove(t)};resetValidation(){this.inputs.forEach((e=>{this._hideInputError(e)})),this._toggleSubmitButton()}_checkInput=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)};_checkIfFormValid=()=>this.inputs.every((e=>e.validity.valid));_toggleSubmitButton(){const{inactiveButtonClass:e,submitButtonSelector:t}=this._formConfig,s=this._formElement.querySelector(t);this._checkIfFormValid()?(s.disabled=!1,s.classList.remove(e)):(s.disabled=!0,s.classList.add(e))}_setEventListeners=()=>{const{inputSelector:e}=this._formConfig;return this.inputs=Array.from(this._formElement.querySelectorAll(e)),this.inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInput(e),this._toggleSubmitButton()}))})),this._formElement};enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const r=document.querySelector(".profile__edit-button"),i=document.forms.profile,n=(i.elements.name,i.elements.job,document.querySelector(".modal__close-button_type_edit"),document.querySelector(".profile__add-button"),document.querySelector(".modal_type_add-card")),o=(document.querySelector(".modal__input_type_name"),document.querySelector(".modal__input_type_link"),document.querySelector(".modal__close-button_type_add-card"),document.forms.add),a=(o.elements.title,o.elements.link,document.querySelector(".modal__submit-button"),document.querySelector(".cards__grid"),document.querySelector(".modal_type_big-image"),document.querySelector(".modal__big-image"),document.querySelector(".modal__image-caption"),document.querySelector(".modal__close-button_type_big-image"),{formSelector:".modal__container",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_error",errorMessageClass:"modal__error_visible"});class l{constructor(e){this._modalElement=document.querySelector(e)}_checkForEscClose=e=>{"Escape"===e.key&&this.close()};open=()=>{this._modalElement.classList.add("modal_visible"),document.addEventListener("keyup",this._checkForEscClose)};close=()=>{this._modalElement.classList.remove("modal_visible"),document.removeEventListener("keyup",this._checkForEscClose)};setEventListeners(){this._modalElement.querySelector(".modal__close-button").addEventListener("click",(e=>{this.close(e)})),this._modalElement.addEventListener("click",(e=>{e.target.classList.contains("modal_visible")&&this.close(e)}))}}class d extends l{constructor(e,t){super(e),this._handleSubmitBtn=t,this._formElement=this._modalElement.querySelector(".modal__container")}getInputValues(){const e=Array.from(this._formElement.querySelectorAll(".modal__input")),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setInputValues(e){Array.from(this._formElement.querySelectorAll(".modal__input")).forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(()=>{this._handleSubmitBtn(this.getInputValues()),this.close(),this._formElement.reset()}))}close(){super.close(),this._formElement.reset()}}class c extends l{constructor(e,t){super(e),this._form=document.querySelector(this._selector),this._handleSubmit=t,this._handleSubmitHandler=this._handleSubmitHandler.bind(this)}_handleSubmitHandler(e){e.preventDefault(),this._handleSubmit(),super.close()}_setEventListeners(){super._setEventListeners(),this._form.addEventListener("submit",this._handleSubmitHandler)}_removeEventListeners(){super._removeEventListeners(),this._form.removeEventListener("submit",this._handleSubmitHandler)}}const _=new class extends l{openup=e=>{const t=e.target;this._modalElement.querySelector(".modal__big-image").src=t.src,this._modalElement.querySelector(".modal__big-image").alt=t.alt,this._modalElement.querySelector(".modal__image-caption").textContent=t.alt,this.open()}}(".modal_type_big-image");new d(".modal_type_delete-card").setEventListeners();const m=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}addItem(e){this._container.prepend(e)}clear(){this._container.innerHTML=""}renderItems(){this.clear(),this._items.forEach((e=>{this._renderer(e)}))}}((s=>{m.addItem(function(s){const r=new t({data:s,user:E,cardSelector:".cards__grid",handleCardClick:e=>{e.preventDefault();const t=e.target,s=t.src,r=t.alt;_.open(s,r),_.setEventListeners()},handleDeleteCard:t=>{c.open(),c.setAction((()=>e.deleteCard(t).then((e=>{r.deleteCard(),c.close()})).catch((e=>console.log(e)))))},handleLikes:t=>{r.isLiked()?e.dislike(t).then((e=>{r.updateLikes(e.likes)})).catch((e=>console.log(e))):e.addLike(t).then((e=>{r.updateLikes(e.likes)})).catch((e=>console.log(e)))}});return r.generateCard()}(s))}),".cards__grid"),h=new class{constructor({name:e,job:t,avatar:s}){this._name=document.querySelector(`${e}`),this._job=document.querySelector(`${t}`),this._avatar=document.querySelector(`${s}`)}getUserInfo(){return{name:this._name.textContent,job:this._job.textContent,avatar:this._avatar.src}}setUserInfo({name:e,job:t}){this._name.textContent=e,this._job.textContent=t}setUserAvatar({avatar:e}){this._avatar.src=e}}({name:".profile__title",about:".profile__subtitle",avatar:".profile__image"});e.getUserInfo().then((e=>{h.setUserInfo(e),E=e._id,h.setAvatar(e.avatar)})).catch((e=>console.log(e))),e.getInitialCards().then((e=>{m.renderItems(e)})).catch((e=>console.log(e)));const u=new d(".modal_type_edit",(()=>{h.setUserInfo(u.getInputValues()),u.close()}));u.setEventListeners(),r.addEventListener("click",(()=>{u.setInputValues(h.getUserInfo()),b.resetValidation(),u.open()}));const p=new d(".modal_type_add-card",(()=>{const e=p.getInputValues();m.addItem(generateCard(e)),p.close()}));p.setEventListeners();const b=new s(a,i);let E;b.enableValidation(),new s(a,avatarModal).enableValidation(),new s(a,n).enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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IjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWwuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9Nb2RhbERlbGV0ZUNvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL0luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuaGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICAvLyAtLS0gR0VUIGh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvY2FyZHMgLS0tIC8vXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuYmFzZVVybCArIFwiL2NhcmRzXCIsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIEdFVCBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL3VzZXJzL21lIC0tLSAvL1xyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuYmFzZVVybCArIFwiL3VzZXJzL21lXCIsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIFBPU1QgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi9jYXJkcyAtLS0gLy9cclxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5iYXNlVXJsICsgXCIvY2FyZHNcIiwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluayB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBERUxFVEUgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi9jYXJkcy9jYXJkSUQgLS0tIC8vXHJcbiAgcmVtb3ZlQ2FyZChjYXJkSUQpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLmJhc2VVcmwgKyBcIi9jYXJkcy9cIiArIGNhcmRJRCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldEFwcEluZm8oKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIEFkZC9yZW1vdmUgbGlrZXMgLS0tIC8vXHJcbiAgLy8gLS0tIFBVVCBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwSWQvY2FyZHMvbGlrZXMvY2FyZElkIC0tLSAvL1xyXG4gIGFkZExpa2UoY2FyZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuYmFzZVVybCArIFwiL2NhcmRzL2xpa2VzL1wiICsgY2FyZC5nZXRJZCgpLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIERFTEVURSBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwSWQvY2FyZHMvbGlrZXMvY2FyZElkIC0tLSAvL1xyXG4gIHJlbW92ZUxpa2UoY2FyZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuYmFzZVVybCArIFwiL2NhcmRzL2xpa2VzL1wiICsgY2FyZC5nZXRJZCgpLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIEVkaXRpbmcgUHJvZmlsZSBpbmZvIC0tLSAvL1xyXG4gIC8vIC0tLSBQQVRDSCBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwSWQvdXNlcnMvbWUgLS0tIC8vXHJcbiAgdXBkYXRlVXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5iYXNlVXJsICsgXCIvdXNlcnMvbWVcIiwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBQQVRDSCBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwSWQvdXNlcnMvbWUvYXZhdGFyXHJcbiAgc2V0VXNlckF2YXRhcih7IGF2YXRhciB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5iYXNlVXJsICsgXCIvdXNlcnMvbWUvYXZhdGFyXCIsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXIgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI3MDlhMGQ5ZC1kYjA2LTQ4OTAtYTU5NC1iMDdlNzMwOWEzNTNcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG4iLCJleHBvcnQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICB7IGNhcmREYXRhLCB1c2VyLCBvbkNhcmRDbGljaywgcmVtb3ZlSGFuZGxlciwgbGlrZUhhbmRsZXIgfSxcclxuICAgIGNhcmRTZWxlY3RvclxyXG4gICkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRJZCA9IGNhcmREYXRhLl9pZDtcclxuICAgIHRoaXMuX293bmVySWQgPSBjYXJkRGF0YS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl91c2VySUQgPSB1c2VyO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBjYXJkRGF0YS5saWtlcztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuXHJcbiAgICB0aGlzLl9vbkNhcmRDbGljayA9IG9uQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5fbGlrZUhhbmRsZXIgPSBsaWtlSGFuZGxlcjtcclxuICAgIHRoaXMuX3JlbW92ZUhhbmRsZXIgPSByZW1vdmVIYW5kbGVyO1xyXG4gIH1cclxuICAvLyAtLS0gR2V0dGluZyB0aGUgdGVtcGxhdGUgLS0tIC8vXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiI2NhcmRfX3RlbXBsYXRlXCIpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgcmV0dXJuIGNhcmQ7XHJcbiAgfVxyXG5cclxuICAvLyAtLS0gQ2FyZCBkZWxldGluZyBtZXRob2QgLS0tIC8vXHJcbiAgZGVsZXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2l0ZW0ucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9pdGVtID0gbnVsbDtcclxuICB9XHJcblxyXG4gIF9yZW5kZXJMaWtlcygpIHtcclxuICAgIGlmICh0aGlzLmlzTGlrZWQoKSkge1xyXG4gICAgICB0aGlzLl9pdGVtXHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgICAgICAuY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2l0ZW1cclxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAgIC5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5faXRlbS5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtY291bnRlclwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgIHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBDaGVjayBpZiBjYXJkIGxpa2VkIGJ5IGFub3RoZXIgdXNlciAtLS0gLy9cclxuICBpc0xpa2VkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKHVzZXIpID0+IHVzZXIuX2lkID09PSB0aGlzLl91c2VySWQpO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIFRvZ2dsZSBsaWtlIGJ1dHRvbiBtZXRob2QgLS0tIC8vXHJcbiAgdXBkYXRlTGlrZXMobmV3TGlrZXMpIHtcclxuICAgIHRoaXMuX2xpa2VzID0gbmV3TGlrZXM7XHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIFNldCBldmVudHMgbGlzdGVuZXJzIGZvciB0aGUgY2FyZHMgdGhhdCB3aWxsIGJlIGNyZWF0ZWQhIC0tLSAvL1xyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2l0ZW1cclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgICB0aGlzLl9saWtlQ2FyZChldmVudCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2l0ZW1cclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9yZW1vdmVIYW5kbGVyKHRoaXMuX2NhcmRJZCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX29uQ2FyZENsaWNrKGV2ZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIENyZWF0aW5nIHRoZSBjYXJkIGFuZCBjYXJkIGVsZW1lbnRzIC0tLSAvL1xyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2l0ZW0gPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG5cclxuICAgIGlmICh0aGlzLl9vd25lcklkICE9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgdGhpcy5fZWxlbWVudFxyXG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcclxuICAgICAgICAuY2xhc3NMaXN0LmFkZChcImNhcmRfX2RlbGV0ZS1idXR0b25faGlkZGVuXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2l0ZW0ucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2l0ZW0ucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSBcIkltYWdlIG9mIFwiICsgYCAke3RoaXMuX25hbWV9IGA7XHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2l0ZW07XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGZvcm1Db25maWcsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9mb3JtQ29uZmlnID0gZm9ybUNvbmZpZztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpID0+IHtcclxuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvck1lc3NhZ2VDbGFzcyB9ID0gdGhpcy5fZm9ybUNvbmZpZztcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCAjJHtpbnB1dEVsZW1lbnQuaWR9X2Vycm9yIGApO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoZXJyb3JNZXNzYWdlQ2xhc3MpO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5wdXRFcnJvckNsYXNzKTtcclxuICB9O1xyXG4gIFxyXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvck1lc3NhZ2VDbGFzcyB9ID0gdGhpcy5fZm9ybUNvbmZpZztcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCAjJHtpbnB1dEVsZW1lbnQuaWR9X2Vycm9yIGApO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGVycm9yTWVzc2FnZUNsYXNzKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl90b2dnbGVTdWJtaXRCdXR0b24oKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0ID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9jaGVja0lmRm9ybVZhbGlkID0gKCkgPT4gdGhpcy5pbnB1dHMuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcblxyXG4gIF90b2dnbGVTdWJtaXRCdXR0b24oKSB7XHJcbiAgICBjb25zdCB7IGluYWN0aXZlQnV0dG9uQ2xhc3MsIHN1Ym1pdEJ1dHRvblNlbGVjdG9yIH0gPSB0aGlzLl9mb3JtQ29uZmlnO1xyXG4gICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICAgIGlmICh0aGlzLl9jaGVja0lmRm9ybVZhbGlkKCkpIHtcclxuICAgICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgY29uc3QgeyBpbnB1dFNlbGVjdG9yIH0gPSB0aGlzLl9mb3JtQ29uZmlnO1xyXG4gICAgdGhpcy5pbnB1dHMgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoaW5wdXRTZWxlY3RvcikpO1xyXG5cclxuICAgIHRoaXMuaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dChpbnB1dCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlU3VibWl0QnV0dG9uKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybUVsZW1lbnQ7XHJcbiAgfTtcclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59IiwiLy8gLS0gJ0VkaXQgcHJvZmlsZScgbW9kYWwgY29uc3RzIC0tIC8vXHJcbmV4cG9ydCBjb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlTW9kYWwgPSBkb2N1bWVudC5mb3Jtcy5wcm9maWxlO1xyXG5leHBvcnQgY29uc3QgbmFtZUlucHV0ID0gcHJvZmlsZU1vZGFsLmVsZW1lbnRzLm5hbWU7XHJcbmV4cG9ydCBjb25zdCBqb2JJbnB1dCA9IHByb2ZpbGVNb2RhbC5lbGVtZW50cy5qb2I7XHJcbmV4cG9ydCBjb25zdCBlZGl0Q2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX2VkaXQnKTtcclxuLy8gLS0gJ0FkZC1jYXJkJyBtb2RhbCBjb25zdHMgLS0gLy9cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfYWRkLWNhcmQnKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRJbnB1dFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX25hbWUnKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRJbnB1dExpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lucHV0X3R5cGVfbGluaycpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9hZGQtY2FyZCcpO1xyXG4vLyAtLS0gJ0FkZC1DYXJkJyBmb3JtIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXMuYWRkO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm1UaXRlbCA9IGFkZENhcmRGb3JtLmVsZW1lbnRzLnRpdGxlO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm1MaW5rID0gYWRkQ2FyZEZvcm0uZWxlbWVudHMubGluaztcclxuLy8gLS0tIEdlbmVyYWwgY29uc3QgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3N1Ym1pdC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRzX19ncmlkJyk7XHJcbi8vIC0tLSBCaWcgaW1hZ2UgbW9kYWwgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgY2FyZEJpZ01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfYmlnLWltYWdlJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkQmlnTW9kYWxJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fYmlnLWltYWdlJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkQmlnTW9kYWxUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbWFnZS1jYXB0aW9uJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkQmlnTW9kYWxDbG9zZUljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX2JpZy1pbWFnZScpO1xyXG4vLyAtLS0gRm9ybSBjb25maWcgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgZm9ybUNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19jb250YWluZXJcIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF9lcnJvclwiLFxyXG4gIGVycm9yTWVzc2FnZUNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCJcclxufTtcclxuLy8gLS0tIGluaXRDYXJkcyBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBpbml0Q2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCJcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCJcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvYmFsZC1tb3VudGFpbnMuanBnXCJcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnXCJcclxuICB9XHJcbl07IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWwge1xyXG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobW9kYWxTZWxlY3Rvcik7XHJcbiAgfVxyXG4gIC8vIC0tLSBDbG9zZSBtb2RhbCBvbiBFU0MgbWV0aG9kIC0tLSAvL1xyXG4gIF9jaGVja0ZvckVzY0Nsb3NlID0gKGV2ZW50KSA9PiB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcbiAgLy8gLS0tIE9wZW4gbW9kYWwgbWV0aG9kIC0tLSAvLyBcclxuICBvcGVuID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF92aXNpYmxlXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2NoZWNrRm9yRXNjQ2xvc2UpO1xyXG4gIH1cclxuICAvLyAtLS0gQ2xvc2UgbW9kYWwgbWV0aG9kIC0tLSAvL1xyXG4gIGNsb3NlID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF92aXNpYmxlXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2NoZWNrRm9yRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyAtLS0gQ2xvc2UgbW9kYWwgb24gY2xvc2UoJ1gnKSBidXR0b24gLS0tIC8vXHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnRcclxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIilcclxuICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuY2xvc2UoZXZlbnQpO1xyXG4gICAgfSk7XHJcbiAgICAvLyBDbG9zZSBtb2RhbCBvbiBvdmVybGF5KG91dCBvZiB0aGUgbW9kYWwpIGNsaWNrIC0tLSAvLy9cclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfdmlzaWJsZVwiKSkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoZXZlbnQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn0iLCJpbXBvcnQgTW9kYWwgZnJvbSBcIi4vTW9kYWwuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsV2l0aEZvcm0gZXh0ZW5kcyBNb2RhbCB7XHJcbiAgY29uc3RydWN0b3IobW9kYWxTZWxlY3RvciwgaGFuZGxlU3VibWl0KSB7XHJcbiAgICBzdXBlcihtb2RhbFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEJ0biA9IGhhbmRsZVN1Ym1pdDtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NvbnRhaW5lclwiKTtcclxuICB9XHJcblxyXG4gIGdldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIilcclxuICAgICk7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7aW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTt9KTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldElucHV0VmFsdWVzKHZhbHVlcykge1xyXG4gICAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIilcclxuICAgICk7XHJcbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtpbnB1dC52YWx1ZSA9IHZhbHVlc1tpbnB1dC5uYW1lXTt9KVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEJ0bih0aGlzLmdldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7XHJcbiAgfVxyXG59IiwiaW1wb3J0IE1vZGFsIGZyb20gJy4vTW9kYWwuanMnO1xyXG4gIFxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbERlbGV0ZUNvbmZpcm1hdGlvbiBleHRlbmRzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3RvciAoc2VsZWN0b3IsIGhhbmRsZVN1Ym1pdCkge1xyXG4gICAgc3VwZXIoc2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gaGFuZGxlU3VibWl0O1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0SGFuZGxlciA9IHRoaXMuX2hhbmRsZVN1Ym1pdEhhbmRsZXIuYmluZCh0aGlzKTtcclxuICB9XHJcbiAgXHJcbiAgX2hhbmRsZVN1Ym1pdEhhbmRsZXIgKGV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gIH1cclxuICBcclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgKCkge1xyXG4gICAgc3VwZXIuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX2hhbmRsZVN1Ym1pdEhhbmRsZXIpO1xyXG4gIH1cclxuICBcclxuICBfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMgKCkge1xyXG4gICAgc3VwZXIuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX2hhbmRsZVN1Ym1pdEhhbmRsZXIpO1xyXG4gIH1cclxufSIsImltcG9ydCBhcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9BcGkuanNcIjtcclxuaW1wb3J0IHsgQ2FyZCB9IGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgZWRpdEJ1dHRvbixcclxuICBwcm9maWxlTW9kYWwsXHJcbiAgYWRkQ2FyZEJ1dHRvbixcclxuICBhZGRDYXJkTW9kYWwsXHJcbiAgZm9ybUNvbmZpZ1xyXG59IGZyb20gXCIuLi9jb21wb25lbnRzL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgTW9kYWxXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9Nb2RhbFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgTW9kYWxXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IE1vZGFsRGVsZXRlQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxEZWxldGVDb25maXJtYXRpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuXHJcbi8vIC0tLSBCaWcgaW1hZ2UgbW9kYWwgaW5zdGFuY2UgLS0tIC8vXHJcbmNvbnN0IGJpZ0ltYWdlTW9kYWwgPSBuZXcgTW9kYWxXaXRoSW1hZ2UoXCIubW9kYWxfdHlwZV9iaWctaW1hZ2VcIik7XHJcblxyXG4vLyAtLS0gRGVsZXRlIGNhcmQgbW9kYWwgaW5zdGFuY2UgYW5kIGV2ZW50cyAtLS0gLy9cclxuY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oXCIubW9kYWxfdHlwZV9kZWxldGUtY2FyZFwiKTtcclxuZGVsZXRlQ2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLyArKysrKyBDYXJkIFNlY3Rpb24gKysrKysgLy9cclxuLy8gLS0tIENhcmQgcmVuZGVyIGZ1bmN0aW9uIC0tLSAvL1xyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoe1xyXG4gICAgZGF0YTogZGF0YSxcclxuICAgIHVzZXI6IHVzZXJJZCxcclxuICAgIGNhcmRTZWxlY3RvcjogXCIuY2FyZHNfX2dyaWRcIixcclxuICAgIGhhbmRsZUNhcmRDbGljazogKGV2dCkgPT4ge1xyXG4gICAgICAvLyAtLS0gT3BlbiBiaWcgaW1hZ2UgbW9kYWwgLS0tIC8vXHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjb25zdCB0YXJnZXQgPSBldnQudGFyZ2V0O1xyXG4gICAgICBjb25zdCBsaW5rID0gdGFyZ2V0LnNyYztcclxuICAgICAgY29uc3QgbmFtZSA9IHRhcmdldC5hbHQ7XHJcbiAgICAgIGJpZ0ltYWdlTW9kYWwub3BlbihsaW5rLCBuYW1lKTtcclxuICAgICAgYmlnSW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfSxcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQ6IChjYXJkSWQpID0+IHtcclxuICAgICAgTW9kYWxEZWxldGVDb25maXJtYXRpb24ub3BlbigpO1xyXG4gICAgICBNb2RhbERlbGV0ZUNvbmZpcm1hdGlvbi5zZXRBY3Rpb24oKCkgPT5cclxuICAgICAgICBhcGkuZGVsZXRlQ2FyZChjYXJkSWQpLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XHJcbiAgICAgICAgICBNb2RhbERlbGV0ZUNvbmZpcm1hdGlvbi5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXHJcbiAgICAgICk7XHJcbiAgICB9LFxyXG4gICAgaGFuZGxlTGlrZXM6IChjYXJkSWQpID0+IHtcclxuICAgICAgY29uc3QgaXNMaWtlZCA9IGNhcmQuaXNMaWtlZCgpO1xyXG4gICAgICBpZiAoaXNMaWtlZCkge1xyXG4gICAgICAgIGFwaS5kaXNsaWtlKGNhcmRJZCkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgICAgfSBcclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgYXBpLmFkZExpa2UoY2FyZElkKS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIGNhcmQudXBkYXRlTGlrZXMocmVzLmxpa2VzKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gIH0pO1xyXG4gIC8vIC0tLSBDbG9uZSBmcm9tIHRlbXBsYXRlIC0tLSAvL1xyXG4gIGNvbnN0IGNhcmRzSXRlbSA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbiAgcmV0dXJuIGNhcmRzSXRlbTtcclxufVxyXG5cclxuY29uc3QgY2FyZHNTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgKGl0ZW0pID0+IHtcclxuICAgIGNhcmRzU2VjdGlvbi5hZGRJdGVtKGNyZWF0ZUNhcmQoaXRlbSkpO1xyXG4gIH0sXHJcbiAgXCIuY2FyZHNfX2dyaWRcIlxyXG4pO1xyXG5cclxuLy8gKysrKysgJ1VzZXIgSW5mbycgKysrKysgLy9cclxuLy8gLS0tIFVzZXJJbmZvIGluc3RhbmNlIC0tLSAvL1xyXG5jb25zdCB1c2VySW5mb1ZhbHVlcyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZTogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBhYm91dDogXCIucHJvZmlsZV9fc3VidGl0bGVcIixcclxuICBhdmF0YXI6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXHJcbn0pO1xyXG4vLyAtLS0gVXNlckluZm8gaW5pdCAtLS0gLy9cclxuYXBpLmdldFVzZXJJbmZvKCkudGhlbigocmVzKSA9PiB7XHJcbiAgdXNlckluZm9WYWx1ZXMuc2V0VXNlckluZm8ocmVzKTtcclxuICB1c2VySWQgPSByZXMuX2lkO1xyXG4gIHVzZXJJbmZvVmFsdWVzLnNldEF2YXRhcihyZXMuYXZhdGFyKTtcclxufSlcclxuLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG5cclxuLy8gKysrKysgQ2FyZCBsaXN0ICsrKysrIC8vXHJcbi8vIC0tLSBDYXJkcyBpbml0IC0tLSAvL1xyXG5hcGkuZ2V0SW5pdGlhbENhcmRzKCkudGhlbigocmVzKSA9PiB7XHJcbiAgY2FyZHNTZWN0aW9uLnJlbmRlckl0ZW1zKHJlcyk7XHJcbn0pXHJcbi5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuXHJcbi8vICsrKysrIEZvcm1zICsrKysrIC8vXHJcbi8vID09PSAnRWRpdCBwcm9maWxlJyBmb3JtID09PSAvL1xyXG4vLyAtLS0gRm9ybSBjcmVhdGlvbiBtZXRob2QgLS0tIC8vXHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybSA9IG5ldyBNb2RhbFdpdGhGb3JtKFwiLm1vZGFsX3R5cGVfZWRpdFwiLCAoKSA9PiB7XHJcbiAgdXNlckluZm9WYWx1ZXMuc2V0VXNlckluZm8oZWRpdFByb2ZpbGVGb3JtLmdldElucHV0VmFsdWVzKCkpO1xyXG4gIGVkaXRQcm9maWxlRm9ybS5jbG9zZSgpO1xyXG59KTtcclxuLy8gLS0tIFNldCBldmVudCBsaXN0ZW5lcnMgZm9yIHRoZSBmb3JtIC0tLSAvL1xyXG5lZGl0UHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuLy8gLS0tIFNldCB2YWx1ZXMgYW5kIG9wZW4gdGhlIGZvcm0gLS0tIC8vXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBlZGl0UHJvZmlsZUZvcm0uc2V0SW5wdXRWYWx1ZXModXNlckluZm9WYWx1ZXMuZ2V0VXNlckluZm8oKSlcclxuICBwcm9maWxlRm9ybVZhbGlkYXRpb24ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgZWRpdFByb2ZpbGVGb3JtLm9wZW4oKTtcclxufSk7XHJcbi8vID09PSAnQWRkIGNhcmQnIGZvcm0gPT09IC8vXHJcbi8vIC0tLSBGb3JtIGNyZWF0aW9uIG1ldGhvZCAtLS0gLy9cclxuY29uc3QgYWRkQ2FyZEZvcm0gPSBuZXcgTW9kYWxXaXRoRm9ybShcIi5tb2RhbF90eXBlX2FkZC1jYXJkXCIsICgpID0+IHtcclxuICBjb25zdCBuZXdDYXJkID0gYWRkQ2FyZEZvcm0uZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICBjYXJkc1NlY3Rpb24uYWRkSXRlbShnZW5lcmF0ZUNhcmQobmV3Q2FyZCkpO1xyXG4gIGFkZENhcmRGb3JtLmNsb3NlKCk7XHJcbn0pO1xyXG4vLyAtLS0gU2V0IGV2ZW50IGxpc3RlbmVycyBmb3IgJ2FkZCBjYXJkJyBtb2RhbCAtLS0gLy9cclxuYWRkQ2FyZEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vICsrKysrIFZhbGlkYXRpb24gKysrKysgLy9cclxuLy8gLS0tICdFZGl0IHByb2ZpbGUnIGZvcm0gdmFsaWRhdGlvbiBhZGRpbmcgLS0tIC8vXHJcbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIHByb2ZpbGVNb2RhbCk7XHJcbnByb2ZpbGVGb3JtVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbi8vIC0tLSAgLS0tIC8vXHJcbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgYXZhdGFyTW9kYWwpO1xyXG5hdmF0YXJGb3JtVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbi8vIC0tLSAnQWRkIGNhcmQnIGZvcm0gdmFsaWRhdGlvbiBhZGRpbmcgLS0tIC8vXHJcbmNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGFkZENhcmRNb2RhbCk7XHJcbmFkZENhcmRGb3JtVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5sZXQgdXNlcklkOyIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxXaXRoSW1hZ2UgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgLy8gLS0tIE9wZW4gYmlnIGltYWdlIG1vZGFsIG1ldGhvZCAtLS0gLy9cclxuICBvcGVudXAgPSAoZXZlbnQpID0+IHtcclxuICAgIGNvbnN0IGJpZ0ltYWdlID0gZXZlbnQudGFyZ2V0O1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2JpZy1pbWFnZVwiKS5zcmMgPSBiaWdJbWFnZS5zcmM7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYmlnLWltYWdlXCIpLmFsdCA9IGJpZ0ltYWdlLmFsdDtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1jYXB0aW9uXCIpLnRleHRDb250ZW50ID0gYmlnSW1hZ2UuYWx0O1xyXG5cclxuICAgIHRoaXMub3BlbigpO1xyXG4gIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcblxyXG4gIGNsZWFyICgpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5jbGVhcigpO1xyXG4gICAgXHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChjYXJkKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGNhcmQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcigge25hbWUsIGpvYiwgYXZhdGFyfSApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAke25hbWV9YCk7XHJcbiAgICB0aGlzLl9qb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAke2pvYn1gKTtcclxuICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCR7YXZhdGFyfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgbmFtZSA6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXHJcbiAgICBqb2IgOiB0aGlzLl9qb2IudGV4dENvbnRlbnQsXHJcbiAgICBhdmF0YXI6IHRoaXMuX2F2YXRhci5zcmNcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbygge25hbWUsIGpvYn0gKSB7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2pvYi50ZXh0Q29udGVudCA9IGpvYjtcclxuICB9XHJcblxyXG4gIHNldFVzZXJBdmF0YXIoIHthdmF0YXJ9ICkge1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkFwaSIsImNvbnN0cnVjdG9yIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ0aGlzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldFVzZXJJbmZvIiwiYWRkQ2FyZCIsIm5hbWUiLCJsaW5rIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZW1vdmVDYXJkIiwiY2FyZElEIiwiZ2V0QXBwSW5mbyIsImFsbCIsImFkZExpa2UiLCJjYXJkIiwiZ2V0SWQiLCJyZW1vdmVMaWtlIiwidXBkYXRlVXNlckluZm8iLCJhYm91dCIsInNldFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwiQ2FyZCIsImNhcmREYXRhIiwidXNlciIsIm9uQ2FyZENsaWNrIiwicmVtb3ZlSGFuZGxlciIsImxpa2VIYW5kbGVyIiwiY2FyZFNlbGVjdG9yIiwiX25hbWUiLCJfbGluayIsIl9jYXJkSWQiLCJfaWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX3VzZXJJRCIsIl9saWtlcyIsImxpa2VzIiwiX2NhcmRTZWxlY3RvciIsIl9vbkNhcmRDbGljayIsIl9saWtlSGFuZGxlciIsIl9yZW1vdmVIYW5kbGVyIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsImRlbGV0ZUNhcmQiLCJfaXRlbSIsInJlbW92ZSIsIl9yZW5kZXJMaWtlcyIsImlzTGlrZWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsImxlbmd0aCIsInNvbWUiLCJfdXNlcklkIiwidXBkYXRlTGlrZXMiLCJuZXdMaWtlcyIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsIl9saWtlQ2FyZCIsIl9jYXJkSW1hZ2UiLCJnZW5lcmF0ZUNhcmQiLCJfZWxlbWVudCIsInNyYyIsImFsdCIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtQ29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfZm9ybUNvbmZpZyIsIl9mb3JtRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yTWVzc2FnZUNsYXNzIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dHMiLCJmb3JFYWNoIiwiaW5wdXQiLCJfdG9nZ2xlU3VibWl0QnV0dG9uIiwiX2NoZWNrSW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfY2hlY2tJZkZvcm1WYWxpZCIsImV2ZXJ5IiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiYnV0dG9uRWxlbWVudCIsImRpc2FibGVkIiwiaW5wdXRTZWxlY3RvciIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJlZGl0QnV0dG9uIiwicHJvZmlsZU1vZGFsIiwiZm9ybXMiLCJwcm9maWxlIiwiYWRkQ2FyZE1vZGFsIiwiZWxlbWVudHMiLCJqb2IiLCJhZGRDYXJkRm9ybSIsInRpdGxlIiwiZm9ybVNlbGVjdG9yIiwiTW9kYWwiLCJtb2RhbFNlbGVjdG9yIiwiX21vZGFsRWxlbWVudCIsIl9jaGVja0ZvckVzY0Nsb3NlIiwia2V5IiwiY2xvc2UiLCJvcGVuIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJNb2RhbFdpdGhGb3JtIiwiaGFuZGxlU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlU3VibWl0QnRuIiwiZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dExpc3QiLCJpbnB1dFZhbHVlcyIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXMiLCJyZXNldCIsIk1vZGFsRGVsZXRlQ29uZmlybWF0aW9uIiwic2VsZWN0b3IiLCJfZm9ybSIsIl9zZWxlY3RvciIsIl9oYW5kbGVTdWJtaXQiLCJfaGFuZGxlU3VibWl0SGFuZGxlciIsImJpbmQiLCJfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMiLCJiaWdJbWFnZU1vZGFsIiwib3BlbnVwIiwiYmlnSW1hZ2UiLCJjYXJkc1NlY3Rpb24iLCJpdGVtcyIsInJlbmRlcmVyIiwiY29udGFpbmVyU2VsZWN0b3IiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiY2xlYXIiLCJpbm5lckhUTUwiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJkYXRhIiwidXNlcklkIiwiaGFuZGxlQ2FyZENsaWNrIiwiZXZ0IiwiaGFuZGxlRGVsZXRlQ2FyZCIsImNhcmRJZCIsInNldEFjdGlvbiIsImFwaSIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImhhbmRsZUxpa2VzIiwiY3JlYXRlQ2FyZCIsInVzZXJJbmZvVmFsdWVzIiwiX2pvYiIsIl9hdmF0YXIiLCJzZXRVc2VySW5mbyIsInNldEF2YXRhciIsImVkaXRQcm9maWxlRm9ybSIsInByb2ZpbGVGb3JtVmFsaWRhdGlvbiIsIm5ld0NhcmQiLCJhdmF0YXJNb2RhbCJdLCJzb3VyY2VSb290IjoiIn0=