!function(){"use strict";class e{constructor(e,t){this._formConfig=e,this._formElement=t,this.inputs=Array.from(this._formElement.querySelectorAll(this._formConfig.inputSelector)),this._buttonElement=this._formElement.querySelector(this._formConfig.submitButtonSelector)}_showInputError=(e,t)=>{const{inputErrorClass:s,errorMessageClass:r}=this._formConfig,i=this._formElement.querySelector(` #${e.id}_error `);i.textContent=t,i.classList.add(r),e.classList.add(s)};_hideInputError=e=>{const{inputErrorClass:t,errorMessageClass:s}=this._formConfig,r=this._formElement.querySelector(` #${e.id}_error `);r.textContent="",r.classList.remove(s),e.classList.remove(t)};_checkInput=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)};_checkIValid=()=>this.inputs.every((e=>e.validity.valid));_toggleSubmitButton(){this._checkIValid()?(this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._formConfig.inactiveButtonClass)):(this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._formConfig.inactiveButtonClass))}_setEventListeners=()=>(this.inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInput(e),this._toggleSubmitButton()}))})),this._formElement);enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleSubmitButton(),this.inputs.forEach((e=>{this._hideInputError(e)}))}}class t{constructor(e,t,s,r,i,n){this._name=e.name,this._link=e.link,this._ownerId=e.owner._id,this._cardId=e._id,this._likes=e.likes,this._userId=n,this._template=i,this._onCardClick=t,this._likeClickHandler=r,this._removeHandler=s}_getTemplate(){return this._template.content.querySelector(".card").cloneNode(!0)}_setAttributes(e,t){for(const s in t)e.setAttribute(s,t[s])}deleteCard(){this._userId===this._ownerId&&(this._card.remove(),this._card=null)}_handelLike(e){e.classList.toggle("card__like-button_active")}_likeStatus(){const e=this._cardElement.querySelector(".card__like-button");Array.from(this._likes).forEach((t=>{t._id===this._userId&&e.classList.add("card__like-button_active")}))}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._likeClickHandler(this)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._removeHandler(this)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._onCardClick(this._name,this._link)}))}getCardId(){return this._cardId}generateCard(e){return this._cardElement=this._getTemplate(),this._setEventListeners(),this._card=this._cardElement,this._setAttributes(this._cardElement.querySelector(".card__image"),{src:this._link,alt:this._name}),this._cardElement.querySelector(".card__title").textContent=this._name,this._ownerId!==e&&this._cardElement.querySelector(".card__delete-button").remove(),this._likeStatus(),this._cardElement.querySelector(".card__like-count").textContent=this._likes.length,this._cardElement}checkIfLiked(e){return this._likes.find((t=>t._id===e))?this._liked=!0:this._liked=!1,this._liked}_cardLiked(){this._cardElement.querySelector(".card__like-button").classList.add("card__like-button_active")}_cardUnliked(){this._cardElement.querySelector(".card__like-button").classList.remove("card__like-button_active")}refreshCard(e,t){this._likes=e.likes,this.checkIfLiked(t)?this._cardLiked():this._cardUnliked(),this._cardElement.querySelector(".card__like-count").textContent=this._likes.length}}class s{constructor(e,t){this._modalElement=document.querySelector(e),this._escapeKeyHandler=this._escapeKeyHandler.bind(this),this._checkKeyPress=t}open(){this._modalElement.classList.add("modal_visible"),document.addEventListener("keyup",this._escapeKeyHandler)}close(){this._modalElement.classList.remove("modal_visible"),document.removeEventListener("keyup",this._escapeKeyHandler)}_escapeKeyHandler(e){this._checkKeyPress(e.key)&&this.close()}setEventListeners(){this._modalElement.addEventListener("click",(e=>{e.target.classList.contains("modal__close-button")&&this.close(),e.target.classList.contains("modal_visible")&&this.close()}))}}class r extends s{constructor(e,t,s){super(e,t),this._handleSubmit=s,this._submitButton=this._modalElement.querySelector(".modal__submit-button"),this._form=this._modalElement.querySelector(".modal__container"),this._textInButton=this._submitButton.textContent}getInputValues(){this._inputList=this._modalElement.querySelectorAll(".modal__input");const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),this._entredValue||e}setInputValues(e){this._entredValue=e}setEventListeners(){this._modalElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitButton.textContent="Saving...",this._handleSubmit(this.getInputValues())})),super.setEventListeners()}close(){this._submitButton.textContent=this._textInButton,this._form.reset(),super.close()}}class i{constructor({items:e,renderer:t},s){this._renderedElements=e,this._renderer=t,this._container=document.querySelector(s)}renderItems(){this._renderedElements.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const n=document.querySelector(".profile__edit-button"),a=document.querySelector(".modal_type_edit"),o=document.querySelector(".profile__title"),l=document.querySelector(".modal__input_type_title"),d=document.querySelector(".profile__subtitle"),_=document.querySelector(".modal__input_type_subtitle"),c=(document.querySelector(".modal__close-button_type_edit"),document.querySelector(".profile__image")),h=document.querySelector(".profile__image-overlay"),u=document.querySelector(".modal_type_avatar"),m=(u.querySelector(".modal__input_type_avatar"),document.querySelector(".modal__close-button_type_avatar"),document.querySelector(".profile__add-button")),p=document.querySelector(".modal_type_add-card"),b=(document.querySelector(".modal__input_type_name"),document.querySelector(".modal__input_type_link"),document.querySelector(".modal__close-button_type_add-card"),document.forms.add),y=(b.elements.title,b.elements.link,document.querySelector(".modal__submit-button"),document.querySelector(".cards__grid"),document.querySelector("#card__template")),E=document.querySelector(".modal_type_big-image"),v=E.querySelector(".modal__big-image"),k=E.querySelector(".modal__image-caption"),f=(document.querySelector(".modal__close-button_type_big-image"),document.querySelector(".modal_type_delete-card"),{formSelector:".modal__container",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_error",errorMessageClass:"modal__error_visible"}),g=e=>"Escape"===e;new e(f,a).enableValidation(),new e(f,u).enableValidation();const S=new e(f,p);S.enableValidation();const C=e=>console.log(e),I=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_response(e){return e.ok?e.json():Promise.reject(`Error: ${e.status} - ${e.statusText}`)}getCardList(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._response)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._response)}setUserInfo(e,t){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers,method:"PATCH",body:JSON.stringify(e,t)}).then(this._response)}addCard(e){return fetch(`${this._baseUrl}/cards`,{headers:this._headers,method:"POST",body:JSON.stringify(e)}).then(this._response)}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{headers:this._headers,method:"DELETE"}).then(this._response)}likeCard(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{headers:this._headers,method:"PUT"}).then(this._response)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{headers:this._headers,method:"DELETE"}).then(this._response)}setUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{headers:this._headers,method:"PATCH",body:JSON.stringify(e)}).then(this._response)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"709a0d9d-db06-4890-a594-b07e7309a353","Content-Type":"application/json"}}),L=new class{constructor(e,t,s){this._nameElement=e,this._titleElement=t,this._pictureElement=s}getUserInfo(){return{name:this._name,job:this._job,id:this._id,avatar:this._avatar}}getUserData(){return this._data}setUserInfo(e){this._name=e.name,this._job=e.about,this._avatar=e.avatar,this._nameElement.textContent=this._name,this._titleElement.textContent=this._job,this._pictureElement.setAttribute("src",this._avatar)}setUserAvatar(e){this._avatar=e,this._pictureElement.setAttribute("src",this._avatar)}}(o,d,c);let q;I.getUserInfo().then((e=>(L.setUserInfo(e),q=e._id,L))).then((()=>{I.getCardList().then((e=>{const s=(e,t)=>{x.open(e,t)},n=e=>{A.setInputValues(e),A.open()},a=e=>{e.checkIfLiked(q)?I.unlikeCard(e.getCardId()).then((t=>{e.refreshCard(t,q)})).catch(C):I.likeCard(e.getCardId()).then((t=>{e.refreshCard(t,q)})).catch(C)},o=e=>new t(e,s,n,a,y,q),l=new i({items:e,renderer:e=>{const t=o(e);l.addItem(t.generateCard(q))}},".cards__grid");l.renderItems();const d=new r(".modal_type_add-card",g,(({titleInput:e,linkInput:t})=>{I.addCard({name:e,link:t}).then((e=>{const t=o(e);l.addItem(t.generateCard(q)),d.close(),S.resetValidation()})).catch(C)}));d.setEventListeners(),m.addEventListener("click",(()=>{d.open()}))})).catch(C)})).catch(C);const U=new r(".modal_type_edit",g,(({nameInput:e,jobInput:t})=>{I.setUserInfo({name:e,about:t}).then((e=>{L.setUserInfo(e),U.close()})).catch(C)}));U.setEventListeners(),n.addEventListener("click",(()=>{const e=L.getUserInfo();l.value=e.name,_.value=e.job,U.open()}));const w=new r(".modal_type_avatar",g,(({avatarLinkInput:e})=>{I.setUserAvatar({avatar:e}).then((()=>{L.setUserAvatar(e),w.close()})).catch(C)}));w.setEventListeners(),h.addEventListener("click",(()=>{w.open()}));const A=new r(".modal_type_delete-card",g,(e=>{I.removeCard(e.getCardId()).then((()=>{e.deleteCard(),A.close()})).catch(C)}));A.setEventListeners();const x=new class extends s{constructor(e,t){super(e,t),this._modalImage=this._modalElement.querySelector(".modal__big-image"),this._modalTitle=this._modalElement.querySelector(".modal__image-caption")}open(e,t){this._modalTitle.textContent=e,this._modalImage.setAttribute("src",t),this._modalImage.setAttribute("alt",e),super.open()}}(".modal_type_big-image",g,v,k);x.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RixFQUFTckIsTUFBUW9HLEVBQVNuQixJQUMxQmtCLEVBQWlCcEgsVUFHbkIsTUFBTXNILEVBQWtCLElBQUloSCxFRDVJTyxxQkM4SWpDK0MsR0FDQSxFQUFHa0UsZ0JBQWdCOUIsTUFFakI5QixFQUNHNkIsY0FBYyxDQUFDQyxPQUFBQSxJQUNmZCxNQUFLLEtBQ0pnQixFQUFRSCxjQUFjQyxHQUN0QjZCLEVBQWdCckgsV0FFakIwRyxNQUFNcEQsTUFHYitELEVBQWdCbkgsb0JBRWhCcUMsRUFBaUJ4RyxpQkFBaUIsU0FBUyxLQUN6Q3NMLEVBQWdCdEgsVUFJbEIsTUFBTXlHLEVBQWtCLElBQUluRyxFRC9KTSwwQkNpS2hDK0MsR0FDQ3FELElBQ0MvQyxFQUNHeUIsV0FBV3NCLEVBQUsvSCxhQUNoQmdHLE1BQUssS0FDSitCLEVBQUt2SSxhQUNMc0ksRUFBZ0J4RyxXQUVqQjBHLE1BQU1wRCxNQUdia0QsRUFBZ0J0RyxvQkFFaEIsTUFBTThDLEVBQWdCLElHbk5QLGNBQTZCekQsRUFDMUM5RixZQUFhOE4sRUFBTzlILEdBQ2xCZSxNQUFPK0csRUFBTzlILEdBQ2Q3RixLQUFLNE4sWUFBYzVOLEtBQUs4RixjQUFjckYsY0FBYyxxQkFDcERULEtBQUs2TixZQUFjN04sS0FBSzhGLGNBQWNyRixjQUFjLHlCQUd0RDBGLEtBQUtuRCxFQUFNRSxHQUNUbEQsS0FBSzZOLFlBQVkzTSxZQUFjOEIsRUFDL0JoRCxLQUFLNE4sWUFBWXZKLGFBQWEsTUFBT25CLEdBQ3JDbEQsS0FBSzROLFlBQVl2SixhQUFhLE1BQU9yQixHQUVyQzRELE1BQU1ULFNKMEJzQix3QkMrSzlCcUQsRUFDQUgsRUFDQUMsR0FFRkYsRUFBYzlDLG9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvSW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGZvcm1Db25maWcsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9mb3JtQ29uZmlnID0gZm9ybUNvbmZpZztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLmlucHV0cyA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9mb3JtQ29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2Zvcm1Db25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSA9PiB7XHJcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JNZXNzYWdlQ2xhc3MgfSA9IHRoaXMuX2Zvcm1Db25maWc7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAgIyR7aW5wdXRFbGVtZW50LmlkfV9lcnJvciBgKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGVycm9yTWVzc2FnZUNsYXNzKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuICBcclxuICBfaGlkZUlucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JNZXNzYWdlQ2xhc3MgfSA9IHRoaXMuX2Zvcm1Db25maWc7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAgIyR7aW5wdXRFbGVtZW50LmlkfV9lcnJvciBgKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShlcnJvck1lc3NhZ2VDbGFzcyk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShpbnB1dEVycm9yQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIF9jaGVja0lucHV0ID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9jaGVja0lWYWxpZCA9ICgpID0+IHRoaXMuaW5wdXRzLmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG5cclxuICBfdG9nZ2xlU3VibWl0QnV0dG9uKCkge1xyXG4gICAgaWYgKHRoaXMuX2NoZWNrSVZhbGlkKCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZm9ybUNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH0gXHJcbiAgICBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9mb3JtQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgdGhpcy5pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0KGlucHV0KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVTdWJtaXRCdXR0b24oKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLl9mb3JtRWxlbWVudDtcclxuICB9O1xyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZVN1Ym1pdEJ1dHRvbigpO1xyXG5cclxuICAgIHRoaXMuaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KTtcclxuICAgIH0pXHJcbiAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoIFxyXG4gICAgZGF0YSwgXHJcbiAgICBvbkNhcmRDbGljaywgXHJcbiAgICByZW1vdmVIYW5kbGVyLCBcclxuICAgIGxpa2VDbGlja0hhbmRsZXIsXHJcbiAgICB0ZW1wbGF0ZSwgXHJcbiAgICB1c2VySWQgKSBcclxuICB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX2NhcmRJZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG5cclxuICAgIHRoaXMuX3RlbXBsYXRlID0gdGVtcGxhdGU7XHJcbiAgICB0aGlzLl9vbkNhcmRDbGljayA9IG9uQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5fbGlrZUNsaWNrSGFuZGxlciA9IGxpa2VDbGlja0hhbmRsZXI7XHJcbiAgICB0aGlzLl9yZW1vdmVIYW5kbGVyID0gcmVtb3ZlSGFuZGxlcjtcclxuICB9XHJcbiAgLy8gLS0tIEdldCBjYXJkIHRlbXBsYXRlIC0tLSAvL1xyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gdGhpcy5fdGVtcGxhdGVcclxuICAgIC5jb250ZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcignLmNhcmQnKVxyXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2V0QXR0cmlidXRlcyhjYXJkRWxlbWVudCwgYXR0cmlicykge1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cmlicykge1xyXG4gICAgICBjYXJkRWxlbWVudC5zZXRBdHRyaWJ1dGUoa2V5LCBhdHRyaWJzW2tleV0pO1xyXG4gICAgfVxyXG4gIH1cclxuICAvLyAtLS0gQ2FyZCBkZWxldGluZyBtZXRob2QgLS0tIC8vXHJcbiAgZGVsZXRlQ2FyZCgpIHtcclxuICAgIGlmKHRoaXMuX3VzZXJJZCA9PT0gdGhpcy5fb3duZXJJZCl7XHJcbiAgICAgIHRoaXMuX2NhcmQucmVtb3ZlKCk7XHJcbiAgICAgIHRoaXMuX2NhcmQgPSBudWxsO1xyXG4gICAgfVxyXG4gIH1cclxuICAvLyAtLS0gTGlrZSBoYW5kbGVyIC0tLSAvL1xyXG4gIF9oYW5kZWxMaWtlKGxpa2VCdG4pIHtcclxuICAgIGxpa2VCdG4uY2xhc3NMaXN0LnRvZ2dsZSgnY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlJylcclxuICB9XHJcbiAgLy8gLS0tIENoZWNrIGZvciBhbGwgY2FyZHMgaWYgbGlrZWQgb3Igbm90IC0tLSAvL1xyXG4gIF9saWtlU3RhdHVzKCkge1xyXG4gICAgY29uc3QgbGlrZUJ0biA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ1dHRvbicpO1xyXG4gICAgY29uc3QgbGlrZXMgPSBBcnJheS5mcm9tKHRoaXMuX2xpa2VzKTtcclxuICAgIGxpa2VzLmZvckVhY2goKGVsZW1lbnQpID0+IHtcclxuICAgICAgaWYoZWxlbWVudC5faWQgPT09IHRoaXMuX3VzZXJJZCl7XHJcbiAgICAgICAgbGlrZUJ0bi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbiAgLy8gLS0tIFNldCBldmVudHMgbGlzdGVuZXJzIGZvciB0aGUgY2FyZHMgdGhhdCB3aWxsIGJlIGNyZWF0ZWQhIC0tLSAvL1xyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9saWtlQ2xpY2tIYW5kbGVyKHRoaXMpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9yZW1vdmVIYW5kbGVyKHRoaXMpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJylcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fb25DYXJkQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q2FyZElkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRJZDtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBDcmVhdGluZyB0aGUgY2FyZCBhbmQgY2FyZCBlbGVtZW50cyAtLS0gLy9cclxuICBnZW5lcmF0ZUNhcmQodXNlcklkKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fY2FyZCA9IHRoaXMuX2NhcmRFbGVtZW50O1xyXG5cclxuICAgIHRoaXMuX3NldEF0dHJpYnV0ZXModGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpLCB7XHJcbiAgICAgICAgc3JjOiB0aGlzLl9saW5rLFxyXG4gICAgICAgIGFsdDogdGhpcy5fbmFtZVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJykudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIGlmKHRoaXMuX293bmVySWQgIT09IHVzZXJJZCkge1xyXG4gICAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ1dHRvbicpLnJlbW92ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX2xpa2VTdGF0dXMoKTtcclxuICAgIC8vIC0tLSBTaG93IGxpa2UgY291bnQgLS0tIC8vXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtY291bnQnKS50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBjaGVja0lmTGlrZWQodXNlcikge1xyXG4gICAgaWYodGhpcy5fbGlrZXMuZmluZCgobGlrZSkgPT4gbGlrZS5faWQgPT09IHVzZXIpKSB7XHJcbiAgICAgIHRoaXMuX2xpa2VkID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGVsc2V7XHJcbiAgICAgIHRoaXMuX2xpa2VkID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VkO1xyXG4gIH1cclxuXHJcbiAgX2NhcmRMaWtlZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKVxyXG4gICAgICAuY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIF9jYXJkVW5saWtlZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKVxyXG4gICAgICAuY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIHJlZnJlc2hDYXJkKGRhdGEsIHVzZXJJZCkge1xyXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgaWYodGhpcy5jaGVja0lmTGlrZWQodXNlcklkKSkge1xyXG4gICAgICB0aGlzLl9jYXJkTGlrZWQoKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICB0aGlzLl9jYXJkVW5saWtlZCgpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50JylcclxuICAgICAgLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbCB7XHJcbiAgY29uc3RydWN0b3IoIG1vZGFsU2VsZWN0b3IsIGNoZWNrS2V5UHJlc3MgKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG1vZGFsU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fZXNjYXBlS2V5SGFuZGxlciA9IHRoaXMuX2VzY2FwZUtleUhhbmRsZXIuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2NoZWNrS2V5UHJlc3MgPSBjaGVja0tleVByZXNzO1xyXG4gIH1cclxuICAvLyAtLS0gT3BlbiBtb2RhbCBtZXRob2QgLS0tIC8vIFxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX3Zpc2libGVcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5fZXNjYXBlS2V5SGFuZGxlcik7XHJcbiAgfVxyXG4gIC8vIC0tLSBDbG9zZSBtb2RhbCBtZXRob2QgLS0tIC8vXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX3Zpc2libGVcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5fZXNjYXBlS2V5SGFuZGxlcik7XHJcbiAgfVxyXG4gIC8vIC0tLSBDbG9zZSBtb2RhbCBvbiBFU0MgbWV0aG9kIC0tLSAvL1xyXG4gIF9lc2NhcGVLZXlIYW5kbGVyKGV2ZW50KSB7XHJcbiAgICBpZiAodGhpcy5fY2hlY2tLZXlQcmVzcyhldmVudC5rZXkpKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50XHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgLy8gLS0tIENsb3NlIG1vZGFsIG9uIGNsb3NlKCdYJykgYnV0dG9uIC0tLSAvL1xyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fY2xvc2UtYnV0dG9uJykpIHtcclxuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gLS0tIENsb3NlIG1vZGFsIG9uIG92ZXJsYXkob3V0IG9mIHRoZSBtb2RhbCkgY2xpY2sgLS0tIC8vL1xyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF92aXNpYmxlJykpIHtcclxuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59IiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhGb3JtIGV4dGVuZHMgTW9kYWwge1xyXG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yLCBjaGVja0tleVByZXNzLCBoYW5kbGVTdWJtaXQgKSB7XHJcbiAgICBzdXBlcihzZWxlY3RvciwgY2hlY2tLZXlQcmVzcyk7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBoYW5kbGVTdWJtaXQ7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19zdWJtaXQtYnV0dG9uJyk7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY29udGFpbmVyJyk7XHJcbiAgICB0aGlzLl90ZXh0SW5CdXR0b24gPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBnZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubW9kYWxfX2lucHV0Jyk7XHJcbiAgICBjb25zdCBmb3JtSW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdFxyXG4gICAgICAuZm9yRWFjaCgoaW5wdXQpID0+IHsgZm9ybUlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWUgfVxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZW50cmVkVmFsdWUgfHwgZm9ybUlucHV0VmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0SW5wdXRWYWx1ZXMoZW50cmVkVmFsdWUpIHtcclxuICAgIHRoaXMuX2VudHJlZFZhbHVlID0gZW50cmVkVmFsdWU7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAvLyAtLS0gVVggZm9yIG1vZGFscyAtLS0gLy9cclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KVxyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fdGV4dEluQnV0dG9uO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZWRFbGVtZW50cyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlZEVsZW1lbnRzLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSlcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShpdGVtKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcclxuICB9XHJcbn1cclxuIiwiLy8gLS0tICdFZGl0IHByb2ZpbGUnIG1vZGFsIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2VkaXQnKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3RpdGxlJyk7XHJcbmV4cG9ydCBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lucHV0X3R5cGVfdGl0bGUnKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fc3VidGl0bGUnKTtcclxuZXhwb3J0IGNvbnN0IGpvYklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX3N1YnRpdGxlJyk7XHJcbmV4cG9ydCBjb25zdCBlZGl0Q2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX2VkaXQnKTtcclxuLy8gLS0tICdBdmF0YXJcIiBtb2RhbCBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCB1c2VyQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlJyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlLW92ZXJsYXknKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfYXZhdGFyJyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJNb2RhbElucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX2F2YXRhcicpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX2F2YXRhcicpXHJcbi8vIC0tLSAnQWRkLWNhcmQnIG1vZGFsIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfYWRkLWNhcmQnKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRJbnB1dFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX25hbWUnKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRJbnB1dExpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lucHV0X3R5cGVfbGluaycpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9hZGQtY2FyZCcpO1xyXG4vLyAtLS0gJ0FkZC1DYXJkJyBmb3JtIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXMuYWRkO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm1UaXRlbCA9IGFkZENhcmRGb3JtLmVsZW1lbnRzLnRpdGxlO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm1MaW5rID0gYWRkQ2FyZEZvcm0uZWxlbWVudHMubGluaztcclxuLy8gLS0tIEdlbmVyYWwgY29uc3QgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3N1Ym1pdC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRzX19ncmlkJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZF9fdGVtcGxhdGUnKTtcclxuLy8gLS0tIEJpZyBpbWFnZSBtb2RhbCBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBiaWdJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfYmlnLWltYWdlJyk7XHJcbmV4cG9ydCBjb25zdCBiaWdJbWFnZSA9IGJpZ0ltYWdlTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19iaWctaW1hZ2UnKTtcclxuZXhwb3J0IGNvbnN0IGJpZ0ltYWdlVGl0bGUgPSBiaWdJbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW1hZ2UtY2FwdGlvbicpO1xyXG5leHBvcnQgY29uc3QgY2FyZEJpZ01vZGFsQ2xvc2VJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9iaWctaW1hZ2UnKTtcclxuLy8gLS0tICdEZWxldGUgY2FyZCcgbW9kYWwgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2RlbGV0ZS1jYXJkJyk7XHJcbi8vIC0tLSBTZWxlY3RvcnMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlTW9kYWxTZWxlY3RvciA9ICcubW9kYWxfdHlwZV9lZGl0JztcclxuZXhwb3J0IGNvbnN0IGF2YXRhck1vZGFsU2VsZWN0b3IgPSAnLm1vZGFsX3R5cGVfYXZhdGFyJztcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbFNlbGVjdG9yID0gJy5tb2RhbF90eXBlX2FkZC1jYXJkJztcclxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmRTZWxlY3RvciA9ICcubW9kYWxfdHlwZV9kZWxldGUtY2FyZCc7XHJcbmV4cG9ydCBjb25zdCBiaWdJbWFnZVNlbGVjdG9yID0gJy5tb2RhbF90eXBlX2JpZy1pbWFnZSc7XHJcbmV4cG9ydCBjb25zdCBjYXJkTGlzdFNlbGVjdG9yID0gJy5jYXJkc19fZ3JpZCdcclxuLy8gLS0tIEZvcm0gY29uZmlnIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGZvcm1Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fY29udGFpbmVyXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfZXJyb3JcIixcclxuICBlcnJvck1lc3NhZ2VDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiXHJcbn07XHJcbi8vIC0tLSBBUEkgY29uc3QgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBhcGlDb25maWcgPSB7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgaGVhZGVyczogXHJcbiAge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI3MDlhMGQ5ZC1kYjA2LTQ4OTAtYTU5NC1iMDdlNzMwOWEzNTNcIixcclxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgXHJcbiAgfSxcclxufTsiLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBNb2RhbFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBNb2RhbFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvQXBpLmpzXCJcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgcHJvZmlsZU5hbWUsXHJcbiAgcHJvZmlsZUpvYixcclxuICBlZGl0QnV0dG9uLFxyXG4gIGNhcmRMaXN0U2VsZWN0b3IsXHJcbiAgcHJvZmlsZU1vZGFsLFxyXG4gIHByb2ZpbGVNb2RhbFNlbGVjdG9yLFxyXG4gIGNhcmRUZW1wbGF0ZSxcclxuICBhZGRDYXJkQnV0dG9uLFxyXG4gIGFkZENhcmRNb2RhbCxcclxuICBhZGRDYXJkTW9kYWxTZWxlY3RvcixcclxuICBhdmF0YXJNb2RhbCxcclxuICBhdmF0YXJNb2RhbFNlbGVjdG9yLFxyXG4gIHVzZXJBdmF0YXIsXHJcbiAgYXZhdGFyRWRpdEJ1dHRvbixcclxuICBiaWdJbWFnZVNlbGVjdG9yLFxyXG4gIGJpZ0ltYWdlLFxyXG4gIGJpZ0ltYWdlVGl0bGUsXHJcbiAgZGVsZXRlQ2FyZFNlbGVjdG9yLFxyXG4gIGFwaUNvbmZpZyxcclxuICBmb3JtQ29uZmlnLFxyXG4gIG5hbWVJbnB1dCxcclxuICBqb2JJbnB1dFxyXG59IGZyb20gXCIuLi9jb21wb25lbnRzL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuLy8gPT09PT0gTW9kYWxzID09PT09IC8vXHJcbi8vIC0tLSAnRXNjJyBjaGVjayAtLS0gLy9cclxuY29uc3QgY2hlY2tGb3JFc2NQcmVzc2VkID0gKGtleSkgPT4ga2V5ID09PSBcIkVzY2FwZVwiO1xyXG5cclxuLy8gPT09PT0gVmFsaWRhdGlvbiA9PT09PSAvL1xyXG4vLyAtLS0gJ0VkaXQgcHJvZmlsZScgZm9ybSB2YWxpZGF0aW9uIC0tLSAvL1xyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBwcm9maWxlTW9kYWwpO1xyXG5wcm9maWxlRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4vLyAtLS0gJ0F2YXRhcicgZm9ybSB2YWxpZGF0aW9uIC0tLSAvL1xyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGF2YXRhck1vZGFsKTtcclxuYXZhdGFyRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4vLyAtLS0gJ0FkZCBjYXJkJyBmb3JtIHZhbGlkYXRpb24gLS0tIC8vXHJcbmNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGFkZENhcmRNb2RhbCk7XHJcbmFkZENhcmRGb3JtVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vLyA9PT09PSBBUEkgJiBDYXJkID09PT09IC8vXHJcbi8vIC0tLSBBUEkgZXJyb3IgaGFuZGxlciAtLS0gLy8gXHJcbmNvbnN0IGhhbmRsZUFwaUVyciA9IChlcnIpID0+IGNvbnNvbGUubG9nKGVycik7XHJcbi8vIC0tLSBTZXR0aW5nIHRoZSBkZWZhdWx0IGZldGNoaW5nIG1ldGhvZCAtLS0gLy9cclxuY29uc3QgYXBpID0gbmV3IEFwaShhcGlDb25maWcpO1xyXG4vLyAtLS0gU2V0IHdoYXQgJ3Byb2ZpbGUnIHdpbGwgY29udGFpbnMgLS0tIC8vXHJcbmNvbnN0IHByb2ZpbGUgPSBuZXcgVXNlckluZm8oXHJcbiAgcHJvZmlsZU5hbWUsIFxyXG4gIHByb2ZpbGVKb2IsXHJcbiAgdXNlckF2YXRhclxyXG4pO1xyXG5sZXQgdXNlcklEO1xyXG5hcGlcclxuICAvLyAtLS0gR2V0IHVzZXIgaW5mbyBtZXRob2QgLS0tIC8vXHJcbiAgLmdldFVzZXJJbmZvKClcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICBwcm9maWxlLnNldFVzZXJJbmZvKHJlcyk7XHJcbiAgICB1c2VySUQgPSByZXMuX2lkO1xyXG4gICAgcmV0dXJuIHByb2ZpbGU7XHJcbiAgfSlcclxuICAvLyAtLS0gVXNlIHVzZXIgaW5mbyBmb3IgY3JlYXRpb24gb2YgbmV3IGNhcmRzIGFuZCBjYXJkIHNlY3Rpb24gLS0tIC8vIFxyXG4gIC50aGVuKCgpID0+IHtcclxuICAgIGFwaVxyXG4gICAgICAuZ2V0Q2FyZExpc3QoKVxyXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIC8vIC0tLSBPbiBjYXJkIGNsaWNrIGhhbmRsZXIgLS0tIC8vXHJcbiAgICAgICAgY29uc3Qgb25DYXJkQ2xpY2sgPSAobmFtZSwgbGluaykgPT4ge1xyXG4gICAgICAgICAgYmlnSW1hZ2VNb2RhbC5vcGVuKG5hbWUsIGxpbmspO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyAtLS0gRGVsZXRlIGNhcmQgYnV0dG9uIGhhbmRsZXIgLS0tIC8vXHJcbiAgICAgICAgY29uc3QgZGVsZXRlQ2FyZEhhbmRsZXIgPSAoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLnNldElucHV0VmFsdWVzKGRhdGEpO1xyXG4gICAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLm9wZW4oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gLS0tIExpa2UgYnV0dG9uIGNsaWNrIGhhbmRsZXIgLS0tIC8vXHJcbiAgICAgICAgY29uc3QgbGlrZUNsaWNrSGFuZGxlciA9IChjYXJkKSA9PiB7XHJcbiAgICAgICAgICBpZiAoY2FyZC5jaGVja0lmTGlrZWQodXNlcklEKSkge1xyXG4gICAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgICAudW5saWtlQ2FyZChjYXJkLmdldENhcmRJZCgpKVxyXG4gICAgICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjYXJkLnJlZnJlc2hDYXJkKGRhdGEsIHVzZXJJRCk7XHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAuY2F0Y2goaGFuZGxlQXBpRXJyKTtcclxuICAgICAgICAgIH0gXHJcbiAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgICAgLmxpa2VDYXJkKGNhcmQuZ2V0Q2FyZElkKCkpXHJcbiAgICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgIGNhcmQucmVmcmVzaENhcmQoZGF0YSwgdXNlcklEKTtcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIC5jYXRjaChoYW5kbGVBcGlFcnIpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyAtLS0gTmV3IGNhcmQgaW5zdGFuY2UgYWRkaW5nIC0tLSAvL1xyXG4gICAgICAgIGNvbnN0IGNyZWF0ZU5ld0NhcmRJbnN0YW5jZSA9IChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgY2FyZEluc3RhbmNlID0gbmV3IENhcmQoXHJcbiAgICAgICAgICAgIGNhcmREYXRhLFxyXG4gICAgICAgICAgICBvbkNhcmRDbGljayxcclxuICAgICAgICAgICAgZGVsZXRlQ2FyZEhhbmRsZXIsXHJcbiAgICAgICAgICAgIGxpa2VDbGlja0hhbmRsZXIsXHJcbiAgICAgICAgICAgIGNhcmRUZW1wbGF0ZSxcclxuICAgICAgICAgICAgdXNlcklEXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgcmV0dXJuIGNhcmRJbnN0YW5jZTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBpdGVtczogZGF0YSxcclxuICAgICAgICAgICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc3QgY2FyZEluc3RhbmNlID0gY3JlYXRlTmV3Q2FyZEluc3RhbmNlKGl0ZW0pO1xyXG4gICAgICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEluc3RhbmNlLmdlbmVyYXRlQ2FyZCh1c2VySUQpKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjYXJkTGlzdFNlbGVjdG9yXHJcbiAgICAgICAgKTtcclxuICAgICAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG5cclxuICAgICAgICBjb25zdCBhZGROZXdDYXJkTW9kYWwgPSBuZXcgTW9kYWxXaXRoRm9ybShcclxuICAgICAgICAgIGFkZENhcmRNb2RhbFNlbGVjdG9yLFxyXG4gICAgICAgICAgY2hlY2tGb3JFc2NQcmVzc2VkLFxyXG4gICAgICAgICAgKHsgdGl0bGVJbnB1dDogbmFtZSwgbGlua0lucHV0OiBsaW5rIH0pID0+IHtcclxuICAgICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgICAgLmFkZENhcmQoeyBuYW1lLCBsaW5rIH0pXHJcbiAgICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFkZE5ld0NhcmRJbnN0YW5jZSA9IGNyZWF0ZU5ld0NhcmRJbnN0YW5jZShkYXRhKTtcclxuICAgICAgICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oXHJcbiAgICAgICAgICAgICAgICAgIGFkZE5ld0NhcmRJbnN0YW5jZS5nZW5lcmF0ZUNhcmQodXNlcklEKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGFkZE5ld0NhcmRNb2RhbC5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgYWRkQ2FyZEZvcm1WYWxpZGF0aW9uLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgLmNhdGNoKGhhbmRsZUFwaUVycik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgICAgICBhZGROZXdDYXJkTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgICBhZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICBhZGROZXdDYXJkTW9kYWwub3BlbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KVxyXG4gICAgLmNhdGNoKGhhbmRsZUFwaUVycik7XHJcbn0pXHJcbi5jYXRjaChoYW5kbGVBcGlFcnIpO1xyXG5cclxuLy8gPT09PT0gJ0VkaXQnIHByb2ZpbGUgPT09PT0gLy9cclxuLy8gLS0tIEVkaXQgcHJvZmlsZSBtb2RhbCAtLS0gLy9cclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IG5ldyBNb2RhbFdpdGhGb3JtIChcclxuICBwcm9maWxlTW9kYWxTZWxlY3RvcixcclxuICBjaGVja0ZvckVzY1ByZXNzZWQsXHJcbiAgKHtuYW1lSW5wdXQ6IG5hbWUsIGpvYklucHV0OmFib3V0fSkgPT4gXHJcbiAge1xyXG4gICAgYXBpXHJcbiAgICAgIC5zZXRVc2VySW5mbyh7bmFtZSxhYm91dH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBwcm9maWxlLnNldFVzZXJJbmZvKHJlcyk7XHJcbiAgICAgICAgZWRpdFByb2ZpbGVNb2RhbC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goaGFuZGxlQXBpRXJyKTtcclxuICB9XHJcbilcclxuZWRpdFByb2ZpbGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4vLyAtLS0gRWRpdCBidXR0b24gaGFuZGxlciAtLS0gLy8gXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIgLCAoKSA9PiB7XHJcbiAgY29uc3QgdXNlckRhdGEgPSBwcm9maWxlLmdldFVzZXJJbmZvKCk7XHJcbiAgbmFtZUlucHV0LnZhbHVlID0gdXNlckRhdGEubmFtZTtcclxuICBqb2JJbnB1dC52YWx1ZSA9IHVzZXJEYXRhLmpvYjtcclxuICBlZGl0UHJvZmlsZU1vZGFsLm9wZW4oKTtcclxufSk7XHJcbi8vIC0tLSBBdmF0YXIgZWRpdCBtb2RhbCAtLS0gLy9cclxuY29uc3QgYXZhdGFyRWRpdE1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0gKFxyXG4gIGF2YXRhck1vZGFsU2VsZWN0b3IsXHJcbiAgY2hlY2tGb3JFc2NQcmVzc2VkLFxyXG4gICh7IGF2YXRhckxpbmtJbnB1dDphdmF0YXIgfSkgPT4gXHJcbiAge1xyXG4gICAgYXBpXHJcbiAgICAgIC5zZXRVc2VyQXZhdGFyKHthdmF0YXJ9KVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgcHJvZmlsZS5zZXRVc2VyQXZhdGFyKGF2YXRhcik7XHJcbiAgICAgICAgYXZhdGFyRWRpdE1vZGFsLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChoYW5kbGVBcGlFcnIpXHJcbiAgfVxyXG4pO1xyXG5hdmF0YXJFZGl0TW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuLy8gLS0tIEF2YXRhciBlZGl0IGJ1dHRvbiAtLS0gLy9cclxuYXZhdGFyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGF2YXRhckVkaXRNb2RhbC5vcGVuKCk7XHJcbn0pXHJcblxyXG4vLyAtLS0gRGVsZXRlIGNhcmQgbW9kYWwgaW5zdGFuY2UgYW5kIGV2ZW50cyAtLS0gLy9cclxuY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oXHJcbiAgZGVsZXRlQ2FyZFNlbGVjdG9yLFxyXG4gIGNoZWNrRm9yRXNjUHJlc3NlZCxcclxuICAoY2FyZCkgPT4ge1xyXG4gICAgYXBpXHJcbiAgICAgIC5yZW1vdmVDYXJkKGNhcmQuZ2V0Q2FyZElkKCkpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcclxuICAgICAgICBkZWxldGVDYXJkTW9kYWwuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGhhbmRsZUFwaUVycilcclxuICB9XHJcbik7XHJcbmRlbGV0ZUNhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4vLyAtLS0gQmlnIGltYWdlIG1vZGFsIGluc3RhbmNlIC0tLSAvL1xyXG5jb25zdCBiaWdJbWFnZU1vZGFsID0gbmV3IE1vZGFsV2l0aEltYWdlKFxyXG4gIGJpZ0ltYWdlU2VsZWN0b3IsXHJcbiAgY2hlY2tGb3JFc2NQcmVzc2VkLFxyXG4gIGJpZ0ltYWdlLFxyXG4gIGJpZ0ltYWdlVGl0bGVcclxuKTtcclxuYmlnSW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZykge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGNvbmZpZy5iYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzO1xyXG4gIH1cclxuICAvLyAtLS0gR2xvYmFsIEFQSSByZXNwb25zZSBtZXRob2QgLS0tIC8vXHJcbiAgX3Jlc3BvbnNlKHJlcykge1xyXG4gICAgcmV0dXJuIHJlcy5va1xyXG4gICAgPyByZXMuanNvbigpXHJcbiAgICA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfSAtICR7cmVzLnN0YXR1c1RleHR9YCk7XHJcbiAgfVxyXG4gIC8vIC0tLSBHZXQgY2FyZCBsaXN0IGZyb20gdGhlIHNlcnZlciAtLS0gLy9cclxuICBnZXRDYXJkTGlzdCgpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fcmVzcG9uc2UpXHJcbiAgICApO1xyXG4gIH1cclxuICAvLyAtLS0gR2V0IHVzZXIgaW5mbyBmcm9tIHRoZSBzZXJ2ZXIgLS0tIC8vXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9yZXNwb25zZSlcclxuICB9XHJcbiAgLy8gLS0tIFVwZGF0aW5nL0VkaXRpbmcgdXNlciBwcm9maWxlIGluZm8gLS0tIC8vXHJcbiAgc2V0VXNlckluZm8obmFtZSwgYWJvdXQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KFxyXG4gICAgICAgIG5hbWUsIFxyXG4gICAgICAgIGFib3V0XHJcbiAgICAgIClcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9yZXNwb25zZSlcclxuICB9XHJcbiAgLy8gLS0tIEFkZGluZyBuZXcgY2FyZCAtLS0gLy9cclxuICBhZGRDYXJkKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSlcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9yZXNwb25zZSlcclxuICB9XHJcbiAgLy8gLS0tIFJlbW92aW5nIGEgY2FyZCAtLS0gLy9cclxuICByZW1vdmVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fcmVzcG9uc2UpXHJcbiAgfVxyXG4gIC8vIC0tLSBMaWtlIGEgY2FyZCAtLS0gLy9cclxuICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIlxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX3Jlc3BvbnNlKVxyXG4gIH1cclxuICAvLyAtLS0gVW5saWtlIGEgY2FyZCAtLS0gLy9cclxuICB1bmxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIlxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX3Jlc3BvbnNlKVxyXG4gIH1cclxuICAvLyAtLS0gU2V0dGluZyB1c2VyIHByb2ZpbGUgYXZhdGFyIC0tLSAvL1xyXG4gIHNldFVzZXJBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoXHJcbiAgICAgICAgICBhdmF0YXJcclxuICAgICAgKVxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX3Jlc3BvbnNlKVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoIG5hbWVFbGVtZW50LCB0aXRsZUVsZW1lbnQsIHBpY3R1cmVFbGVtZW50ICkge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBuYW1lRWxlbWVudDtcclxuICAgIHRoaXMuX3RpdGxlRWxlbWVudCA9IHRpdGxlRWxlbWVudDtcclxuICAgIHRoaXMuX3BpY3R1cmVFbGVtZW50ID0gcGljdHVyZUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUsXHJcbiAgICAgIGpvYjogdGhpcy5fam9iLFxyXG4gICAgICBpZDogdGhpcy5faWQsXHJcbiAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckRhdGEoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZGF0YTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKGRhdGEpIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9qb2IgPSBkYXRhLmFib3V0O1xyXG4gICAgdGhpcy5fYXZhdGFyID0gZGF0YS5hdmF0YXI7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl90aXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9qb2I7XHJcbiAgICB0aGlzLl9waWN0dXJlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdGhpcy5fYXZhdGFyKTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICB0aGlzLl9hdmF0YXIgPSBhdmF0YXI7XHJcbiAgICB0aGlzLl9waWN0dXJlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdGhpcy5fYXZhdGFyKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhJbWFnZSBleHRlbmRzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3RvciggbW9kYWwsIGNoZWNrS2V5UHJlc3MgKXtcclxuICAgIHN1cGVyKCBtb2RhbCwgY2hlY2tLZXlQcmVzcyApO1xyXG4gICAgdGhpcy5fbW9kYWxJbWFnZSA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2JpZy1pbWFnZScpO1xyXG4gICAgdGhpcy5fbW9kYWxUaXRsZSA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2ltYWdlLWNhcHRpb24nKTtcclxuICB9XHJcbiAgLy8gLS0tIE9wZW4gYmlnIGltYWdlIG1vZGFsIG1ldGhvZCAtLS0gLy9cclxuICBvcGVuKG5hbWUsIGxpbmspIHtcclxuICAgIHRoaXMuX21vZGFsVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fbW9kYWxJbWFnZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgbGluayk7XHJcbiAgICB0aGlzLl9tb2RhbEltYWdlLnNldEF0dHJpYnV0ZShcImFsdFwiLCBuYW1lKTtcclxuXHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsImZvcm1Db25maWciLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfZm9ybUNvbmZpZyIsIl9mb3JtRWxlbWVudCIsImlucHV0cyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvck1lc3NhZ2VDbGFzcyIsImVycm9yRWxlbWVudCIsImlkIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9jaGVja0lWYWxpZCIsImV2ZXJ5IiwiaW5wdXQiLCJfdG9nZ2xlU3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsIkNhcmQiLCJkYXRhIiwib25DYXJkQ2xpY2siLCJyZW1vdmVIYW5kbGVyIiwibGlrZUNsaWNrSGFuZGxlciIsInRlbXBsYXRlIiwidXNlcklkIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX293bmVySWQiLCJvd25lciIsIl9pZCIsIl9jYXJkSWQiLCJfbGlrZXMiLCJsaWtlcyIsIl91c2VySWQiLCJfdGVtcGxhdGUiLCJfb25DYXJkQ2xpY2siLCJfbGlrZUNsaWNrSGFuZGxlciIsIl9yZW1vdmVIYW5kbGVyIiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9zZXRBdHRyaWJ1dGVzIiwiY2FyZEVsZW1lbnQiLCJhdHRyaWJzIiwia2V5Iiwic2V0QXR0cmlidXRlIiwiZGVsZXRlQ2FyZCIsIl9jYXJkIiwiX2hhbmRlbExpa2UiLCJsaWtlQnRuIiwidG9nZ2xlIiwiX2xpa2VTdGF0dXMiLCJfY2FyZEVsZW1lbnQiLCJlbGVtZW50IiwiZ2V0Q2FyZElkIiwiZ2VuZXJhdGVDYXJkIiwic3JjIiwiYWx0IiwibGVuZ3RoIiwiY2hlY2tJZkxpa2VkIiwidXNlciIsImZpbmQiLCJsaWtlIiwiX2xpa2VkIiwiX2NhcmRMaWtlZCIsIl9jYXJkVW5saWtlZCIsInJlZnJlc2hDYXJkIiwiTW9kYWwiLCJtb2RhbFNlbGVjdG9yIiwiY2hlY2tLZXlQcmVzcyIsIl9tb2RhbEVsZW1lbnQiLCJkb2N1bWVudCIsIl9lc2NhcGVLZXlIYW5kbGVyIiwiYmluZCIsIl9jaGVja0tleVByZXNzIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJNb2RhbFdpdGhGb3JtIiwic2VsZWN0b3IiLCJoYW5kbGVTdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVTdWJtaXQiLCJfc3VibWl0QnV0dG9uIiwiX2Zvcm0iLCJfdGV4dEluQnV0dG9uIiwiZ2V0SW5wdXRWYWx1ZXMiLCJfaW5wdXRMaXN0IiwiZm9ybUlucHV0VmFsdWVzIiwidmFsdWUiLCJfZW50cmVkVmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsImVudHJlZFZhbHVlIiwicmVzZXQiLCJTZWN0aW9uIiwiaXRlbXMiLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX3JlbmRlcmVkRWxlbWVudHMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsInByZXBlbmQiLCJlZGl0QnV0dG9uIiwicHJvZmlsZU1vZGFsIiwicHJvZmlsZU5hbWUiLCJuYW1lSW5wdXQiLCJwcm9maWxlSm9iIiwiam9iSW5wdXQiLCJ1c2VyQXZhdGFyIiwiYXZhdGFyRWRpdEJ1dHRvbiIsImF2YXRhck1vZGFsIiwiYWRkQ2FyZEJ1dHRvbiIsImFkZENhcmRNb2RhbCIsImFkZENhcmRGb3JtIiwiZm9ybXMiLCJjYXJkVGVtcGxhdGUiLCJlbGVtZW50cyIsInRpdGxlIiwiYmlnSW1hZ2VNb2RhbCIsImJpZ0ltYWdlIiwiYmlnSW1hZ2VUaXRsZSIsImZvcm1TZWxlY3RvciIsImNoZWNrRm9yRXNjUHJlc3NlZCIsImFkZENhcmRGb3JtVmFsaWRhdGlvbiIsImhhbmRsZUFwaUVyciIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJhcGkiLCJjb25maWciLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfcmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwic3RhdHVzVGV4dCIsImdldENhcmRMaXN0IiwiZmV0Y2giLCJ0aGVuIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhZGRDYXJkIiwicmVtb3ZlQ2FyZCIsImNhcmRJZCIsImxpa2VDYXJkIiwidW5saWtlQ2FyZCIsInNldFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwicHJvZmlsZSIsIm5hbWVFbGVtZW50IiwidGl0bGVFbGVtZW50IiwicGljdHVyZUVsZW1lbnQiLCJfbmFtZUVsZW1lbnQiLCJfdGl0bGVFbGVtZW50IiwiX3BpY3R1cmVFbGVtZW50Iiwiam9iIiwiX2pvYiIsIl9hdmF0YXIiLCJnZXRVc2VyRGF0YSIsIl9kYXRhIiwidXNlcklEIiwiZGVsZXRlQ2FyZEhhbmRsZXIiLCJkZWxldGVDYXJkTW9kYWwiLCJjYXJkIiwiY2F0Y2giLCJjcmVhdGVOZXdDYXJkSW5zdGFuY2UiLCJjYXJkRGF0YSIsImNhcmRTZWN0aW9uIiwiY2FyZEluc3RhbmNlIiwiYWRkTmV3Q2FyZE1vZGFsIiwidGl0bGVJbnB1dCIsImxpbmtJbnB1dCIsImFkZE5ld0NhcmRJbnN0YW5jZSIsImVkaXRQcm9maWxlTW9kYWwiLCJ1c2VyRGF0YSIsImF2YXRhckVkaXRNb2RhbCIsImF2YXRhckxpbmtJbnB1dCIsIm1vZGFsIiwiX21vZGFsSW1hZ2UiLCJfbW9kYWxUaXRsZSJdLCJzb3VyY2VSb290IjoiIn0=