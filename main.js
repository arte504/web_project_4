!function(){"use strict";class e{constructor(e,t){this._formConfig=e,this._formElement=t}_showInputError=(e,t)=>{const{inputErrorClass:r,errorMessageClass:s}=this._formConfig,n=this._formElement.querySelector(` #${e.id}_error `);n.textContent=t,n.classList.add(s),e.classList.add(r)};_hideInputError=e=>{const{inputErrorClass:t,errorMessageClass:r}=this._formConfig,s=this._formElement.querySelector(` #${e.id}_error `);s.textContent="",s.classList.remove(r),e.classList.remove(t)};resetValidation(){this.inputs.forEach((e=>{this._hideInputError(e)})),this._toggleSubmitButton()}_checkInput=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)};_checkIfFormValid=()=>this.inputs.every((e=>e.validity.valid));_toggleSubmitButton(){const{inactiveButtonClass:e,submitButtonSelector:t}=this._formConfig,r=this._formElement.querySelector(t);this._checkIfFormValid()?(r.disabled=!1,r.classList.remove(e)):(r.disabled=!0,r.classList.add(e))}_setEventListeners=()=>{const{inputSelector:e}=this._formConfig;return this.inputs=Array.from(this._formElement.querySelectorAll(e)),this.inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInput(e),this._toggleSubmitButton()}))})),this._formElement};enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class t{constructor(e,t,r,{onCardClick:s,removeHandler:n,likeHandler:o}){this._name=e.name,this._link=e.link,this._likes=e.likes,this._ownerId=e.owner._id,this._id=e._id,this._template=t,this._userId=r,this._onCardClick=s,this._likeHandler=o,this._removeHandler=n}_getTemplate(){return this._template.content.querySelector(".card").cloneNode(!0)}_setAttributes(e,t){for(const r in t)e.setAttribute(r,t[r])}deleteCard(){const e=document.getElementById(id);e&&e.parentNode.removeChild(e),this._cardElement=null}_renderLikes(){this._likes.forEach((e=>e._id===this._userId?this._likeCard():this._unlikeCard()))}showLikes(e){this._cardElement.querySelector(".card__like-count").textContent=e}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(e=>{this._likeCard(e)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._removeHandler(this._id)})),this._cardElement.addEventListener("click",(e=>{this._onCardClick(e)}))}_showDeleteIcon(){this._userId!=this._ownerId&&this._cardElement.querySelector(".card__delete-button").classList.add("card__delete-button_hidden")}isLiked(){return this.likeIcon.classList.contains("card__like-button_active")}generateCard(){return this._cardElement=this._getTemplate(),this.likeIcon=this._cardElement.querySelector(".card__like-button"),this._setAttributes(this._cardElement.querySelector(".card__image"),{src:this._link,alt:this._name}),this._cardElement.querySelector(".card__title").textContent=this._name,this._showDeleteIcon(),this.showLikes(this._likes.length),this._setEventListeners(),this._renderLikes(),this._cardElement}_likeCard(){this.likeIcon.classList.add("card__like-button_active")}_unlikeCard(){this.likeIcon.classList.remove("card__like-button_active")}}class r{constructor(e){this._modal=e}open(){this._modal.classList.add("modal_visible"),document.addEventListener("keyup",this._clickEscHandler),console.log(this._modal)}close(){console.log("Check"),this._modal.classList.remove("modal_visible"),document.removeEventListener("keyup",this._clickEscHandler)}_clickEscHandler=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._modal.querySelector(".modal__close-button").addEventListener("click",(e=>{this.close(e)})),this._modal.addEventListener("click",(e=>{e.target.classList.contains("modal_visible")&&this.close(e)}))}}class s extends r{constructor({modal:e,handleSubmit:t}){super(e),this._handleSubmit=t,this._form=document.querySelector(".modal__container"),this._formElement=this._form.querySelectorAll(".modal__input")}_getInputValues(){return this._formInputValues={},inputList.forEach((e=>{this._formInputValues[e.name]=e.value})),inputValues}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",this.handleSubmit)}handleSubmit=e=>(e.preventDefault(),this._handleSubmit(this._getInputValues));handleRemove(e){this._handleSubmit=e}close(){console.log("Check"),super.close(),this._form.removeEventListener("submit",this.handleSubmit),this._form.reset()}}class n{constructor({items:e,renderer:t},r){this._renderedElements=e,this._renderer=t,this._container=document.querySelector(r)}renderer(){this._renderedElements.forEach((e=>this._renderer(e)))}addItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}}class o{constructor(e,t,r){this._name=e,this._job=t,this._avatar=r}getUserInfo(){return this._userInfo={name:this._name.textContent,job:this._job.textContent}}setUserInfo(e){const{name:t,job:r,userAvatar:s}=e;this._name.textContent=t,this._job.textContent=r,this._avatar.src=s}}const i=document.querySelector(".profile__edit-button"),a=document.querySelector(".modal_type_edit"),l=document.querySelector(".profile__title"),d=document.querySelector(".modal__input_type_title"),c=document.querySelector(".profile__subtitle"),_=document.querySelector(".modal__input_type_subtitle"),h=(document.querySelector(".modal__close-button_type_edit"),document.querySelector(".profile__image")),u=document.querySelector(".profile__image-edit"),m=document.querySelector(".modal_type_avatar"),p=(m.querySelector(".modal__input_type_avatar"),document.querySelector(".modal__close-button_type_avatar"),document.querySelector(".profile__add-button")),b=document.querySelector(".modal_type_add-card"),f=(document.querySelector(".modal__input_type_name"),document.querySelector(".modal__input_type_link"),document.querySelector(".modal__close-button_type_add-card"),document.forms.add),k=(f.elements.title,f.elements.link,document.querySelector(".modal__submit-button"),document.querySelector(".cards__grid"),document.querySelector("#card__template")),E=document.querySelector(".modal_type_big-image"),y=(document.querySelector(".modal__big-image"),document.querySelector(".modal__image-caption"),document.querySelector(".modal__close-button_type_big-image"),document.querySelector(".modal_type_delete-card")),v={formSelector:".modal__container",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_error",errorMessageClass:"modal__error_visible"},g=new class extends r{openup=e=>{const t=e.target;this._modalElement.querySelector(".modal__big-image").src=t.src,this._modalElement.querySelector(".modal__big-image").alt=t.alt,this._modalElement.querySelector(".modal__image-caption").textContent=t.alt,this.open()}}(E);g.setEventListeners();const S=new s({modal:y});function C(e,t){t.querySelector(".modal__submit-button").textContent=e?"Saving...":"Save"}S.setEventListeners();const L=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}getCardList(){return fetch(this._baseUrl+"/cards",{headers:this._headers}).then((function(e){if(e.ok)return e.json().then((e=>e));Promise.reject("Error!"+e.statusText)}))}getUserInfo(){return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error!"+e.statusText)))}getAppInfo(){return Promise.all([this.getCardList(),this.getUserInfo()])}addCard(e){const{name:t,link:r}=e;return fetch(this._baseUrl+"/cards",{headers:this._headers,method:"POST",body:JSON.stringify({name:t,link:r})}).then((e=>{if(e.ok)return e.json();Promise.reject("Error!"+e.statusText)}))}removeCard(e){return fetch(this._baseUrl+"/cards/"+e,{headers:this._headers,method:"DELETE"}).then((e=>e.ok?e.json():Promise.reject("Error!"+e.statusText)))}likeCard(e){return fetch(this._baseUrl+"/cards/likes/"+e,{headers:this._headers,method:"PUT"}).then((e=>{if(e.ok)return e.json();Promise.reject("Error!"+e.statusText)}))}unlikeCard(e){return fetch(this._baseUrl+"/cards/likes/"+e,{headers:this._headers,method:"DELETE"}).then((e=>e.ok?e.json():Promise.reject("Error!"+e.statusText)))}setUserInfo(e){const{name:t,job:r}=e;return fetch(this._baseUrl+"/users/me",{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,job:r})}).then((e=>e.ok?e.json():Promise.reject("Error!"+e.statusText+e.status)))}setUserAvatar(e){return fetch(this._baseUrl+"/users/me/avatar",{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject("Error!"+e.statusText)))}updateUserInfo(e){const{name:t,job:r}=e;return fetch(this._baseUrl+"/users/me",{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:r})}).then((e=>e.ok?e.json():Promise.reject("Error!"+e.statusText)))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"709a0d9d-db06-4890-a594-b07e7309a353","Content-Type":"application/json"}});L.getAppInfo().then((([e,r])=>{const u=new o(l,c,h);u.setUserInfo(r);const f=e=>{const s=new t(e,k,r._id,{onCardClick:({name:e,link:t})=>{g.open(t,e)},removeHandler:e=>{S.open(),S.handleRemove((()=>{L.removeCard(e).then((()=>{s.deleteCardModal(),S.close()})).catch((e=>console.log(e)))}))},likeHandler:e=>{s.isLiked()?L.unlikeCard(e).then((e=>{s.unlikeCard(),s.showLikes(e.likes.lenght)})):L.likeCard(e).then((e=>{s.unlikeCard(),s.showLikes(e.likes.lenght)})).catch((e=>console.log(e)))}});return s},E=new n({items:e,renderer:e=>{E.addItem(f(e).generateCard())}},".cards__grid");console.log(e),E.renderer();const y=new s({modal:b,handleSubmit:e=>{C(!0,b),L.addCard(e).then((e=>{E.prependItem(f(e).generateCard())})).then((()=>{y.close()})).catch((e=>console.log(e))).finally((()=>C(!1,b)))}});p.addEventListener("click",(()=>{j.resetValidation(),y.open()}));const v=new s({modal:a,handleSubmit:e=>{C(!0,a),L.updateUserInfo(o).then((e=>{u.setUserInfo(e)})).then((()=>{v.close()})).catch((e=>console.log(e))).finally((()=>C(!1,a)))}});i.addEventListener("click",(()=>{I.resetValidation();const{name:e,job:t}=u.getUserInfo();d.value=e,_.value=t,v.open()}));const q=new s({modal:m,handleSubmit:e=>{C(!0,m),L.updateUserInfo(e.avatar).then((e=>{u.setUserInfo(e)})).then((()=>{q.close()})).catch((e=>console.log(e))).finally((()=>{C(!1,m)}))}})})).catch((e=>console.log(e)));const q=new s({modal:m,modalSubmition:e=>{!function(e){C(!0,m),L.setUserAvatar({avatar:e.avatarURL}).then((e=>{avatarImage.src=e.avatar,C(!1,m),q.close()})).catch((e=>console.log(e)))}(e)}});u.addEventListener("click",(()=>{q.open()})),q.setEventListeners();const I=new e(v,a);I.enableValidation(),new e(v,m).enableValidation();const j=new e(v,b);j.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MEIsY0FBYyxDQUNoQnpELE9BQVF0RixFQUFLb0ssWUFFZHhDLE1BQUtDLElBQ0p3QyxZQUFZeEgsSUFBTWdGLEVBQUl2QyxPQUN0QjZCLEdBQWEsRUFBT2QsR0FDcEI2RCxFQUFXM0csV0FFWmlHLE9BQU1DLEdBQU9wRyxRQUFRQyxJQUFJbUcsS0FNeEJhLENBQWlCdEssTUFJckJvRyxFQUFpQnpHLGlCQUFpQixTQUFTLEtBQ3pDdUssRUFBVy9HLFVBR2IrRyxFQUFXekcsb0JBSVgsTUFBTXNHLEVBQXdCLElBQUk1TSxFQUFjRSxFQUFZMEksR0FDNURnRSxFQUFzQm5LLG1CQUVPLElBQUl6QyxFQUFjRSxFQUFZZ0osR0FDdEN6RyxtQkFFckIsTUFBTWlLLEVBQXdCLElBQUkxTSxFQUFjRSxFQUFZa0osR0FDNURzRCxFQUFzQmpLLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvSW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGZvcm1Db25maWcsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9mb3JtQ29uZmlnID0gZm9ybUNvbmZpZztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpID0+IHtcclxuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvck1lc3NhZ2VDbGFzcyB9ID0gdGhpcy5fZm9ybUNvbmZpZztcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCAjJHtpbnB1dEVsZW1lbnQuaWR9X2Vycm9yIGApO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoZXJyb3JNZXNzYWdlQ2xhc3MpO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5wdXRFcnJvckNsYXNzKTtcclxuICB9O1xyXG4gIFxyXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvck1lc3NhZ2VDbGFzcyB9ID0gdGhpcy5fZm9ybUNvbmZpZztcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCAjJHtpbnB1dEVsZW1lbnQuaWR9X2Vycm9yIGApO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGVycm9yTWVzc2FnZUNsYXNzKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl90b2dnbGVTdWJtaXRCdXR0b24oKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0ID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9jaGVja0lmRm9ybVZhbGlkID0gKCkgPT4gdGhpcy5pbnB1dHMuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcblxyXG4gIF90b2dnbGVTdWJtaXRCdXR0b24oKSB7XHJcbiAgICBjb25zdCB7IGluYWN0aXZlQnV0dG9uQ2xhc3MsIHN1Ym1pdEJ1dHRvblNlbGVjdG9yIH0gPSB0aGlzLl9mb3JtQ29uZmlnO1xyXG4gICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICAgIGlmICh0aGlzLl9jaGVja0lmRm9ybVZhbGlkKCkpIHtcclxuICAgICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgY29uc3QgeyBpbnB1dFNlbGVjdG9yIH0gPSB0aGlzLl9mb3JtQ29uZmlnO1xyXG4gICAgdGhpcy5pbnB1dHMgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoaW5wdXRTZWxlY3RvcikpO1xyXG5cclxuICAgIHRoaXMuaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dChpbnB1dCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlU3VibWl0QnV0dG9uKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybUVsZW1lbnQ7XHJcbiAgfTtcclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoIGRhdGEsIHRlbXBsYXRlLCB1c2VySWQsIFxyXG4gICAgeyBvbkNhcmRDbGljaywgcmVtb3ZlSGFuZGxlciwgbGlrZUhhbmRsZXIgfSApIFxyXG4gIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX3RlbXBsYXRlID0gdGVtcGxhdGU7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcblxyXG4gICAgdGhpcy5fb25DYXJkQ2xpY2sgPSBvbkNhcmRDbGljaztcclxuICAgIHRoaXMuX2xpa2VIYW5kbGVyID0gbGlrZUhhbmRsZXI7XHJcbiAgICB0aGlzLl9yZW1vdmVIYW5kbGVyID0gcmVtb3ZlSGFuZGxlcjtcclxuICB9XHJcbiAgLy8gLS0tIEdldCBjYXJkIHRlbXBsYXRlIC0tLSAvL1xyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gdGhpcy5fdGVtcGxhdGVcclxuICAgIC5jb250ZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcignLmNhcmQnKVxyXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2V0QXR0cmlidXRlcyhjYXJkRWxlbWVudCwgYXR0cmlicykge1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cmlicykge1xyXG4gICAgICBjYXJkRWxlbWVudC5zZXRBdHRyaWJ1dGUoa2V5LCBhdHRyaWJzW2tleV0pO1xyXG4gICAgfVxyXG4gIH1cclxuICAvLyAtLS0gQ2FyZCBkZWxldGluZyBtZXRob2QgLS0tIC8vXHJcbiAgZGVsZXRlQ2FyZCgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xyXG4gICAgaWYoY2FyZEVsZW1lbnQpe1xyXG4gICAgICBjYXJkRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGNhcmRFbGVtZW50KTtcclxuICAgIH1cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICB9XHJcbiAgLy8gLS0tICAtLS0gLy9cclxuICBfcmVuZGVyTGlrZXMgKCkge1xyXG4gICAgdGhpcy5fbGlrZXMuZm9yRWFjaCgobGlrZSkgPT4gXHJcbiAgICAgIGxpa2UuX2lkID09PSB0aGlzLl91c2VySWQgPyB0aGlzLl9saWtlQ2FyZCgpIDogdGhpcy5fdW5saWtlQ2FyZCgpXHJcbiAgICApO1xyXG4gIH1cclxuICAvLyAtLS0gU2hvdyB0aGUgbGlrZSBhbW91bnQgLS0tIC8vXHJcbiAgc2hvd0xpa2VzKGNvdW50KXtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50JykudGV4dENvbnRlbnQgPSBjb3VudDtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBTZXQgZXZlbnRzIGxpc3RlbmVycyBmb3IgdGhlIGNhcmRzIHRoYXQgd2lsbCBiZSBjcmVhdGVkISAtLS0gLy9cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJylcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgICB0aGlzLl9saWtlQ2FyZChldmVudCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ1dHRvbicpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3JlbW92ZUhhbmRsZXIodGhpcy5faWQpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX29uQ2FyZENsaWNrKGV2ZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dEZWxldGVJY29uKCkge1xyXG4gICAgaWYodGhpcy5fdXNlcklkICE9IHRoaXMuX293bmVySWQpIHtcclxuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKS5jbGFzc0xpc3QuYWRkKCdjYXJkX19kZWxldGUtYnV0dG9uX2hpZGRlbicpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLmxpa2VJY29uLmNsYXNzTGlzdC5jb250YWlucygnY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlJyk7XHJcbiAgfVxyXG5cclxuICAvLyAtLS0gQ3JlYXRpbmcgdGhlIGNhcmQgYW5kIGNhcmQgZWxlbWVudHMgLS0tIC8vXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5saWtlSWNvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ1dHRvbicpO1xyXG4gICAgdGhpcy5fc2V0QXR0cmlidXRlcyh0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKSwge1xyXG4gICAgICBzcmM6IHRoaXMuX2xpbmssXHJcbiAgICAgIGFsdDogdGhpcy5fbmFtZVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgdGhpcy5fc2hvd0RlbGV0ZUljb24oKTtcclxuICAgIHRoaXMuc2hvd0xpa2VzKHRoaXMuX2xpa2VzLmxlbmd0aCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfbGlrZUNhcmQoKSB7XHJcbiAgICB0aGlzLmxpa2VJY29uLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZScpO1xyXG4gIH1cclxuXHJcbiAgX3VubGlrZUNhcmQoKSB7XHJcbiAgICB0aGlzLmxpa2VJY29uLmNsYXNzTGlzdC5yZW1vdmUoJ2NhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZScpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbCB7XHJcbiAgY29uc3RydWN0b3IobW9kYWwpIHtcclxuICAgIHRoaXMuX21vZGFsID0gbW9kYWw7XHJcbiAgfVxyXG4gIC8vIC0tLSBPcGVuIG1vZGFsIG1ldGhvZCAtLS0gLy8gXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX21vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF92aXNpYmxlXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2NsaWNrRXNjSGFuZGxlcik7XHJcbiAgICBjb25zb2xlLmxvZyh0aGlzLl9tb2RhbCk7XHJcbiAgfVxyXG4gIC8vIC0tLSBDbG9zZSBtb2RhbCBtZXRob2QgLS0tIC8vXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIkNoZWNrXCIpO1xyXG4gICAgdGhpcy5fbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX3Zpc2libGVcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5fY2xpY2tFc2NIYW5kbGVyKTtcclxuICB9XHJcbiAgLy8gLS0tIENsb3NlIG1vZGFsIG9uIEVTQyBtZXRob2QgLS0tIC8vXHJcbiAgX2NsaWNrRXNjSGFuZGxlciA9IChldmVudCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VzY2FwZScpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyAtLS0gQ2xvc2UgbW9kYWwgb24gY2xvc2UoJ1gnKSBidXR0b24gLS0tIC8vXHJcbiAgICB0aGlzLl9tb2RhbFxyXG4gICAgLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UtYnV0dG9uJylcclxuICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuY2xvc2UoZXZlbnQpO1xyXG4gICAgfSk7XHJcbiAgICAvLyBDbG9zZSBtb2RhbCBvbiBvdmVybGF5KG91dCBvZiB0aGUgbW9kYWwpIGNsaWNrIC0tLSAvLy9cclxuICAgIHRoaXMuX21vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF92aXNpYmxlXCIpKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZShldmVudCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufSIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxXaXRoRm9ybSBleHRlbmRzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3Rvcih7bW9kYWwsIGhhbmRsZVN1Ym1pdH0pIHtcclxuICAgIHN1cGVyKG1vZGFsKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcclxuICAgIHRoaXMuX2Zvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2NvbnRhaW5lcicpO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RhbF9faW5wdXQnKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIHRoaXMuX2Zvcm1JbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2Zvcm1JbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLmhhbmRsZVN1Ym1pdCk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVTdWJtaXQgPSAoZXZlbnQpID0+e1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0gdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKTtcclxuXHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVSZW1vdmUoaGFuZGxlKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBoYW5kbGU7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIGNvbnNvbGUubG9nKFwiQ2hlY2tcIik7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLmhhbmRsZVN1Ym1pdCk7XHJcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVkRWxlbWVudHMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlcmVyKCkge1xyXG4gICAgdGhpcy5fcmVuZGVyZWRFbGVtZW50cy5mb3JFYWNoKChpdGVtKSA9PiB0aGlzLl9yZW5kZXJlcihpdGVtKSk7XHJcbiAgfVxyXG4gIFxyXG4gIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChpdGVtKTtcclxuICB9XHJcblxyXG4gIHByZXBlbmRJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IobmFtZSwgam9iLCBhdmF0YXIpIHtcclxuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5fam9iID0gam9iO1xyXG4gICAgdGhpcy5fYXZhdGFyID0gYXZhdGFyO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gKHRoaXMuX3VzZXJJbmZvID0ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxyXG4gICAgICBqb2I6IHRoaXMuX2pvYi50ZXh0Q29udGVudFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh1c2VySW5mbykge1xyXG4gICAgY29uc3QgeyBuYW1lLCBqb2IsIHVzZXJBdmF0YXIgfSA9IHVzZXJJbmZvO1xyXG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2IudGV4dENvbnRlbnQgPSBqb2I7XHJcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gdXNlckF2YXRhcjtcclxuICB9XHJcbn1cclxuIiwiLy8gLS0tICdFZGl0IHByb2ZpbGUnIG1vZGFsIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2VkaXQnKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3RpdGxlJyk7XHJcbmV4cG9ydCBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lucHV0X3R5cGVfdGl0bGUnKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fc3VidGl0bGUnKTtcclxuZXhwb3J0IGNvbnN0IGpvYklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX3N1YnRpdGxlJyk7XHJcbmV4cG9ydCBjb25zdCBlZGl0Q2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX2VkaXQnKTtcclxuLy8gLS0tICdBdmF0YXJcIiBtb2RhbCBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCB1c2VyQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlJyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlLWVkaXQnKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfYXZhdGFyJyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJNb2RhbElucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX2F2YXRhcicpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX2F2YXRhcicpXHJcbi8vIC0tLSAnQWRkLWNhcmQnIG1vZGFsIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfYWRkLWNhcmQnKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRJbnB1dFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX25hbWUnKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRJbnB1dExpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lucHV0X3R5cGVfbGluaycpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9hZGQtY2FyZCcpO1xyXG4vLyAtLS0gJ0FkZC1DYXJkJyBmb3JtIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXMuYWRkO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm1UaXRlbCA9IGFkZENhcmRGb3JtLmVsZW1lbnRzLnRpdGxlO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm1MaW5rID0gYWRkQ2FyZEZvcm0uZWxlbWVudHMubGluaztcclxuLy8gLS0tIEdlbmVyYWwgY29uc3QgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3N1Ym1pdC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRzX19ncmlkJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZF9fdGVtcGxhdGUnKTtcclxuLy8gLS0tIEJpZyBpbWFnZSBtb2RhbCBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBjYXJkQmlnTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfdHlwZV9iaWctaW1hZ2UnKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRCaWdNb2RhbEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19iaWctaW1hZ2UnKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRCaWdNb2RhbFRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2ltYWdlLWNhcHRpb24nKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRCaWdNb2RhbENsb3NlSWNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UtYnV0dG9uX3R5cGVfYmlnLWltYWdlJyk7XHJcbi8vIC0tLSAnRGVsZXRlIGNhcmQnIG1vZGFsIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX3R5cGVfZGVsZXRlLWNhcmRcIik7XHJcbi8vIC0tLSBGb3JtIGNvbmZpZyBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBmb3JtQ29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2NvbnRhaW5lclwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X2Vycm9yXCIsXHJcbiAgZXJyb3JNZXNzYWdlQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIlxyXG59O1xyXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBNb2RhbFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBNb2RhbFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvQXBpLmpzXCJcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgcHJvZmlsZU5hbWUsXHJcbiAgbmFtZUlucHV0LFxyXG4gIHByb2ZpbGVKb2IsXHJcbiAgam9iSW5wdXQsXHJcbiAgZWRpdEJ1dHRvbixcclxuICBwcm9maWxlTW9kYWwsXHJcbiAgY2FyZFRlbXBsYXRlLFxyXG4gIGFkZENhcmRCdXR0b24sXHJcbiAgYWRkQ2FyZE1vZGFsLFxyXG4gIGF2YXRhck1vZGFsLFxyXG4gIHVzZXJBdmF0YXIsXHJcbiAgYXZhdGFyRWRpdEJ1dHRvbixcclxuICBjYXJkQmlnTW9kYWwsXHJcbiAgZGVsZXRlQ2FyZCxcclxuICBmb3JtQ29uZmlnXHJcbn0gZnJvbSBcIi4uL2NvbXBvbmVudHMvdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG4vLyA9PT09PSBNb2RhbHMgPT09PT0gLy9cclxuLy8gLS0tIEJpZyBpbWFnZSBtb2RhbCBpbnN0YW5jZSAtLS0gLy9cclxuY29uc3QgYmlnSW1hZ2UgPSBuZXcgTW9kYWxXaXRoSW1hZ2UoY2FyZEJpZ01vZGFsKTtcclxuYmlnSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuLy8gLS0tIERlbGV0ZSBjYXJkIG1vZGFsIGluc3RhbmNlIGFuZCBldmVudHMgLS0tIC8vXHJcbmNvbnN0IGRlbGV0ZUNhcmRNb2RhbCA9IG5ldyBNb2RhbFdpdGhGb3JtKHtcclxuICBtb2RhbDogZGVsZXRlQ2FyZFxyXG59KTtcclxuZGVsZXRlQ2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbi8vIC0tLSBVWCBmb3IgbW9kYWxzIC0tLSAvL1xyXG5mdW5jdGlvbiBsb2FkaW5nTW9kYWwoaXNMb2FkaW5nLCBtb2RhbCkge1xyXG4gIGlmIChpc0xvYWRpbmcpIHsgbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKS50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7IH0gXHJcbiAgZWxzZSB7IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIikudGV4dENvbnRlbnQgPSBcIlNhdmVcIjsgfVxyXG59XHJcblxyXG4vLyA9PT09PSBBUEkgPT09PT0gLy9cclxuLy8gLS0tIFNldHRpbmcgdGhlIGRlZmF1bHQgZmV0Y2hpbmcgdXJsIGFuZCB0b2tlbiAtLS0gLy9cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgaGVhZGVyczogXHJcbiAge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI3MDlhMGQ5ZC1kYjA2LTQ4OTAtYTU5NC1iMDdlNzMwOWEzNTNcIixcclxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgXHJcbiAgfVxyXG59KTtcclxuLy8gLS0tIEdldEFwcEluZm8gbWV0aG9kIC0tLSAvL1xyXG5hcGlcclxuICAuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oIChbY2FyZExpc3QsIHVzZXJEYXRhXSkgPT4ge1xyXG4gICAgLy8gLS0tICdQcm9maWxlJyBpbmZvIGVkaXRpbmcgLS0tIC8vXHJcbiAgICBjb25zdCBwcm9maWxlID0gbmV3IFVzZXJJbmZvKHByb2ZpbGVOYW1lLCBwcm9maWxlSm9iLCB1c2VyQXZhdGFyKTtcclxuICAgIHByb2ZpbGUuc2V0VXNlckluZm8odXNlckRhdGEpO1xyXG4gICAgLy8gLS0tIE5ldyBjYXJkIGFkZGluZyAtLS0gLy9cclxuICAgIGNvbnN0IGFkZGluZ05ld0NhcmQgPSAoZGF0YSkgPT57XHJcbiAgICAgIGNvbnN0IGNhcmRJbnN0YW5jZSA9IG5ldyBDYXJkKGRhdGEsIGNhcmRUZW1wbGF0ZSwgdXNlckRhdGEuX2lkLCB7XHJcbiAgICAgICAgb25DYXJkQ2xpY2s6ICh7bmFtZSwgbGlua30pID0+IHtcclxuICAgICAgICAgIGJpZ0ltYWdlLm9wZW4obGluaywgbmFtZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICByZW1vdmVIYW5kbGVyOiAoY2FyZElkKSA9PiB7XHJcbiAgICAgICAgICBkZWxldGVDYXJkTW9kYWwub3BlbigpO1xyXG4gICAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLmhhbmRsZVJlbW92ZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAgIC5yZW1vdmVDYXJkKGNhcmRJZClcclxuICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjYXJkSW5zdGFuY2UuZGVsZXRlQ2FyZE1vZGFsKCk7XHJcbiAgICAgICAgICAgICAgICBkZWxldGVDYXJkTW9kYWwuY2xvc2UoKTtcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGxpa2VIYW5kbGVyOiAoY2FyZElkKSA9PntcclxuICAgICAgICAgIGNvbnN0IGxpa2VUb2dnbGUgPSBjYXJkSW5zdGFuY2UuaXNMaWtlZCgpO1xyXG4gICAgICAgICAgaWYobGlrZVRvZ2dsZSkge1xyXG4gICAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgICAudW5saWtlQ2FyZChjYXJkSWQpXHJcbiAgICAgICAgICAgICAgLnRoZW4oKGNvdW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjYXJkSW5zdGFuY2UudW5saWtlQ2FyZCgpO1xyXG4gICAgICAgICAgICAgICAgY2FyZEluc3RhbmNlLnNob3dMaWtlcyhjb3VudC5saWtlcy5sZW5naHQpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAgIC5saWtlQ2FyZChjYXJkSWQpXHJcbiAgICAgICAgICAgICAgLnRoZW4oKGNvdW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjYXJkSW5zdGFuY2UudW5saWtlQ2FyZCgpO1xyXG4gICAgICAgICAgICAgICAgY2FyZEluc3RhbmNlLnNob3dMaWtlcyhjb3VudC5saWtlcy5sZW5naHQpO1xyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBjYXJkSW5zdGFuY2U7XHJcbiAgICB9O1xyXG4gICAgLy8gLS0tIENhcmRzIHNlY3Rpb24gY3JlYXRpb24gLS0tIC8vXHJcbiAgICBjb25zdCBjYXJkc0xpc3QgPSBuZXcgU2VjdGlvbih7XHJcbiAgICAgIGl0ZW1zOiBjYXJkTGlzdCxcclxuICAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XHJcbiAgICAgICAgY2FyZHNMaXN0LmFkZEl0ZW0oYWRkaW5nTmV3Q2FyZChkYXRhKS5nZW5lcmF0ZUNhcmQoKSk7XHJcbiAgICAgIH1cclxuICAgIH0sIFxyXG4gICAgJy5jYXJkc19fZ3JpZCcpO1xyXG4gICAgY29uc29sZS5sb2coY2FyZExpc3QpO1xyXG4gICAgLy8gLS0tIFJlbmRlciBjYXJkcyAtLS0gLy9cclxuICAgIGNhcmRzTGlzdC5yZW5kZXJlcigpO1xyXG4gICAgLy8gLS0tIE5ldyBjYXJkIGFkZGluZyBmb3JtIC0tLSAvL1xyXG4gICAgY29uc3QgYWRkQ2FyZEZvcm0gPSBuZXcgTW9kYWxXaXRoRm9ybSh7XHJcbiAgICAgIG1vZGFsOiBhZGRDYXJkTW9kYWwsXHJcbiAgICAgIGhhbmRsZVN1Ym1pdDogKGRhdGEpID0+e1xyXG4gICAgICAgIGxvYWRpbmdNb2RhbCh0cnVlLCBhZGRDYXJkTW9kYWwpO1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmFkZENhcmQoZGF0YSlcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgY2FyZHNMaXN0LnByZXBlbmRJdGVtKGFkZGluZ05ld0NhcmQocmVzKS5nZW5lcmF0ZUNhcmQoKSk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBhZGRDYXJkRm9ybS5jbG9zZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgICAgICAgLmZpbmFsbHkoKCkgPT4gbG9hZGluZ01vZGFsKGZhbHNlLCBhZGRDYXJkTW9kYWwpKTtcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgLy8gLS0tIEFkZCBjYXJkIGJ1dHRvbiBmdW5jdGlvbmFsIGFkZGluZyAtLS0gLy9cclxuICAgIGFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgYWRkQ2FyZEZvcm1WYWxpZGF0aW9uLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gICAgICBhZGRDYXJkRm9ybS5vcGVuKCk7XHJcbiAgICB9KTtcclxuICAgIC8vIC0tLSBQcm9maWxlIGVkaXQgZm9ybSAtLS0gLy9cclxuICAgIGNvbnN0IHByb2ZpbGVGb3JtID0gbmV3IE1vZGFsV2l0aEZvcm0oe1xyXG4gICAgICBtb2RhbDogcHJvZmlsZU1vZGFsLCBcclxuICAgICAgaGFuZGxlU3VibWl0OiAodXNlckluZm8pID0+IHtcclxuICAgICAgICBsb2FkaW5nTW9kYWwodHJ1ZSwgcHJvZmlsZU1vZGFsKTtcclxuICAgICAgICBhcGlcclxuICAgICAgICAudXBkYXRlVXNlckluZm8oVXNlckluZm8pXHJcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgcHJvZmlsZS5zZXRVc2VySW5mbyhyZXMpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICBwcm9maWxlRm9ybS5jbG9zZSgpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgICAgICAuZmluYWxseSgoKSA9PiBsb2FkaW5nTW9kYWwoZmFsc2UscHJvZmlsZU1vZGFsKSlcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvLyAtLS0gT3BlbiAnUHJvZmlsZScgZm9ybSB3aXRoIGN1cnJlbnQgdmFsdWVzIGFzIGlucHV0cyAtLS0gLy9cclxuICAgIGVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVGb3JtVmFsaWRhdGlvbi5yZXNldFZhbGlkYXRpb24oKTtcclxuICAgICAgY29uc3QgeyBuYW1lLCBqb2IgfSA9IHByb2ZpbGUuZ2V0VXNlckluZm8oKTtcclxuICAgICAgbmFtZUlucHV0LnZhbHVlID0gbmFtZTtcclxuICAgICAgam9iSW5wdXQudmFsdWUgPSBqb2I7XHJcbiAgICAgIHByb2ZpbGVGb3JtLm9wZW4oKTtcclxuICAgIH0pO1xyXG4gICAgLy8gLS0tICdBdmF0YXInIGVkaXQvdXBkYXRlIGZvcm0gLS0tIC8vXHJcbiAgICBjb25zdCBhdmF0YXJGb3JtID0gbmV3IE1vZGFsV2l0aEZvcm0oe1xyXG4gICAgICBtb2RhbDogYXZhdGFyTW9kYWwsXHJcbiAgICAgIGhhbmRsZVN1Ym1pdDogKGltZ0xpbmspID0+IHtcclxuICAgICAgICBsb2FkaW5nTW9kYWwodHJ1ZSwgYXZhdGFyTW9kYWwpO1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLnVwZGF0ZVVzZXJJbmZvKGltZ0xpbmsuYXZhdGFyKVxyXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBwcm9maWxlLnNldFVzZXJJbmZvKHJlcyk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBhdmF0YXJGb3JtLmNsb3NlKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXHJcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIGxvYWRpbmdNb2RhbChmYWxzZSwgYXZhdGFyTW9kYWwpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxufSlcclxuLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG5cclxuLy8gPT09PT0gQXZhdGFyID09PT09IC8vXHJcbi8vIC0tLSAnQXZhdGFyJyBmb3JtIGZ1bmN0aW9uYWwgLS0tIC8vXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckVkaXQoZGF0YSkge1xyXG4gIGxvYWRpbmdNb2RhbCh0cnVlLCBhdmF0YXJNb2RhbCk7XHJcbiAgYXBpLnNldFVzZXJBdmF0YXIoe1xyXG4gICAgYXZhdGFyOiBkYXRhLmF2YXRhclVSTFxyXG4gIH0pXHJcbiAgLnRoZW4ocmVzID0+IHtcclxuICAgIGF2YXRhckltYWdlLnNyYyA9IHJlcy5hdmF0YXI7XHJcbiAgICBsb2FkaW5nTW9kYWwoZmFsc2UsIGF2YXRhck1vZGFsKTtcclxuICAgIGVkaXRBdmF0YXIuY2xvc2UoKTtcclxuICB9KVxyXG4gIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbn1cclxuLy8gLS0tICdBdmF0YXInIGZvcm0gY3JlYXRpb24gLS0tIC8vXHJcbmNvbnN0IGVkaXRBdmF0YXIgPSBuZXcgTW9kYWxXaXRoRm9ybSh7XHJcbiAgbW9kYWw6IGF2YXRhck1vZGFsLFxyXG4gIG1vZGFsU3VibWl0aW9uOiAoZGF0YSkgPT4ge1xyXG4gICAgaGFuZGxlQXZhdGFyRWRpdChkYXRhKVxyXG4gIH1cclxufSk7XHJcbi8vIC0tLSBPcGVuIGF2YXRhciBlZGl0IG1vZGFsIG9uIGNsaWNrIC0tLSAvL1xyXG5hdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZWRpdEF2YXRhci5vcGVuKCk7XHJcbn0pO1xyXG4vLyAtLS0gJ0F2YXRhcicgZm9ybSBoYW5kbGVyIC0tLSAvL1xyXG5lZGl0QXZhdGFyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLyA9PT09PSBWYWxpZGF0aW9uID09PT09IC8vXHJcbi8vIC0tLSAnRWRpdCBwcm9maWxlJyBmb3JtIHZhbGlkYXRpb24gYWRkaW5nIC0tLSAvL1xyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBwcm9maWxlTW9kYWwpO1xyXG5wcm9maWxlRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4vLyAtLS0gJ0F2YXRhcicgZm9ybSB2YWxpZGF0aW9uIGFkZGluZyAtLS0gLy9cclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBhdmF0YXJNb2RhbCk7XHJcbmF2YXRhckZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuLy8gLS0tICdBZGQgY2FyZCcgZm9ybSB2YWxpZGF0aW9uIGFkZGluZyAtLS0gLy9cclxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgYWRkQ2FyZE1vZGFsKTtcclxuYWRkQ2FyZEZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuIiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhJbWFnZSBleHRlbmRzIE1vZGFsIHtcclxuICAvLyAtLS0gT3BlbiBiaWcgaW1hZ2UgbW9kYWwgbWV0aG9kIC0tLSAvL1xyXG4gIG9wZW51cCA9IChldmVudCkgPT4ge1xyXG4gICAgY29uc3QgYmlnSW1hZ2UgPSBldmVudC50YXJnZXQ7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYmlnLWltYWdlXCIpLnNyYyA9IGJpZ0ltYWdlLnNyYztcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19iaWctaW1hZ2VcIikuYWx0ID0gYmlnSW1hZ2UuYWx0O1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlLWNhcHRpb25cIikudGV4dENvbnRlbnQgPSBiaWdJbWFnZS5hbHQ7XHJcblxyXG4gICAgdGhpcy5vcGVuKCk7XHJcbiAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIC8vID09PSBHZXR0aW5nIGluZm8gZnJvbSBzZXJ2ZXIgPT09IC8vXHJcbiAgLy8gLS0tIEdldCBjYXJkIGxpc3QgZnJvbSB0aGUgc2VydmVyIC0tLSAvL1xyXG4gIGdldENhcmRMaXN0KCkge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL2NhcmRzXCIsIHtcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICB9KVxyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCkudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIFByb21pc2UucmVqZWN0KFwiRXJyb3IhXCIgKyByZXMuc3RhdHVzVGV4dCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICk7XHJcbiAgfVxyXG4gIC8vIC0tLSBHZXQgdXNlciBpbmZvIGZyb20gdGhlIHNlcnZlciAtLS0gLy9cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgfSlcclxuICAgICAgICAudGhlbigocmVzKSA9PlxyXG4gICAgICAgICAgcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KFwiRXJyb3IhXCIgKyByZXMuc3RhdHVzVGV4dClcclxuICAgICAgICApXHJcbiAgICApO1xyXG4gIH1cclxuICAvLyAtLS0gQ2hlY2sgaWYgYWxsIGluZm8gZmV0Y2hlZCAtLS0gLy9cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldENhcmRMaXN0KCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xyXG4gIH1cclxuXHJcbiAgLy8gPT09IEFkZGluZy9SZW1vdmluZy9FZGl0aW5nID09PSAvL1xyXG4gIC8vIC0tLSBBZGRpbmcgbmV3IGNhcmQgLS0tIC8vXHJcbiAgYWRkQ2FyZChkYXRhKSB7XHJcbiAgICBjb25zdCB7bmFtZSwgbGlua30gPSBkYXRhO1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkc1wiLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBQcm9taXNlLnJlamVjdChcIkVycm9yIVwiICsgcmVzLnN0YXR1c1RleHQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbiAgLy8gLS0tIFJlbW92aW5nIGEgY2FyZCAtLS0gLy9cclxuICByZW1vdmVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9cIiArIGNhcmRJZCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICB9KS50aGVuKChyZXMpID0+XHJcbiAgICAgIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChcIkVycm9yIVwiICsgcmVzLnN0YXR1c1RleHQpXHJcbiAgICApO1xyXG4gIH1cclxuICAvLyAtLS0gTGlrZSBhIGNhcmQgLS0tIC8vXHJcbiAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL2NhcmRzL2xpa2VzL1wiICsgY2FyZElkLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgUHJvbWlzZS5yZWplY3QoXCJFcnJvciFcIiArIHJlcy5zdGF0dXNUZXh0KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8vIC0tLSBVbmxpa2UgYSBjYXJkIC0tLSAvL1xyXG4gIHVubGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL2NhcmRzL2xpa2VzL1wiICsgY2FyZElkLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgIH0pLnRoZW4oKHJlcykgPT5cclxuICAgICAgcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KFwiRXJyb3IhXCIgKyByZXMuc3RhdHVzVGV4dClcclxuICAgICk7XHJcbiAgfVxyXG4gIC8vIC0tLSBTZXR0aW5nIHVzZXIgcHJvZmlsZSBpbmZvIC0tLSAvL1xyXG4gIHNldFVzZXJJbmZvKCB1c2VySW5mbyApIHtcclxuICAgIGNvbnN0IHsgbmFtZSwgam9iIH0gPSB1c2VySW5mbztcclxuICAgIHJldHVybiAoXHJcbiAgICAgIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgam9iLFxyXG4gICAgICAgIH0pLFxyXG4gICAgICB9KVxyXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIHJldHVybiByZXMub2tcclxuICAgICAgICAgICAgPyByZXMuanNvbigpXHJcbiAgICAgICAgICAgIDogUHJvbWlzZS5yZWplY3QoXCJFcnJvciFcIiArIHJlcy5zdGF0dXNUZXh0ICsgcmVzLnN0YXR1cyk7XHJcbiAgICAgICAgfSlcclxuICAgICk7XHJcbiAgfVxyXG4gIC8vIC0tLSBTZXR0aW5nIHVzZXIgcHJvZmlsZSBhdmF0YXIgLS0tIC8vXHJcbiAgc2V0VXNlckF2YXRhcihsaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL3VzZXJzL21lL2F2YXRhclwiLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT5cclxuICAgICAgcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KFwiRXJyb3IhXCIgKyByZXMuc3RhdHVzVGV4dClcclxuICAgICk7XHJcbiAgfVxyXG4gIC8vIC0tLSBVcGRhdGluZy9FZGl0aW5nIHVzZXIgcHJvZmlsZSBpbmZvIC0tLSAvL1xyXG4gIHVwZGF0ZVVzZXJJbmZvKHVzZXJJbmZvKSB7XHJcbiAgICBjb25zdCB7IG5hbWUsIGpvYiB9ID0gdXNlckluZm87XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL3VzZXJzL21lXCIsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGFib3V0OiBqb2IsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QoXCJFcnJvciFcIiArIHJlcy5zdGF0dXNUZXh0KTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwiZm9ybUNvbmZpZyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9mb3JtQ29uZmlnIiwiX2Zvcm1FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JNZXNzYWdlQ2xhc3MiLCJlcnJvckVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsImFkZCIsIl9oaWRlSW5wdXRFcnJvciIsInJlbW92ZSIsInJlc2V0VmFsaWRhdGlvbiIsImlucHV0cyIsImZvckVhY2giLCJpbnB1dCIsIl90b2dnbGVTdWJtaXRCdXR0b24iLCJfY2hlY2tJbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9jaGVja0lmRm9ybVZhbGlkIiwiZXZlcnkiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJidXR0b25FbGVtZW50IiwiZGlzYWJsZWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJpbnB1dFNlbGVjdG9yIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsIkNhcmQiLCJkYXRhIiwidGVtcGxhdGUiLCJ1c2VySWQiLCJvbkNhcmRDbGljayIsInJlbW92ZUhhbmRsZXIiLCJsaWtlSGFuZGxlciIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9saWtlcyIsImxpa2VzIiwiX293bmVySWQiLCJvd25lciIsIl9pZCIsIl90ZW1wbGF0ZSIsIl91c2VySWQiLCJfb25DYXJkQ2xpY2siLCJfbGlrZUhhbmRsZXIiLCJfcmVtb3ZlSGFuZGxlciIsIl9nZXRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfc2V0QXR0cmlidXRlcyIsImNhcmRFbGVtZW50IiwiYXR0cmlicyIsImtleSIsInNldEF0dHJpYnV0ZSIsImRlbGV0ZUNhcmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwiX2NhcmRFbGVtZW50IiwiX3JlbmRlckxpa2VzIiwibGlrZSIsIl9saWtlQ2FyZCIsIl91bmxpa2VDYXJkIiwic2hvd0xpa2VzIiwiY291bnQiLCJfc2hvd0RlbGV0ZUljb24iLCJpc0xpa2VkIiwibGlrZUljb24iLCJjb250YWlucyIsImdlbmVyYXRlQ2FyZCIsInNyYyIsImFsdCIsImxlbmd0aCIsIk1vZGFsIiwibW9kYWwiLCJfbW9kYWwiLCJvcGVuIiwiX2NsaWNrRXNjSGFuZGxlciIsImNvbnNvbGUiLCJsb2ciLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsIk1vZGFsV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVTdWJtaXQiLCJfZm9ybSIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtSW5wdXRWYWx1ZXMiLCJpbnB1dExpc3QiLCJ2YWx1ZSIsImlucHV0VmFsdWVzIiwiaGFuZGxlUmVtb3ZlIiwiaGFuZGxlIiwicmVzZXQiLCJTZWN0aW9uIiwiaXRlbXMiLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX3JlbmRlcmVkRWxlbWVudHMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiaXRlbSIsImFkZEl0ZW0iLCJhcHBlbmQiLCJwcmVwZW5kSXRlbSIsInByZXBlbmQiLCJVc2VySW5mbyIsImpvYiIsImF2YXRhciIsIl9qb2IiLCJfYXZhdGFyIiwiZ2V0VXNlckluZm8iLCJfdXNlckluZm8iLCJzZXRVc2VySW5mbyIsInVzZXJJbmZvIiwidXNlckF2YXRhciIsImVkaXRCdXR0b24iLCJwcm9maWxlTW9kYWwiLCJwcm9maWxlTmFtZSIsIm5hbWVJbnB1dCIsInByb2ZpbGVKb2IiLCJqb2JJbnB1dCIsImF2YXRhckVkaXRCdXR0b24iLCJhdmF0YXJNb2RhbCIsImFkZENhcmRCdXR0b24iLCJhZGRDYXJkTW9kYWwiLCJhZGRDYXJkRm9ybSIsImZvcm1zIiwiY2FyZFRlbXBsYXRlIiwiZWxlbWVudHMiLCJ0aXRsZSIsImNhcmRCaWdNb2RhbCIsImZvcm1TZWxlY3RvciIsImJpZ0ltYWdlIiwib3BlbnVwIiwiX21vZGFsRWxlbWVudCIsImRlbGV0ZUNhcmRNb2RhbCIsImxvYWRpbmdNb2RhbCIsImlzTG9hZGluZyIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldENhcmRMaXN0IiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1c1RleHQiLCJnZXRBcHBJbmZvIiwiYWxsIiwiYWRkQ2FyZCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwicmVtb3ZlQ2FyZCIsImNhcmRJZCIsImxpa2VDYXJkIiwidW5saWtlQ2FyZCIsInN0YXR1cyIsInNldFVzZXJBdmF0YXIiLCJ1cGRhdGVVc2VySW5mbyIsImFib3V0IiwiYXV0aG9yaXphdGlvbiIsImNhcmRMaXN0IiwidXNlckRhdGEiLCJwcm9maWxlIiwiYWRkaW5nTmV3Q2FyZCIsImNhcmRJbnN0YW5jZSIsImNhdGNoIiwiZXJyIiwibGVuZ2h0IiwiY2FyZHNMaXN0IiwiZmluYWxseSIsImFkZENhcmRGb3JtVmFsaWRhdGlvbiIsInByb2ZpbGVGb3JtIiwicHJvZmlsZUZvcm1WYWxpZGF0aW9uIiwiYXZhdGFyRm9ybSIsImltZ0xpbmsiLCJlZGl0QXZhdGFyIiwibW9kYWxTdWJtaXRpb24iLCJhdmF0YXJVUkwiLCJhdmF0YXJJbWFnZSIsImhhbmRsZUF2YXRhckVkaXQiXSwic291cmNlUm9vdCI6IiJ9