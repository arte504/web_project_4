!function(){"use strict";class e{constructor(e,t){this._formConfig=e,this._formElement=t,this.inputs=Array.from(this._formElement.querySelectorAll(this._formConfig.inputSelector)),this._buttonElement=this._formElement.querySelector(this._formConfig.submitButtonSelector)}_showInputError=(e,t)=>{const{inputErrorClass:s,errorMessageClass:r}=this._formConfig,n=this._formElement.querySelector(` #${e.id}_error `);n.textContent=t,n.classList.add(r),e.classList.add(s)};_hideInputError=e=>{const{inputErrorClass:t,errorMessageClass:s}=this._formConfig,r=this._formElement.querySelector(` #${e.id}_error `);r.textContent="",r.classList.remove(s),e.classList.remove(t)};_checkInput=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)};_checkIValid=()=>this.inputs.every((e=>e.validity.valid));_toggleSubmitButton(){this._checkIValid()?(this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._formConfig.inactiveButtonClass)):(this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._formConfig.inactiveButtonClass))}_setEventListeners=()=>(this.inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInput(e),this._toggleSubmitButton()}))})),this._formElement);enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class t{constructor(e,t,s,r,n,i){this._name=e.name,this._link=e.link,this._ownerId=e.owner._id,this._cardId=e._id,this._likes=e.likes,this._userId=i,this._template=n,this._onCardClick=t,this._likeClickHandler=r,this._removeHandler=s}_getTemplate(){return this._template.content.querySelector(".card").cloneNode(!0)}_setAttributes(e,t){for(const s in t)e.setAttribute(s,t[s])}deleteCard(){this._userId===this._ownerId&&(this._card.remove(),this._card=null)}_handelLike(e){e.classList.toggle("card__like-button_active")}_likeStatus(){const e=this._cardElement.querySelector(".card__like-button");Array.from(this._likes).forEach((t=>{t._id===this._userId&&e.classList.add("card__like-button_active")}))}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._likeClickHandler(this)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._removeHandler(this)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._onCardClick(this._name,this._link)}))}getCardId(){return this._cardId}generateCard(e){return this._cardElement=this._getTemplate(),this._card=this._cardElement,this._setAttributes(this._cardElement.querySelector(".card__image"),{src:this._link,alt:this._name}),this._cardElement.querySelector(".card__title").textContent=this._name,this._ownerId!==e&&this._card.querySelector(".card__delete-button_hidden"),this._likeStatus(),this._cardElement.querySelector(".card__like-count").textContent=this._likes.length,this._setEventListeners(),this._cardElement}checkIfLiked(e){return this._likes.find((t=>t._id===e))?this._liked=!0:this._liked=!1,this._liked}_cardLiked(){this._cardElement.querySelector(".card__like-button").classList.add("card__like-button_active")}_cardUnliked(){this._cardElement.querySelector(".card__like-button").classList.remove("card__like-button_active")}isLiked(){return this._liked}refreshCard(e,t){this._likes=e.likes,this.checkIfLiked(t)?this._cardLiked():this._cardUnliked(),this._cardElement.querySelector(".card__like-count").textContent=this._likes.length}}class s{constructor(e,t){this._modalElement=document.querySelector(e),this._escapeKeyHandler=this._escapeKeyHandler.bind(this),this._checkKeyPress=t}open(){this._modalElement.classList.add("modal_visible"),document.addEventListener("keyup",this._escapeKeyHandler)}close(){this._modalElement.classList.remove("modal_visible"),document.removeEventListener("keyup",this._escapeKeyHandler)}_escapeKeyHandler(e){this._checkKeyPress(e.key)&&this.close()}setEventListeners(){this._modalElement.addEventListener("click",(e=>{e.target.classList.contains("modal__close-button")&&this.close(),e.target.classList.contains("modal_visible")&&this.close()}))}}class r extends s{constructor(e,t,s){super(e,t),this._handleSubmit=s,this._submitButton=this._modalElement.querySelector(".modal__submit-button"),this._form=document.querySelector(".modal__container"),this._textInButton=this._submitButton.textContent}getInputValues(){this._inputList=this._modalElement.querySelectorAll(".modal__input");const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e||this._entredValue}setInputValues(e){this._entredValue=e,console.log(e)}setEventListeners(){super.setEventListeners(),this._modalElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitButton.textContent="Saving...",this._handleSubmit(this.getInputValues())}))}close(){this._submitButton.textContent=this._textInButton,this._form.reset(),super.close()}}class n{constructor({items:e,renderer:t},s){this._renderedElements=e,this._renderer=t,this._container=document.querySelector(s)}renderItems(){this._renderedElements.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const i=document.querySelector(".profile__edit-button"),a=document.querySelector(".modal_type_edit"),o=document.querySelector(".profile__title"),l=document.querySelector(".modal__input_type_title"),d=document.querySelector(".profile__subtitle"),_=document.querySelector(".modal__input_type_subtitle"),c=(document.querySelector(".modal__close-button_type_edit"),document.querySelector(".profile__image")),h=document.querySelector(".profile__image_overlay"),u=document.querySelector(".modal_type_avatar"),m=u.querySelector(".modal__input_type_avatar"),p=(document.querySelector(".modal__close-button_type_avatar"),document.querySelector(".profile__add-button")),y=document.querySelector(".modal_type_add-card"),b=document.querySelector(".modal__input_type_name"),E=document.querySelector(".modal__input_type_link"),k=(document.querySelector(".modal__close-button_type_add-card"),document.forms.add),v=(k.elements.title,k.elements.link,document.querySelector(".modal__submit-button"),document.querySelector(".cards__grid"),document.querySelector("#card__template")),f=document.querySelector(".modal_type_big-image"),g=f.querySelector(".modal__big-image"),S=f.querySelector(".modal__image-caption"),C=(document.querySelector(".modal__close-button_type_big-image"),document.querySelector(".modal_type_delete-card"),{formSelector:".modal__container",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_error",errorMessageClass:"modal__error_visible"}),L=e=>"Escape"===e,q=()=>{b.value="",E.value=""};new e(C,a).enableValidation(),new e(C,u).enableValidation(),new e(C,y).enableValidation();const I=e=>console.log(e),U=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_response(e){return e.ok?e.json():Promise.reject(`Error: ${e.status} - ${e.statusText}`)}getCardList(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._response)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._response)}setUserInfo(e,t){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers,method:"PATCH",body:JSON.stringify(e,t)}).then(this._response)}addCard(e){return fetch(`${this._baseUrl}/cards`,{headers:this._headers,method:"POST",body:JSON.stringify(e)}).then(this._response)}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{headers:this._headers,method:"DELETE"}).then(this._response)}likeCard(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{headers:this._headers,method:"PUT"}).then(this._response)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{headers:this._headers,method:"DELETE"}).then(this._response)}setUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{headers:this._headers,method:"PATCH",body:JSON.stringify(e)}).then(this._response)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"709a0d9d-db06-4890-a594-b07e7309a353","Content-Type":"application/json"}}),x=new class{constructor(e,t,s){this._nameElement=e,this._titleElement=t,this._pictureElement=s}getUserInfo(){return{name:this._name.textContent,job:this._job.textContent,id:this._id}}getUserData(){return this._data}setUserInfo(e,t){this._name=e,this._job=t,this._nameElement.textContent=this._name,this._titleElement.textContent=this._job}}(o,d);let w;U.getUserInfo().then((e=>(x.setUserInfo(e.name,e.about),c.src=e.avatar,w=e._id,x))).then((e=>{U.getCardList().then((s=>{const i=(e,t)=>{H.open(e,t)},a=e=>{A.open(),T(e)},o=e=>{e.checkIfLiked(w)?U.unlikeCard(e.getCardId()).then((t=>{e.refreshCard(t,w)})).catch(I):U.likeCard(e.getCardId()).then((t=>{e.refreshCard(t,w)})).catch(I)},l=e=>new t(e,i,a,o,v,w),d=new n({items:s,renderer:e=>{const t=l(e);console.log(),d.addItem(t.generateCard())}},".cards__grid");d.renderItems();const _=new r(".modal_type_add-card",L,(({titleInput:t,linkInput:s})=>{U.addCard({name:t,link:s}).then((t=>{const s=l(t);d.addItem(s.generateCard(e.id)),q(),_.close(q)})).catch(I)}));_.setEventListeners(),p.addEventListener("click",(()=>{_.open()}))})).catch(I)})).catch(I);const $=new r(".modal_type_edit",L,(({nameInput:e,jobInput:t})=>{U.setUserInfo({name:e,about:t}).then((()=>{$.close()})).catch(I)}));$.setEventListeners(),i.addEventListener("click",(()=>{l.value=o.textContent,_.value=d.textContent,$.open()}));const B=new r(".modal_type_avatar",L,(({avatarLinkInput:e})=>{U.setUserAvatar({avatar:e}).then((()=>{B.close()})).catch(I).finally(B.close())}));B.setEventListeners(),h.addEventListener("click",(()=>{m.value="",B.open()}));const A=new r(".modal_type_delete-card",L,T);function T(e){addEventListener("submit",(()=>{U.removeCard(e.getCardId()).then((()=>{A.close()})).catch(I).finally(e.deleteCard(),A.close())}))}A.setEventListeners();const H=new class extends s{constructor(e,t){super(e,t),this._modalImage=document.querySelector(".modal__big-image"),this._modalTitle=document.querySelector(".modal__image-caption")}open(e,t){this._modalTitle.textContent=e,this._modalImage.setAttribute("src",t),super.open()}}(".modal_type_big-image",L,g,S);H.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MEMsRUFBZ0J2SCxXQUVqQjZHLE1BQU1sRCxHQUNOOEQsUUFBUUYsRUFBZ0J2SCxZQUcvQnVILEVBQWdCckgsb0JBRWhCdUMsRUFBaUIxRyxpQkFBaUIsU0FBUyxLQUN6QzRHLEVBQWlCM0IsTUFBUSxHQUN6QnVHLEVBQWdCeEgsVUFJbEIsTUFBTTJHLEVBQWtCLElBQUlyRyxFRHhLTSwwQkMwS2hDb0QsRUFDQWtELEdBRUYsU0FBU0EsRUFBY0MsR0FDckI3SyxpQkFBaUIsVUFBVSxLQUN6QjhILEVBQ0d5QixXQUFXc0IsRUFBS25JLGFBQ2hCb0csTUFBSyxLQUNKNkIsRUFBZ0IxRyxXQUVqQjZHLE1BQU1sRCxHQUNOOEQsUUFBUWIsRUFBSzNJLGFBQWF5SSxFQUFnQjFHLFlBR2pEMEcsRUFBZ0J4RyxvQkFFaEIsTUFBTW1ELEVBQWdCLElHL05QLGNBQTZCOUQsRUFDMUM5RixZQUFhaU8sRUFBT2pJLEdBQ2xCZSxNQUFPa0gsRUFBT2pJLEdBQ2Q3RixLQUFLK04sWUFBY2hJLFNBQVN0RixjQUFjLHFCQUMxQ1QsS0FBS2dPLFlBQWNqSSxTQUFTdEYsY0FBYyx5QkFHNUMwRixLQUFLcEQsRUFBTUUsR0FDVGpELEtBQUtnTyxZQUFZOU0sWUFBYzZCLEVBQy9CL0MsS0FBSytOLFlBQVkzSixhQUFhLE1BQU9uQixHQUVyQzJELE1BQU1ULFNKMkJzQix3QkMyTDlCMEQsRUFDQUgsRUFDQUMsR0FFRkYsRUFBY25ELG9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvSW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGZvcm1Db25maWcsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9mb3JtQ29uZmlnID0gZm9ybUNvbmZpZztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLmlucHV0cyA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9mb3JtQ29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2Zvcm1Db25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSA9PiB7XHJcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JNZXNzYWdlQ2xhc3MgfSA9IHRoaXMuX2Zvcm1Db25maWc7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAgIyR7aW5wdXRFbGVtZW50LmlkfV9lcnJvciBgKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGVycm9yTWVzc2FnZUNsYXNzKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuICBcclxuICBfaGlkZUlucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JNZXNzYWdlQ2xhc3MgfSA9IHRoaXMuX2Zvcm1Db25maWc7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAgIyR7aW5wdXRFbGVtZW50LmlkfV9lcnJvciBgKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShlcnJvck1lc3NhZ2VDbGFzcyk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShpbnB1dEVycm9yQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIF9jaGVja0lucHV0ID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9jaGVja0lWYWxpZCA9ICgpID0+IHRoaXMuaW5wdXRzLmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG5cclxuICBfdG9nZ2xlU3VibWl0QnV0dG9uKCkge1xyXG4gICAgaWYgKHRoaXMuX2NoZWNrSVZhbGlkKCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZm9ybUNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH0gXHJcbiAgICBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9mb3JtQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgdGhpcy5pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0KGlucHV0KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVTdWJtaXRCdXR0b24oKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLl9mb3JtRWxlbWVudDtcclxuICB9O1xyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvciggXHJcbiAgICBkYXRhLCBcclxuICAgIG9uQ2FyZENsaWNrLCBcclxuICAgIHJlbW92ZUhhbmRsZXIsIFxyXG4gICAgbGlrZUNsaWNrSGFuZGxlcixcclxuICAgIHRlbXBsYXRlLCBcclxuICAgIHVzZXJJZCApIFxyXG4gIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xyXG4gICAgdGhpcy5fY2FyZElkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcblxyXG4gICAgdGhpcy5fdGVtcGxhdGUgPSB0ZW1wbGF0ZTtcclxuICAgIHRoaXMuX29uQ2FyZENsaWNrID0gb25DYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9saWtlQ2xpY2tIYW5kbGVyID0gbGlrZUNsaWNrSGFuZGxlcjtcclxuICAgIHRoaXMuX3JlbW92ZUhhbmRsZXIgPSByZW1vdmVIYW5kbGVyO1xyXG4gIH1cclxuICAvLyAtLS0gR2V0IGNhcmQgdGVtcGxhdGUgLS0tIC8vXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSB0aGlzLl90ZW1wbGF0ZVxyXG4gICAgLmNvbnRlbnRcclxuICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpXHJcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zZXRBdHRyaWJ1dGVzKGNhcmRFbGVtZW50LCBhdHRyaWJzKSB7XHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBhdHRyaWJzKSB7XHJcbiAgICAgIGNhcmRFbGVtZW50LnNldEF0dHJpYnV0ZShrZXksIGF0dHJpYnNba2V5XSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIC0tLSBDYXJkIGRlbGV0aW5nIG1ldGhvZCAtLS0gLy9cclxuICBkZWxldGVDYXJkKCkge1xyXG4gICAgaWYodGhpcy5fdXNlcklkID09PSB0aGlzLl9vd25lcklkKXtcclxuICAgICAgdGhpcy5fY2FyZC5yZW1vdmUoKTtcclxuICAgICAgdGhpcy5fY2FyZCA9IG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIC0tLSBMaWtlIGhhbmRsZXIgLS0tIC8vXHJcbiAgX2hhbmRlbExpa2UobGlrZUJ0bikge1xyXG4gICAgbGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmUnKVxyXG4gIH1cclxuICBfbGlrZVN0YXR1cygpIHtcclxuICAgIGNvbnN0IGxpa2VCdG4gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKTtcclxuICAgIGNvbnN0IGxpa2VzID0gQXJyYXkuZnJvbSh0aGlzLl9saWtlcyk7XHJcbiAgICBsaWtlcy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcbiAgICAgIGlmKGVsZW1lbnQuX2lkID09PSB0aGlzLl91c2VySWQpe1xyXG4gICAgICAgIGxpa2VCdG4uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8vIC0tLSBTZXQgZXZlbnRzIGxpc3RlbmVycyBmb3IgdGhlIGNhcmRzIHRoYXQgd2lsbCBiZSBjcmVhdGVkISAtLS0gLy9cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJylcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fbGlrZUNsaWNrSGFuZGxlcih0aGlzKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnV0dG9uJylcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fcmVtb3ZlSGFuZGxlcih0aGlzKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX29uQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldENhcmRJZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkSWQ7XHJcbiAgfVxyXG5cclxuICAvLyAtLS0gQ3JlYXRpbmcgdGhlIGNhcmQgYW5kIGNhcmQgZWxlbWVudHMgLS0tIC8vXHJcbiAgZ2VuZXJhdGVDYXJkKHVzZXJJZCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fY2FyZCA9IHRoaXMuX2NhcmRFbGVtZW50O1xyXG5cclxuICAgIHRoaXMuX3NldEF0dHJpYnV0ZXModGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpLCB7XHJcbiAgICAgICAgc3JjOiB0aGlzLl9saW5rLFxyXG4gICAgICAgIGFsdDogdGhpcy5fbmFtZVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJykudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIGlmKHRoaXMuX293bmVySWQgIT09IHVzZXJJZCkge1xyXG4gICAgICB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnV0dG9uX2hpZGRlbicpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fbGlrZVN0YXR1cygpO1xyXG4gICAgLy8gLS0tIFNob3cgbGlrZSBjb3VudCAtLS0gLy9cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudCcpLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBjaGVja0lmTGlrZWQodXNlcikge1xyXG4gICAgaWYodGhpcy5fbGlrZXMuZmluZCgobGlrZSkgPT4gbGlrZS5faWQgPT09IHVzZXIpKSB7XHJcbiAgICAgIHRoaXMuX2xpa2VkID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGVsc2V7XHJcbiAgICAgIHRoaXMuX2xpa2VkID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VkO1xyXG4gIH1cclxuXHJcbiAgX2NhcmRMaWtlZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKVxyXG4gICAgICAuY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIF9jYXJkVW5saWtlZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKVxyXG4gICAgICAuY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIGlzTGlrZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fbGlrZWQ7XHJcbiAgfVxyXG5cclxuICByZWZyZXNoQ2FyZChkYXRhLCB1c2VySWQpIHtcclxuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuICAgIGlmKHRoaXMuY2hlY2tJZkxpa2VkKHVzZXJJZCkpIHtcclxuICAgICAgdGhpcy5fY2FyZExpa2VkKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgdGhpcy5fY2FyZFVubGlrZWQoKTtcclxuICAgIH1cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudCcpXHJcbiAgICAgIC50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWwge1xyXG4gIGNvbnN0cnVjdG9yKCBtb2RhbFNlbGVjdG9yLCBjaGVja0tleVByZXNzICkge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihtb2RhbFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2VzY2FwZUtleUhhbmRsZXIgPSB0aGlzLl9lc2NhcGVLZXlIYW5kbGVyLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9jaGVja0tleVByZXNzID0gY2hlY2tLZXlQcmVzcztcclxuICB9XHJcbiAgLy8gLS0tIE9wZW4gbW9kYWwgbWV0aG9kIC0tLSAvLyBcclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF92aXNpYmxlXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2VzY2FwZUtleUhhbmRsZXIpO1xyXG4gIH1cclxuICAvLyAtLS0gQ2xvc2UgbW9kYWwgbWV0aG9kIC0tLSAvL1xyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF92aXNpYmxlXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2VzY2FwZUtleUhhbmRsZXIpO1xyXG4gIH1cclxuICAvLyAtLS0gQ2xvc2UgbW9kYWwgb24gRVNDIG1ldGhvZCAtLS0gLy9cclxuICBfZXNjYXBlS2V5SGFuZGxlcihldmVudCkge1xyXG4gICAgaWYgKHRoaXMuX2NoZWNrS2V5UHJlc3MoZXZlbnQua2V5KSkge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudFxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICAgIC8vIC0tLSBDbG9zZSBtb2RhbCBvbiBjbG9zZSgnWCcpIGJ1dHRvbiAtLS0gLy9cclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfX2Nsb3NlLWJ1dHRvbicpKSB7XHJcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIENsb3NlIG1vZGFsIG9uIG92ZXJsYXkob3V0IG9mIHRoZSBtb2RhbCkgY2xpY2sgLS0tIC8vL1xyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF92aXNpYmxlJykpIHtcclxuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59IiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhGb3JtIGV4dGVuZHMgTW9kYWwge1xyXG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yLCBjaGVja0tleVByZXNzLCBoYW5kbGVTdWJtaXQgKSB7XHJcbiAgICBzdXBlcihzZWxlY3RvciwgY2hlY2tLZXlQcmVzcyk7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBoYW5kbGVTdWJtaXQ7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19zdWJtaXQtYnV0dG9uJyk7XHJcbiAgICB0aGlzLl9mb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jb250YWluZXInKTtcclxuICAgIHRoaXMuX3RleHRJbkJ1dHRvbiA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICB9XHJcblxyXG4gIGdldElucHV0VmFsdWVzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RhbF9faW5wdXQnKTtcclxuICAgIGNvbnN0IGZvcm1JbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0XHJcbiAgICAgIC5mb3JFYWNoKChpbnB1dCkgPT4geyBmb3JtSW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZSB9XHJcbiAgICApO1xyXG5cclxuICAgIHJldHVybiBmb3JtSW5wdXRWYWx1ZXMgfHwgdGhpcy5fZW50cmVkVmFsdWU7XHJcbiAgfVxyXG5cclxuICBzZXRJbnB1dFZhbHVlcyhlbnRyZWRWYWx1ZSkge1xyXG4gICAgdGhpcy5fZW50cmVkVmFsdWUgPSBlbnRyZWRWYWx1ZTtcclxuICAgIGNvbnNvbGUubG9nKGVudHJlZFZhbHVlKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAvLyAtLS0gVVggZm9yIG1vZGFscyAtLS0gLy9cclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl90ZXh0SW5CdXR0b247XHJcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlZEVsZW1lbnRzID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVkRWxlbWVudHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xyXG4gIH1cclxufVxyXG4iLCIvLyAtLS0gJ0VkaXQgcHJvZmlsZScgbW9kYWwgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfZWRpdCcpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fdGl0bGUnKTtcclxuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW5wdXRfdHlwZV90aXRsZScpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUpvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19zdWJ0aXRsZScpO1xyXG5leHBvcnQgY29uc3Qgam9iSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lucHV0X3R5cGVfc3VidGl0bGUnKTtcclxuZXhwb3J0IGNvbnN0IGVkaXRDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UtYnV0dG9uX3R5cGVfZWRpdCcpO1xyXG4vLyAtLS0gJ0F2YXRhclwiIG1vZGFsIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IHVzZXJBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faW1hZ2UnKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhckVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faW1hZ2Vfb3ZlcmxheScpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfdHlwZV9hdmF0YXInKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhck1vZGFsSW5wdXQgPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lucHV0X3R5cGVfYXZhdGFyJyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UtYnV0dG9uX3R5cGVfYXZhdGFyJylcclxuLy8gLS0tICdBZGQtY2FyZCcgbW9kYWwgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfdHlwZV9hZGQtY2FyZCcpO1xyXG5leHBvcnQgY29uc3QgY2FyZElucHV0VGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lucHV0X3R5cGVfbmFtZScpO1xyXG5leHBvcnQgY29uc3QgY2FyZElucHV0TGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW5wdXRfdHlwZV9saW5rJyk7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX2FkZC1jYXJkJyk7XHJcbi8vIC0tLSAnQWRkLUNhcmQnIGZvcm0gY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtcy5hZGQ7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybVRpdGVsID0gYWRkQ2FyZEZvcm0uZWxlbWVudHMudGl0bGU7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybUxpbmsgPSBhZGRDYXJkRm9ybS5lbGVtZW50cy5saW5rO1xyXG4vLyAtLS0gR2VuZXJhbCBjb25zdCAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fc3VibWl0LWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgY2FyZExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZHNfX2dyaWQnKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjYXJkX190ZW1wbGF0ZScpO1xyXG4vLyAtLS0gQmlnIGltYWdlIG1vZGFsIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGJpZ0ltYWdlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfdHlwZV9iaWctaW1hZ2UnKTtcclxuZXhwb3J0IGNvbnN0IGJpZ0ltYWdlID0gYmlnSW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2JpZy1pbWFnZScpO1xyXG5leHBvcnQgY29uc3QgYmlnSW1hZ2VUaXRsZSA9IGJpZ0ltYWdlTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbWFnZS1jYXB0aW9uJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkQmlnTW9kYWxDbG9zZUljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX2JpZy1pbWFnZScpO1xyXG4vLyAtLS0gJ0RlbGV0ZSBjYXJkJyBtb2RhbCBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBkZWxldGVDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX3R5cGVfZGVsZXRlLWNhcmQnKTtcclxuLy8gLS0tIFNlbGVjdG9ycyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVNb2RhbFNlbGVjdG9yID0gJy5tb2RhbF90eXBlX2VkaXQnO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyTW9kYWxTZWxlY3RvciA9ICcubW9kYWxfdHlwZV9hdmF0YXInO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsU2VsZWN0b3IgPSAnLm1vZGFsX3R5cGVfYWRkLWNhcmQnO1xyXG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZFNlbGVjdG9yID0gJy5tb2RhbF90eXBlX2RlbGV0ZS1jYXJkJztcclxuZXhwb3J0IGNvbnN0IGJpZ0ltYWdlU2VsZWN0b3IgPSAnLm1vZGFsX3R5cGVfYmlnLWltYWdlJztcclxuZXhwb3J0IGNvbnN0IGNhcmRMaXN0U2VsZWN0b3IgPSAnLmNhcmRzX19ncmlkJ1xyXG4vLyAtLS0gRm9ybSBjb25maWcgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgZm9ybUNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19jb250YWluZXJcIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF9lcnJvclwiLFxyXG4gIGVycm9yTWVzc2FnZUNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCJcclxufTtcclxuLy8gLS0tIEFQSSBjb25zdCAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGFwaUNvbmZpZyA9IHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcclxuICBoZWFkZXJzOiBcclxuICB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjcwOWEwZDlkLWRiMDYtNDg5MC1hNTk0LWIwN2U3MzA5YTM1M1wiLFxyXG4gICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyBcclxuICB9LFxyXG59OyIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL0NhcmQuanNcIjtcclxuaW1wb3J0IE1vZGFsV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IE1vZGFsV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9Nb2RhbFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9BcGkuanNcIlxyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IHtcclxuICBwcm9maWxlTmFtZSxcclxuICBwcm9maWxlSm9iLFxyXG4gIGVkaXRCdXR0b24sXHJcbiAgY2FyZExpc3RTZWxlY3RvcixcclxuICBwcm9maWxlTW9kYWwsXHJcbiAgcHJvZmlsZU1vZGFsU2VsZWN0b3IsXHJcbiAgY2FyZFRlbXBsYXRlLFxyXG4gIGFkZENhcmRCdXR0b24sXHJcbiAgYWRkQ2FyZE1vZGFsLFxyXG4gIGFkZENhcmRNb2RhbFNlbGVjdG9yLFxyXG4gIGNhcmRJbnB1dFRpdGxlLFxyXG4gIGNhcmRJbnB1dExpbmssXHJcbiAgYXZhdGFyTW9kYWwsXHJcbiAgYXZhdGFyTW9kYWxTZWxlY3RvcixcclxuICBhdmF0YXJNb2RhbElucHV0LFxyXG4gIHVzZXJBdmF0YXIsXHJcbiAgYXZhdGFyRWRpdEJ1dHRvbixcclxuICBiaWdJbWFnZVNlbGVjdG9yLFxyXG4gIGJpZ0ltYWdlLFxyXG4gIGJpZ0ltYWdlVGl0bGUsXHJcbiAgZGVsZXRlQ2FyZFNlbGVjdG9yLFxyXG4gIGFwaUNvbmZpZyxcclxuICBmb3JtQ29uZmlnLFxyXG4gIG5hbWVJbnB1dCxcclxuICBqb2JJbnB1dFxyXG59IGZyb20gXCIuLi9jb21wb25lbnRzL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuLy8gPT09PT0gTW9kYWxzID09PT09IC8vXHJcbi8vIC0tLSAnRXNjJyBjaGVjayAtLS0gLy9cclxuY29uc3QgY2hlY2tGb3JFc2NQcmVzc2VkID0gKGtleSkgPT4ga2V5ID09PSBcIkVzY2FwZVwiO1xyXG4vLyAtLS0gQWRkIG1vZGFsIHJlc2V0IGlucHV0IC0tLSAvL1xyXG5jb25zdCBtb2RhbFJlc2V0SW5wdXRzID0gKCkgPT4ge1xyXG4gIGNhcmRJbnB1dFRpdGxlLnZhbHVlID0gXCJcIjtcclxuICBjYXJkSW5wdXRMaW5rLnZhbHVlID0gXCJcIjtcclxufVxyXG5cclxuLy8gPT09PT0gVmFsaWRhdGlvbiA9PT09PSAvL1xyXG4vLyAtLS0gJ0VkaXQgcHJvZmlsZScgZm9ybSB2YWxpZGF0aW9uIC0tLSAvL1xyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBwcm9maWxlTW9kYWwpO1xyXG5wcm9maWxlRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4vLyAtLS0gJ0F2YXRhcicgZm9ybSB2YWxpZGF0aW9uIC0tLSAvL1xyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGF2YXRhck1vZGFsKTtcclxuYXZhdGFyRm9ybVZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4vLyAtLS0gJ0FkZCBjYXJkJyBmb3JtIHZhbGlkYXRpb24gLS0tIC8vXHJcbmNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1Db25maWcsIGFkZENhcmRNb2RhbCk7XHJcbmFkZENhcmRGb3JtVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vLyA9PT09PSBBUEkgJiBDYXJkID09PT09IC8vXHJcbi8vIC0tLSBBUEkgZXJyb3IgaGFuZGxlciAtLS0gLy8gXHJcbmNvbnN0IGFwaUVyciA9IChlcnIpID0+IGNvbnNvbGUubG9nKGVycik7XHJcbi8vIC0tLSBTZXR0aW5nIHRoZSBkZWZhdWx0IGZldGNoaW5nIG1ldGhvZCAtLS0gLy9cclxuY29uc3QgYXBpID0gbmV3IEFwaShhcGlDb25maWcpO1xyXG4vLyAtLS0gU2V0IHdoYXQgJ3Byb2ZpbGUnIHdpbGwgY29udGFpbnMgLS0tIC8vXHJcbmNvbnN0IHByb2ZpbGUgPSBuZXcgVXNlckluZm8oXHJcbiAgcHJvZmlsZU5hbWUsIFxyXG4gIHByb2ZpbGVKb2JcclxuKTtcclxubGV0IHVzZXJJRDtcclxuYXBpXHJcbiAgLy8gLS0tIEdldCB1c2VyIGluZm8gbWV0aG9kIC0tLSAvL1xyXG4gIC5nZXRVc2VySW5mbygpXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgcHJvZmlsZS5zZXRVc2VySW5mbyhyZXMubmFtZSwgcmVzLmFib3V0KTtcclxuICAgIHVzZXJBdmF0YXIuc3JjID0gcmVzLmF2YXRhcjtcclxuICAgIHVzZXJJRCA9IHJlcy5faWQ7XHJcbiAgICByZXR1cm4gcHJvZmlsZTtcclxuICB9KVxyXG4gIC8vIC0tLSBVc2UgdXNlciBpbmZvIGZvciBjcmVhdGlvbiBvZiBuZXcgY2FyZHMgYW5kIGNhcmQgc2VjdGlvbiAtLS0gLy8gXHJcbiAgLnRoZW4oKHByb2ZpbGUpID0+IHtcclxuICAgIGFwaVxyXG4gICAgICAuZ2V0Q2FyZExpc3QoKVxyXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIC8vIC0tLSBPbiBjYXJkIGNsaWNrIGhhbmRsZXIgLS0tIC8vXHJcbiAgICAgICAgY29uc3Qgb25DYXJkQ2xpY2sgPSAobmFtZSwgbGluaykgPT4ge1xyXG4gICAgICAgICAgYmlnSW1hZ2VNb2RhbC5vcGVuKG5hbWUsIGxpbmspO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyAtLS0gRGVsZXRlIGNhcmQgYnV0dG9uIGhhbmRsZXIgLS0tIC8vXHJcbiAgICAgICAgY29uc3QgZGVsZXRlQ2FyZEhhbmRsZXIgPSAoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLm9wZW4oKTtcclxuICAgICAgICAgIGRlbGV0ZUNvbmZpcm0oZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIC0tLSBMaWtlIGJ1dHRvbiBjbGljayBoYW5kbGVyIC0tLSAvL1xyXG4gICAgICAgIGNvbnN0IGxpa2VDbGlja0hhbmRsZXIgPSAoY2FyZCkgPT4ge1xyXG4gICAgICAgICAgaWYgKGNhcmQuY2hlY2tJZkxpa2VkKHVzZXJJRCkpIHtcclxuICAgICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgICAgLnVubGlrZUNhcmQoY2FyZC5nZXRDYXJkSWQoKSlcclxuICAgICAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY2FyZC5yZWZyZXNoQ2FyZChkYXRhLCB1c2VySUQpO1xyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgLmNhdGNoKGFwaUVycik7XHJcbiAgICAgICAgICB9IFxyXG4gICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAgIC5saWtlQ2FyZChjYXJkLmdldENhcmRJZCgpKVxyXG4gICAgICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjYXJkLnJlZnJlc2hDYXJkKGRhdGEsIHVzZXJJRCk7XHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAuY2F0Y2goYXBpRXJyKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gLS0tIE5ldyBjYXJkIGluc3RhbmNlIGFkZGluZyAtLS0gLy9cclxuICAgICAgICBjb25zdCBuZXdDYXJkSW5zdGFuY2UgPSAoY2FyZERhdGEpID0+IHtcclxuICAgICAgICAgIGNvbnN0IGNhcmRJbnN0YW5jZSA9IG5ldyBDYXJkKFxyXG4gICAgICAgICAgICBjYXJkRGF0YSxcclxuICAgICAgICAgICAgb25DYXJkQ2xpY2ssXHJcbiAgICAgICAgICAgIGRlbGV0ZUNhcmRIYW5kbGVyLFxyXG4gICAgICAgICAgICBsaWtlQ2xpY2tIYW5kbGVyLFxyXG4gICAgICAgICAgICBjYXJkVGVtcGxhdGUsXHJcbiAgICAgICAgICAgIHVzZXJJRFxyXG4gICAgICAgICAgKTtcclxuICAgICAgICAgIHJldHVybiBjYXJkSW5zdGFuY2U7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgaXRlbXM6IGRhdGEsXHJcbiAgICAgICAgICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGNhcmRJbnN0YW5jZSA9IG5ld0NhcmRJbnN0YW5jZShpdGVtKTtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZygpO1xyXG4gICAgICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEluc3RhbmNlLmdlbmVyYXRlQ2FyZCgpKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjYXJkTGlzdFNlbGVjdG9yXHJcbiAgICAgICAgKTtcclxuICAgICAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG5cclxuICAgICAgICBjb25zdCBhZGROZXdDYXJkTW9kYWwgPSBuZXcgTW9kYWxXaXRoRm9ybShcclxuICAgICAgICAgIGFkZENhcmRNb2RhbFNlbGVjdG9yLFxyXG4gICAgICAgICAgY2hlY2tGb3JFc2NQcmVzc2VkLFxyXG4gICAgICAgICAgKHsgdGl0bGVJbnB1dDogbmFtZSwgbGlua0lucHV0OiBsaW5rIH0pID0+IHtcclxuICAgICAgICAgICAgYXBpXHJcbiAgICAgICAgICAgICAgLmFkZENhcmQoeyBuYW1lLCBsaW5rIH0pXHJcbiAgICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFkZE5ld0NhcmRJbnN0YW5jZSA9IG5ld0NhcmRJbnN0YW5jZShkYXRhKTtcclxuICAgICAgICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oXHJcbiAgICAgICAgICAgICAgICAgIGFkZE5ld0NhcmRJbnN0YW5jZS5nZW5lcmF0ZUNhcmQocHJvZmlsZS5pZClcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBtb2RhbFJlc2V0SW5wdXRzKCk7XHJcbiAgICAgICAgICAgICAgICBhZGROZXdDYXJkTW9kYWwuY2xvc2UobW9kYWxSZXNldElucHV0cyk7XHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAuY2F0Y2goYXBpRXJyKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgICAgIGFkZE5ld0NhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIGFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgIGFkZE5ld0NhcmRNb2RhbC5vcGVuKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pXHJcbiAgICAuY2F0Y2goYXBpRXJyKTtcclxufSlcclxuLmNhdGNoKGFwaUVycik7XHJcblxyXG5cclxuLy8gPT09PT0gJ0VkaXQnIHByb2ZpbGUgPT09PT0gLy9cclxuLy8gLS0tIEVkaXQgcHJvZmlsZSBtb2RhbCAtLS0gLy9cclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IG5ldyBNb2RhbFdpdGhGb3JtIChcclxuICBwcm9maWxlTW9kYWxTZWxlY3RvcixcclxuICBjaGVja0ZvckVzY1ByZXNzZWQsXHJcbiAgKHtuYW1lSW5wdXQ6IG5hbWUsIGpvYklucHV0OmFib3V0fSkgPT4gXHJcbiAge1xyXG4gICAgYXBpXHJcbiAgICAgIC5zZXRVc2VySW5mbyh7bmFtZSxhYm91dH0pXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBlZGl0UHJvZmlsZU1vZGFsLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChhcGlFcnIpO1xyXG4gIH1cclxuKVxyXG5lZGl0UHJvZmlsZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbi8vIC0tLSBFZGl0IGJ1dHRvbiBoYW5kbGVyIC0tLSAvLyBcclxuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiAsICgpID0+IHtcclxuICBuYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcclxuICBqb2JJbnB1dC52YWx1ZSA9IHByb2ZpbGVKb2IudGV4dENvbnRlbnQ7XHJcbiAgZWRpdFByb2ZpbGVNb2RhbC5vcGVuKCk7XHJcbn0pO1xyXG4vLyAtLS0gQXZhdGFyIGVkaXQgbW9kYWwgLS0tIC8vXHJcbmNvbnN0IGF2YXRhckVkaXRNb2RhbCA9IG5ldyBNb2RhbFdpdGhGb3JtIChcclxuICBhdmF0YXJNb2RhbFNlbGVjdG9yLFxyXG4gIGNoZWNrRm9yRXNjUHJlc3NlZCxcclxuICAoeyBhdmF0YXJMaW5rSW5wdXQ6YXZhdGFyIH0pID0+IFxyXG4gIHtcclxuICAgIGFwaVxyXG4gICAgICAuc2V0VXNlckF2YXRhcih7YXZhdGFyfSlcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGF2YXRhckVkaXRNb2RhbC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goYXBpRXJyKVxyXG4gICAgICAuZmluYWxseShhdmF0YXJFZGl0TW9kYWwuY2xvc2UoKSlcclxuICB9XHJcbik7XHJcbmF2YXRhckVkaXRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4vLyAtLS0gQXZhdGFyIGVkaXQgYnV0dG9uIC0tLSAvL1xyXG5hdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYXZhdGFyTW9kYWxJbnB1dC52YWx1ZSA9IFwiXCI7XHJcbiAgYXZhdGFyRWRpdE1vZGFsLm9wZW4oKTtcclxufSlcclxuXHJcbi8vIC0tLSBEZWxldGUgY2FyZCBtb2RhbCBpbnN0YW5jZSBhbmQgZXZlbnRzIC0tLSAvL1xyXG5jb25zdCBkZWxldGVDYXJkTW9kYWwgPSBuZXcgTW9kYWxXaXRoRm9ybShcclxuICBkZWxldGVDYXJkU2VsZWN0b3IsXHJcbiAgY2hlY2tGb3JFc2NQcmVzc2VkLFxyXG4gIGRlbGV0ZUNvbmZpcm1cclxuKTtcclxuZnVuY3Rpb24gZGVsZXRlQ29uZmlybShjYXJkKSB7XHJcbiAgYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PiB7XHJcbiAgICBhcGlcclxuICAgICAgLnJlbW92ZUNhcmQoY2FyZC5nZXRDYXJkSWQoKSlcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGRlbGV0ZUNhcmRNb2RhbC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goYXBpRXJyKVxyXG4gICAgICAuZmluYWxseShjYXJkLmRlbGV0ZUNhcmQoKSxkZWxldGVDYXJkTW9kYWwuY2xvc2UoKSk7XHJcbiAgfSk7XHJcbn1cclxuZGVsZXRlQ2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbi8vIC0tLSBCaWcgaW1hZ2UgbW9kYWwgaW5zdGFuY2UgLS0tIC8vXHJcbmNvbnN0IGJpZ0ltYWdlTW9kYWwgPSBuZXcgTW9kYWxXaXRoSW1hZ2UoXHJcbiAgYmlnSW1hZ2VTZWxlY3RvcixcclxuICBjaGVja0ZvckVzY1ByZXNzZWQsXHJcbiAgYmlnSW1hZ2UsXHJcbiAgYmlnSW1hZ2VUaXRsZVxyXG4pO1xyXG5iaWdJbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gY29uZmlnLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gY29uZmlnLmhlYWRlcnM7XHJcbiAgfVxyXG4gIC8vIC0tLSBHbG9iYWwgQVBJIHJlc3BvbnNlIG1ldGhvZCAtLS0gLy9cclxuICBfcmVzcG9uc2UocmVzKSB7XHJcbiAgICByZXR1cm4gcmVzLm9rXHJcbiAgICA/IHJlcy5qc29uKClcclxuICAgIDogUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9IC0gJHtyZXMuc3RhdHVzVGV4dH1gKTtcclxuICB9XHJcbiAgLy8gLS0tIEdldCBjYXJkIGxpc3QgZnJvbSB0aGUgc2VydmVyIC0tLSAvL1xyXG4gIGdldENhcmRMaXN0KCkge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9yZXNwb25zZSlcclxuICAgICk7XHJcbiAgfVxyXG4gIC8vIC0tLSBHZXQgdXNlciBpbmZvIGZyb20gdGhlIHNlcnZlciAtLS0gLy9cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX3Jlc3BvbnNlKVxyXG4gIH1cclxuICAvLyAtLS0gVXBkYXRpbmcvRWRpdGluZyB1c2VyIHByb2ZpbGUgaW5mbyAtLS0gLy9cclxuICBzZXRVc2VySW5mbyhuYW1lLCBhYm91dCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoXHJcbiAgICAgICAgbmFtZSwgXHJcbiAgICAgICAgYWJvdXRcclxuICAgICAgKVxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX3Jlc3BvbnNlKVxyXG4gIH1cclxuICAvLyAtLS0gQWRkaW5nIG5ldyBjYXJkIC0tLSAvL1xyXG4gIGFkZENhcmQoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKVxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX3Jlc3BvbnNlKVxyXG4gIH1cclxuICAvLyAtLS0gUmVtb3ZpbmcgYSBjYXJkIC0tLSAvL1xyXG4gIHJlbW92ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCJcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9yZXNwb25zZSlcclxuICB9XHJcbiAgLy8gLS0tIExpa2UgYSBjYXJkIC0tLSAvL1xyXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fcmVzcG9uc2UpXHJcbiAgfVxyXG4gIC8vIC0tLSBVbmxpa2UgYSBjYXJkIC0tLSAvL1xyXG4gIHVubGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fcmVzcG9uc2UpXHJcbiAgfVxyXG4gIC8vIC0tLSBTZXR0aW5nIHVzZXIgcHJvZmlsZSBhdmF0YXIgLS0tIC8vXHJcbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShcclxuICAgICAgICAgIGF2YXRhclxyXG4gICAgICApXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fcmVzcG9uc2UpXHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3RvciggbmFtZUVsZW1lbnQsIHRpdGxlRWxlbWVudCwgcGljdHVyZUVsZW1lbnQgKSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IG5hbWVFbGVtZW50O1xyXG4gICAgdGhpcy5fdGl0bGVFbGVtZW50ID0gdGl0bGVFbGVtZW50O1xyXG4gICAgdGhpcy5fcGljdHVyZUVsZW1lbnQgPSBwaWN0dXJlRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgam9iOiB0aGlzLl9qb2IudGV4dENvbnRlbnQsXHJcbiAgICAgIGlkOiB0aGlzLl9pZFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJEYXRhKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2RhdGE7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhuYW1lLCBqb2IpIHtcclxuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5fam9iID0gam9iO1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fdGl0bGVFbGVtZW50LnRleHRDb250ZW50ID0gdGhpcy5fam9iO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgTW9kYWwgZnJvbSBcIi4vTW9kYWwuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsV2l0aEltYWdlIGV4dGVuZHMgTW9kYWwge1xyXG4gIGNvbnN0cnVjdG9yKCBtb2RhbCwgY2hlY2tLZXlQcmVzcyApe1xyXG4gICAgc3VwZXIoIG1vZGFsLCBjaGVja0tleVByZXNzICk7XHJcbiAgICB0aGlzLl9tb2RhbEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19iaWctaW1hZ2UnKTtcclxuICAgIHRoaXMuX21vZGFsVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2ltYWdlLWNhcHRpb24nKTtcclxuICB9XHJcbiAgLy8gLS0tIE9wZW4gYmlnIGltYWdlIG1vZGFsIG1ldGhvZCAtLS0gLy9cclxuICBvcGVuKG5hbWUsIGxpbmspIHtcclxuICAgIHRoaXMuX21vZGFsVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fbW9kYWxJbWFnZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgbGluayk7IFxyXG5cclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwiZm9ybUNvbmZpZyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9mb3JtQ29uZmlnIiwiX2Zvcm1FbGVtZW50IiwiaW5wdXRzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfYnV0dG9uRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yTWVzc2FnZUNsYXNzIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsImFkZCIsIl9oaWRlSW5wdXRFcnJvciIsInJlbW92ZSIsIl9jaGVja0lucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2NoZWNrSVZhbGlkIiwiZXZlcnkiLCJpbnB1dCIsIl90b2dnbGVTdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImVuYWJsZVZhbGlkYXRpb24iLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiQ2FyZCIsImRhdGEiLCJvbkNhcmRDbGljayIsInJlbW92ZUhhbmRsZXIiLCJsaWtlQ2xpY2tIYW5kbGVyIiwidGVtcGxhdGUiLCJ1c2VySWQiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfb3duZXJJZCIsIm93bmVyIiwiX2lkIiwiX2NhcmRJZCIsIl9saWtlcyIsImxpa2VzIiwiX3VzZXJJZCIsIl90ZW1wbGF0ZSIsIl9vbkNhcmRDbGljayIsIl9saWtlQ2xpY2tIYW5kbGVyIiwiX3JlbW92ZUhhbmRsZXIiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEF0dHJpYnV0ZXMiLCJjYXJkRWxlbWVudCIsImF0dHJpYnMiLCJrZXkiLCJzZXRBdHRyaWJ1dGUiLCJkZWxldGVDYXJkIiwiX2NhcmQiLCJfaGFuZGVsTGlrZSIsImxpa2VCdG4iLCJ0b2dnbGUiLCJfbGlrZVN0YXR1cyIsIl9jYXJkRWxlbWVudCIsImVsZW1lbnQiLCJnZXRDYXJkSWQiLCJnZW5lcmF0ZUNhcmQiLCJzcmMiLCJhbHQiLCJsZW5ndGgiLCJjaGVja0lmTGlrZWQiLCJ1c2VyIiwiZmluZCIsImxpa2UiLCJfbGlrZWQiLCJfY2FyZExpa2VkIiwiX2NhcmRVbmxpa2VkIiwiaXNMaWtlZCIsInJlZnJlc2hDYXJkIiwiTW9kYWwiLCJtb2RhbFNlbGVjdG9yIiwiY2hlY2tLZXlQcmVzcyIsIl9tb2RhbEVsZW1lbnQiLCJkb2N1bWVudCIsIl9lc2NhcGVLZXlIYW5kbGVyIiwiYmluZCIsIl9jaGVja0tleVByZXNzIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJNb2RhbFdpdGhGb3JtIiwic2VsZWN0b3IiLCJoYW5kbGVTdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVTdWJtaXQiLCJfc3VibWl0QnV0dG9uIiwiX2Zvcm0iLCJfdGV4dEluQnV0dG9uIiwiZ2V0SW5wdXRWYWx1ZXMiLCJfaW5wdXRMaXN0IiwiZm9ybUlucHV0VmFsdWVzIiwidmFsdWUiLCJfZW50cmVkVmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsImVudHJlZFZhbHVlIiwiY29uc29sZSIsImxvZyIsInJlc2V0IiwiU2VjdGlvbiIsIml0ZW1zIiwicmVuZGVyZXIiLCJjb250YWluZXJTZWxlY3RvciIsIl9yZW5kZXJlZEVsZW1lbnRzIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJwcmVwZW5kIiwiZWRpdEJ1dHRvbiIsInByb2ZpbGVNb2RhbCIsInByb2ZpbGVOYW1lIiwibmFtZUlucHV0IiwicHJvZmlsZUpvYiIsImpvYklucHV0IiwidXNlckF2YXRhciIsImF2YXRhckVkaXRCdXR0b24iLCJhdmF0YXJNb2RhbCIsImF2YXRhck1vZGFsSW5wdXQiLCJhZGRDYXJkQnV0dG9uIiwiYWRkQ2FyZE1vZGFsIiwiY2FyZElucHV0VGl0bGUiLCJjYXJkSW5wdXRMaW5rIiwiYWRkQ2FyZEZvcm0iLCJmb3JtcyIsImNhcmRUZW1wbGF0ZSIsImVsZW1lbnRzIiwidGl0bGUiLCJiaWdJbWFnZU1vZGFsIiwiYmlnSW1hZ2UiLCJiaWdJbWFnZVRpdGxlIiwiZm9ybVNlbGVjdG9yIiwiY2hlY2tGb3JFc2NQcmVzc2VkIiwibW9kYWxSZXNldElucHV0cyIsImFwaUVyciIsImVyciIsImFwaSIsImNvbmZpZyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsIl9yZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwiZ2V0Q2FyZExpc3QiLCJmZXRjaCIsInRoZW4iLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZENhcmQiLCJyZW1vdmVDYXJkIiwiY2FyZElkIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwic2V0VXNlckF2YXRhciIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJwcm9maWxlIiwibmFtZUVsZW1lbnQiLCJ0aXRsZUVsZW1lbnQiLCJwaWN0dXJlRWxlbWVudCIsIl9uYW1lRWxlbWVudCIsIl90aXRsZUVsZW1lbnQiLCJfcGljdHVyZUVsZW1lbnQiLCJqb2IiLCJfam9iIiwiZ2V0VXNlckRhdGEiLCJfZGF0YSIsInVzZXJJRCIsImRlbGV0ZUNhcmRIYW5kbGVyIiwiZGVsZXRlQ2FyZE1vZGFsIiwiZGVsZXRlQ29uZmlybSIsImNhcmQiLCJjYXRjaCIsIm5ld0NhcmRJbnN0YW5jZSIsImNhcmREYXRhIiwiY2FyZFNlY3Rpb24iLCJjYXJkSW5zdGFuY2UiLCJhZGROZXdDYXJkTW9kYWwiLCJ0aXRsZUlucHV0IiwibGlua0lucHV0IiwiYWRkTmV3Q2FyZEluc3RhbmNlIiwiZWRpdFByb2ZpbGVNb2RhbCIsImF2YXRhckVkaXRNb2RhbCIsImF2YXRhckxpbmtJbnB1dCIsImZpbmFsbHkiLCJtb2RhbCIsIl9tb2RhbEltYWdlIiwiX21vZGFsVGl0bGUiXSwic291cmNlUm9vdCI6IiJ9