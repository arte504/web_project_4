!function(){"use strict";class e{constructor({cardData:e,isLiked:t,isOwner:s,onCardClick:r,removeHandler:i,likeHandler:n},o){this._name=e.name,this._link=e.link,this._id=e._id,this._ownerId=e.owner._id,this._likes=e.likes,this._likesCount=e.likes.length,this._cardSelector=o,this._onCardClick=r,this._onCardClick=this._onCardClick.bind(this),this._likeHandler=n,this._clickLikeHandler=this._clickLikeHandler.bind(this),this._removeHandler=i,this._removeHandler=this._removeHandler.bind(this),this._isLiked=t,this._isLiked=this._isLiked.bind(this),this._isOwner=s,this._isOwner=this._isOwner.bind(this)}_getTemplate(){return document.querySelector("#card__template").content.querySelector(".card").cloneNode(!0)}likesAmountSet(e){this._item.querySelector(".card__like-count").textContent=e}_likeCard(e){this._item.querySelector("card__like").classList.toggle("card__like-button_active"),this._likeHandler(this),e.stopImmediatePropogation()}deleteCard(){this._item.remove(),this._item=null}_deleteCardHandler(e){e.stopImmediatePropagation(),this._deleteCardHandler(this._id,this)}_setEventListeners(){this._item.querySelector(".card__like-button").addEventListener("click",(e=>{this._likeCard(e)})),this._item.querySelector(".card__delete-button").addEventListener("click",(e=>{this._deleteCardHandler(e)})),this._cardImage.addEventListener("click",(e=>{this._onCardClick(e)}))}generateCard(){return this._item=this._getTemplate(),!0===this._isLiked(this._likes)?this._element.querySelector(".card__like-button").classList.add("card__like_active"):this._element.querySelector(".card__like-button").classList.remove("card__like_active"),!0!==this._isOwner(this._ownerId)&&this._element.querySelector(".card__delete-button").classList.add("card__delete-button_hidden"),this._cardImage=this._item.querySelector(".card__image"),this._setEventListeners(),this._item.querySelector(".card__title").textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=`Image of  ${this._name} `,this._setEventListeners(),this._item}getID(){return this._id}}class t{constructor(e,t){this._formConfig=e,this._formElement=t}_showInputError=(e,t)=>{const{inputErrorClass:s,errorMessageClass:r}=this._formConfig,i=this._formElement.querySelector(` #${e.id}_error `);i.textContent=t,i.classList.add(r),e.classList.add(s)};_hideInputError=e=>{const{inputErrorClass:t,errorMessageClass:s}=this._formConfig,r=this._formElement.querySelector(` #${e.id}_error `);r.textContent="",r.classList.remove(s),e.classList.remove(t)};resetValidation(){this.inputs.forEach((e=>{this._hideInputError(e)})),this._toggleSubmitButton()}_checkInput=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)};_checkIfFormValid=()=>this.inputs.every((e=>e.validity.valid));_toggleSubmitButton(){const{inactiveButtonClass:e,submitButtonSelector:t}=this._formConfig,s=this._formElement.querySelector(t);this._checkIfFormValid()?(s.disabled=!1,s.classList.remove(e)):(s.disabled=!0,s.classList.add(e))}_setEventListeners=()=>{const{inputSelector:e}=this._formConfig;return this.inputs=Array.from(this._formElement.querySelectorAll(e)),this.inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInput(e),this._toggleSubmitButton()}))})),this._formElement};enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class s{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}addItem(e){this._container.prepend(e)}clear(){this._container.innerHTML=""}renderItems(){this.clear(),this._items.forEach((e=>{this._renderer(e)}))}}const r=document.querySelector(".profile__edit-button"),i=document.forms.profile,n=(i.elements.name,i.elements.job,document.querySelector(".modal__close-button_type_edit"),document.querySelector(".profile__add-button")),o=document.querySelector(".modal_type_add-card"),a=(document.querySelector(".modal__input_type_name"),document.querySelector(".modal__input_type_link"),document.querySelector(".modal__close-button_type_add-card"),document.forms.add),l=(a.elements.title,a.elements.link,document.querySelector(".modal__submit-button"),document.querySelector(".cards__grid"),document.querySelector(".modal_type_big-image"),document.querySelector(".modal__big-image"),document.querySelector(".modal__image-caption"),document.querySelector(".modal__close-button_type_big-image"),{formSelector:".modal__container",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_error",errorMessageClass:"modal__error_visible"});class d{constructor(e){this._modalElement=document.querySelector(e)}_checkForEscClose=e=>{"Escape"===e.key&&this.close()};open=()=>{this._modalElement.classList.add("modal_visible"),document.addEventListener("keyup",this._checkForEscClose)};close=()=>{this._modalElement.classList.remove("modal_visible"),document.removeEventListener("keyup",this._checkForEscClose)};setEventListeners(){this._modalElement.querySelector(".modal__close-button").addEventListener("click",(e=>{this.close(e)})),this._modalElement.addEventListener("click",(e=>{e.target.classList.contains("modal_visible")&&this.close(e)}))}}class c extends d{constructor(e,t){super(e),this._handleSubmitBtn=t,this._formElement=this._modalElement.querySelector(".modal__container")}getInputValues(){const e=Array.from(this._formElement.querySelectorAll(".modal__input")),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setInputValues(e){Array.from(this._formElement.querySelectorAll(".modal__input")).forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(()=>{this._handleSubmitBtn(this.getInputValues()),this.close(),this._formElement.reset()}))}close(){super.close(),this._formElement.reset()}}class _ extends d{constructor(e,t){super(e),this._form=document.querySelector(this._selector),this._handleSubmit=t,this._handleSubmitHandler=this._handleSubmitHandler.bind(this)}_handleSubmitHandler(e){e.preventDefault(),this._handleSubmit(),super.close()}_setEventListeners(){super._setEventListeners(),this._form.addEventListener("submit",this._handleSubmitHandler)}_removeEventListeners(){super._removeEventListeners(),this._form.removeEventListener("submit",this._handleSubmitHandler)}}const m=new class{constructor({baseUrl:e,headers:t}){this.baseUrl=e,this.headers=t}getInitialCards(){return fetch(this.baseUrl+"/cards",{headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch(this.baseUrl+"/users/me",{headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addCard({name:e,link:t}){return fetch(this.baseUrl+"/cards",{headers:this.headers,method:"POST",body:JSON.stringify({name:e,link:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}removeCard(e){return fetch(this.baseUrl+"/cards/"+e,{headers:this.headers,method:"DELETE"}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}addLike(e){return fetch(this.baseUrl+"/cards/likes/"+e.getId(),{headers:this.headers,method:"PUT"}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}removeLike(e){return fetch(this.baseUrl+"/cards/likes/"+e.getId(),{headers:this.headers,method:"DELETE"}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateUserInfo({name:e,about:t}){return fetch(this.baseUrl+"/users/me",{headers:this.headers,method:"PATCH",body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setUserAvatar({avatar:e}){return fetch(this.baseUrl+"/users/me/avatar",{headers:this.headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"709a0d9d-db06-4890-a594-b07e7309a353","Content-Type":"application/json"}});function h(t,s,r){return new e({cardData:t,isLiked:e=>void 0!==e.find((e=>e._id===s._id)),isOwner:e=>s._id===e,onCardClick:e=>{u.open(e)},deleteCardHandler:(e,t)=>{const s=new _(".delete-card",(()=>{m.removeCard(e).then((e=>t.removeCard())).catch((e=>console.log(e))).finally((function(){s.close()}))}));s.open()},likeHandler:e=>{void 0!==e._likes.find((e=>e._id===s._id))?m.removeLike(e).then((t=>{e._likes=t.likes,e.setLikes(t.likes.length)})):m.addLike(e).then((t=>{e._likes=t.likes,e.setLikes(t.likes.length)}))}},"#card")}m.getAppInfo().then((([e,t])=>{const r=new s({data:e,renderer:function(e){const s=h(e,t);r.addItem(s.generateCard())}},".cards__grid");r.renderItems(),user.setUserInfo({name:t.name,job:t.about}),user.setUserAvatar({avatar:t.avatar});const i=new c(".add-card",(e=>{m.addCard({name:e.name,link:e.link}).then((e=>{const s=h(e,t);r.addItem(s.generateCard())})).catch((e=>console.log(e))).finally((function(){i.close()}))}));n.addEventListener("click",(()=>{E.resetValidation(),i.open()}))})).catch((e=>console.log(e)));const u=new class extends d{openup=e=>{const t=e.target;this._modalElement.querySelector(".modal__big-image").src=t.src,this._modalElement.querySelector(".modal__big-image").alt=t.alt,this._modalElement.querySelector(".modal__image-caption").textContent=t.alt,this.open()}}(".modal_type_big-image");u.setEventListeners();const p=new class{constructor({name:e,job:t,avatar:s}){this._name=document.querySelector(`${e}`),this._job=document.querySelector(`${t}`),this._avatar=document.querySelector(`${s}`)}getUserInfo(){return{name:this._name.textContent,job:this._job.textContent,avatar:this._avatar.src}}setUserInfo({name:e,job:t}){this._name.textContent=e,this._job.textContent=t}setUserAvatar({avatar:e}){this._avatar.src=e}}(".profile__title",".profile__subtitle"),b=new c(".modal_type_edit",(e=>{p.setUserInfo(b.getInputValues()),b.close()}));b.setEventListeners(),r.addEventListener("click",(()=>{b.setInputValues(p.getUserInfo()),v.resetValidation(),b.open()}));const k=new c(".modal_type_add-card",(()=>{const e=k.getInputValues();cardsSection.prependItem(createCard(e)),k.close()}));k.setEventListeners();const v=new t(l,i);v.enableValidation();const E=new t(l,o);E.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxLQUN0Q3JHLEtBQUttTSxRQUFVOUssU0FBU0MsY0FBZSxHQUFFNkksS0FHM0NoQixjQUNFLE1BQU8sQ0FDUGpKLEtBQU9GLEtBQUtDLE1BQU0yQixZQUNsQnlFLElBQU1yRyxLQUFLa00sS0FBS3RLLFlBQ2hCdUksT0FBUW5LLEtBQUttTSxRQUFRdkosS0FJdkIrSSxhQUFhLEtBQUN6TCxFQUFELElBQU9tRyxJQUNsQnJHLEtBQUtDLE1BQU0yQixZQUFjMUIsRUFDekJGLEtBQUtrTSxLQUFLdEssWUFBY3lFLEVBRzFCNkQsZUFBZSxPQUFDQyxJQUNkbkssS0FBS21NLFFBQVF2SixJQUFNdUgsSUgrRmEsa0JBQW1CLHNCQUtqRGlDLEVBQWtCLElBQUkvRSxFQUFjLG9CQUFxQm9FLElBQzdEUSxFQUFlTixZQUFZUyxFQUFnQjNFLGtCQUMzQzJFLEVBQWdCckYsV0FHbEJxRixFQUFnQmxGLG9CQUVoQm5CLEVBQVd4RCxpQkFBaUIsU0FBUyxLQUNuQzZKLEVBQWdCdkUsZUFBZW9FLEVBQWU5QyxlQUM5Q2tELEVBQXNCekksa0JBQ3RCd0ksRUFBZ0JwRixVQUlsQixNQUFNVCxFQUFjLElBQUljLEVBQWMsd0JBQXdCLEtBQzVELE1BQU13RSxFQUFVdEYsRUFBWWtCLGlCQUM1QitELGFBQWFjLFlBQVlDLFdBQVdWLElBQ3BDdEYsRUFBWVEsV0FHZFIsRUFBWVcsb0JBSVosTUFBTW1GLEVBQXdCLElBQUl0SixFQUFjQyxFQUFZZ0QsR0FDNURxRyxFQUFzQnRILG1CQUV0QixNQUFNK0csRUFBd0IsSUFBSS9JLEVBQWNDLEVBQVlzRCxHQUM1RHdGLEVBQXNCL0csbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9zY3JpcHRzL01vZGFsV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxEZWxldGVDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9JbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvc2NyaXB0cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL3NjcmlwdHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKHtjYXJkRGF0YSwgaXNMaWtlZCwgaXNPd25lciwgb25DYXJkQ2xpY2ssIHJlbW92ZUhhbmRsZXIsIGxpa2VIYW5kbGVyfSwgY2FyZFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gY2FyZERhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBjYXJkRGF0YS5saW5rO1xyXG4gICAgdGhpcy5faWQgPSBjYXJkRGF0YS5faWQ7XHJcbiAgICB0aGlzLl9vd25lcklkID0gY2FyZERhdGEub3duZXIuX2lkO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBjYXJkRGF0YS5saWtlcztcclxuICAgIHRoaXMuX2xpa2VzQ291bnQgPSBjYXJkRGF0YS5saWtlcy5sZW5ndGg7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcblxyXG4gICAgdGhpcy5fb25DYXJkQ2xpY2sgPSBvbkNhcmRDbGljaztcclxuICAgIHRoaXMuX29uQ2FyZENsaWNrID0gdGhpcy5fb25DYXJkQ2xpY2suYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2xpa2VIYW5kbGVyID0gbGlrZUhhbmRsZXI7XHJcbiAgICB0aGlzLl9jbGlja0xpa2VIYW5kbGVyID0gdGhpcy5fY2xpY2tMaWtlSGFuZGxlci5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5fcmVtb3ZlSGFuZGxlciA9IHJlbW92ZUhhbmRsZXI7XHJcbiAgICB0aGlzLl9yZW1vdmVIYW5kbGVyID0gdGhpcy5fcmVtb3ZlSGFuZGxlci5iaW5kKHRoaXMpO1xyXG5cclxuICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IHRoaXMuX2lzTGlrZWQuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2lzT3duZXIgPSBpc093bmVyO1xyXG4gICAgdGhpcy5faXNPd25lciA9IHRoaXMuX2lzT3duZXIuYmluZCh0aGlzKTtcclxuICB9XHJcbiAgLy8gLS0tIEdldHRpbmcgdGhlIHRlbXBsYXRlIC0tLSAvL1xyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIiNjYXJkX190ZW1wbGF0ZVwiKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHJldHVybiBjYXJkO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIFNldCB0aGUgbGlrZXMgYW1vdW50IG9mIGEgY2FyZCAtLS0gLy9cclxuICBsaWtlc0Ftb3VudFNldChsaWtlc0NvdW50KSB7XHJcbiAgICB0aGlzLl9pdGVtLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50JykudGV4dENvbnRlbnQgPSBsaWtlc0NvdW50O1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIFRvZ2dsZSBsaWtlIGJ1dHRvbiBtZXRob2QgLS0tIC8vXHJcbiAgX2xpa2VDYXJkKGV2ZW50KSB7XHJcbiAgICBjb25zdCBsaWtlRWxlbWVudCA9IHRoaXMuX2l0ZW0ucXVlcnlTZWxlY3RvcignY2FyZF9fbGlrZScpO1xyXG4gICAgbGlrZUVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIHRoaXMuX2xpa2VIYW5kbGVyKHRoaXMpO1xyXG4gICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BvZ2F0aW9uKCk7XHJcbiAgfVxyXG4gIC8vIC0tLSBDYXJkIGRlbGV0aW5nIG1ldGhvZCAtLS0gLy9cclxuICBkZWxldGVDYXJkKCkge1xyXG4gICAgdGhpcy5faXRlbS5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2l0ZW0gPSBudWxsIFxyXG4gIH1cclxuICAvLyAtLS0gVGhlIGNhcmQgZGVsZXRpbmcgZXZlbnQgaGFuZGxlciAtLS0gLy9cclxuICBfZGVsZXRlQ2FyZEhhbmRsZXIoZXZlbnQpIHtcclxuICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG4gICAgdGhpcy5fZGVsZXRlQ2FyZEhhbmRsZXIodGhpcy5faWQsIHRoaXMpO1xyXG4gIH1cclxuICBcclxuICAvLyAtLS0gU2V0IGV2ZW50cyBsaXN0ZW5lcnMgZm9yIHRoZSBjYXJkcyB0aGF0IHdpbGwgYmUgY3JlYXRlZCEgLS0tIC8vXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faXRlbVxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2xpa2VDYXJkKGV2ZW50KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgdGhpcy5faXRlbVxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQ2FyZEhhbmRsZXIoZXZlbnQpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgICB0aGlzLl9vbkNhcmRDbGljayhldmVudCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIENyZWF0aW5nIHRoZSBjYXJkIGFuZCBjYXJkIGVsZW1lbnRzIC0tLSAvL1xyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2l0ZW0gPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG5cclxuICAgIGlmICh0aGlzLl9pc0xpa2VkKHRoaXMuX2xpa2VzKSA9PT0gdHJ1ZSkge1xyXG4gICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ1dHRvbicpLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2VfYWN0aXZlJyk7XHJcbiAgICB9IFxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJykuY2xhc3NMaXN0LnJlbW92ZSgnY2FyZF9fbGlrZV9hY3RpdmUnKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5faXNPd25lcih0aGlzLl9vd25lcklkKSAhPT0gdHJ1ZSkge1xyXG4gICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnV0dG9uJykuY2xhc3NMaXN0LmFkZCgnY2FyZF9fZGVsZXRlLWJ1dHRvbl9oaWRkZW4nKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9pdGVtXHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2l0ZW1cclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIilcclxuICAgICAgLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9ICdJbWFnZSBvZiAnK2AgJHt0aGlzLl9uYW1lfSBgO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2l0ZW07XHJcbiAgfVxyXG5cclxuICBnZXRJRCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pZDtcclxuICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihmb3JtQ29uZmlnLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fZm9ybUNvbmZpZyA9IGZvcm1Db25maWc7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSA9PiB7XHJcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JNZXNzYWdlQ2xhc3MgfSA9IHRoaXMuX2Zvcm1Db25maWc7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAgIyR7aW5wdXRFbGVtZW50LmlkfV9lcnJvciBgKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGVycm9yTWVzc2FnZUNsYXNzKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuICBcclxuICBfaGlkZUlucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JNZXNzYWdlQ2xhc3MgfSA9IHRoaXMuX2Zvcm1Db25maWc7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAgIyR7aW5wdXRFbGVtZW50LmlkfV9lcnJvciBgKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShlcnJvck1lc3NhZ2VDbGFzcyk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShpbnB1dEVycm9yQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fdG9nZ2xlU3VibWl0QnV0dG9uKCk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dCA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJZkZvcm1WYWxpZCA9ICgpID0+IHRoaXMuaW5wdXRzLmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG5cclxuICBfdG9nZ2xlU3VibWl0QnV0dG9uKCkge1xyXG4gICAgY29uc3QgeyBpbmFjdGl2ZUJ1dHRvbkNsYXNzLCBzdWJtaXRCdXR0b25TZWxlY3RvciB9ID0gdGhpcy5fZm9ybUNvbmZpZztcclxuICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuXHJcbiAgICBpZiAodGhpcy5fY2hlY2tJZkZvcm1WYWxpZCgpKSB7XHJcbiAgICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChpbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcclxuICAgIGNvbnN0IHsgaW5wdXRTZWxlY3RvciB9ID0gdGhpcy5fZm9ybUNvbmZpZztcclxuICAgIHRoaXMuaW5wdXRzID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGlucHV0U2VsZWN0b3IpKTtcclxuXHJcbiAgICB0aGlzLmlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXQoaW5wdXQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZVN1Ym1pdEJ1dHRvbigpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1FbGVtZW50O1xyXG4gIH07XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcblxyXG4gIGNsZWFyICgpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5jbGVhcigpO1xyXG4gICAgXHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChjYXJkKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGNhcmQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsIi8vIC0tICdFZGl0IHByb2ZpbGUnIG1vZGFsIGNvbnN0cyAtLSAvL1xyXG5leHBvcnQgY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZU1vZGFsID0gZG9jdW1lbnQuZm9ybXMucHJvZmlsZTtcclxuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IHByb2ZpbGVNb2RhbC5lbGVtZW50cy5uYW1lO1xyXG5leHBvcnQgY29uc3Qgam9iSW5wdXQgPSBwcm9maWxlTW9kYWwuZWxlbWVudHMuam9iO1xyXG5leHBvcnQgY29uc3QgZWRpdENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9lZGl0Jyk7XHJcbi8vIC0tICdBZGQtY2FyZCcgbW9kYWwgY29uc3RzIC0tIC8vXHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2FkZC1jYXJkJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkSW5wdXRUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW5wdXRfdHlwZV9uYW1lJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkSW5wdXRMaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbnB1dF90eXBlX2xpbmsnKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UtYnV0dG9uX3R5cGVfYWRkLWNhcmQnKTtcclxuLy8gLS0tICdBZGQtQ2FyZCcgZm9ybSBjb25zdHMgLS0tIC8vXHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zLmFkZDtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtVGl0ZWwgPSBhZGRDYXJkRm9ybS5lbGVtZW50cy50aXRsZTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtTGluayA9IGFkZENhcmRGb3JtLmVsZW1lbnRzLmxpbms7XHJcbi8vIC0tLSBHZW5lcmFsIGNvbnN0IC0tLSAvL1xyXG5leHBvcnQgY29uc3Qgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19zdWJtaXQtYnV0dG9uJyk7XHJcbmV4cG9ydCBjb25zdCBjYXJkTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkc19fZ3JpZCcpO1xyXG4vLyAtLS0gQmlnIGltYWdlIG1vZGFsIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGNhcmRCaWdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF90eXBlX2JpZy1pbWFnZScpO1xyXG5leHBvcnQgY29uc3QgY2FyZEJpZ01vZGFsSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2JpZy1pbWFnZScpO1xyXG5leHBvcnQgY29uc3QgY2FyZEJpZ01vZGFsVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW1hZ2UtY2FwdGlvbicpO1xyXG5leHBvcnQgY29uc3QgY2FyZEJpZ01vZGFsQ2xvc2VJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b25fdHlwZV9iaWctaW1hZ2UnKTtcclxuLy8gLS0tIEZvcm0gY29uZmlnIGNvbnN0cyAtLS0gLy9cclxuZXhwb3J0IGNvbnN0IGZvcm1Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fY29udGFpbmVyXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfZXJyb3JcIixcclxuICBlcnJvck1lc3NhZ2VDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiXHJcbn07XHJcbi8vIC0tLSBpbml0Q2FyZHMgY29uc3RzIC0tLSAvL1xyXG5leHBvcnQgY29uc3QgaW5pdENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xha2UtbG91aXNlLmpwZ1wiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIlxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzZS5qcGdcIlxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiXHJcbiAgfVxyXG5dOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG1vZGFsU2VsZWN0b3IpO1xyXG4gIH1cclxuICAvLyAtLS0gQ2xvc2UgbW9kYWwgb24gRVNDIG1ldGhvZCAtLS0gLy9cclxuICBfY2hlY2tGb3JFc2NDbG9zZSA9IChldmVudCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIC0tLSBPcGVuIG1vZGFsIG1ldGhvZCAtLS0gLy8gXHJcbiAgb3BlbiA9ICgpID0+IHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfdmlzaWJsZVwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9jaGVja0ZvckVzY0Nsb3NlKTtcclxuICB9XHJcbiAgLy8gLS0tIENsb3NlIG1vZGFsIG1ldGhvZCAtLS0gLy9cclxuICBjbG9zZSA9ICgpID0+IHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfdmlzaWJsZVwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9jaGVja0ZvckVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gLS0tIENsb3NlIG1vZGFsIG9uIGNsb3NlKCdYJykgYnV0dG9uIC0tLSAvL1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpXHJcbiAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICB0aGlzLmNsb3NlKGV2ZW50KTtcclxuICAgIH0pO1xyXG4gICAgLy8gQ2xvc2UgbW9kYWwgb24gb3ZlcmxheShvdXQgb2YgdGhlIG1vZGFsKSBjbGljayAtLS0gLy8vXHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX3Zpc2libGVcIikpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKGV2ZW50KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59IiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhGb3JtIGV4dGVuZHMgTW9kYWwge1xyXG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdCkge1xyXG4gICAgc3VwZXIobW9kYWxTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXRCdG4gPSBoYW5kbGVTdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jb250YWluZXJcIik7XHJcbiAgfVxyXG5cclxuICBnZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXHJcbiAgICApO1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge2lucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7fSk7XHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRJbnB1dFZhbHVlcyh2YWx1ZXMpIHtcclxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXHJcbiAgICApO1xyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7aW5wdXQudmFsdWUgPSB2YWx1ZXNbaW5wdXQubmFtZV07fSlcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXRCdG4odGhpcy5nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gIH1cclxufSIsImltcG9ydCBNb2RhbCBmcm9tICcuL01vZGFsLmpzJztcclxuICBcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxEZWxldGVDb25maXJtYXRpb24gZXh0ZW5kcyBNb2RhbCB7XHJcbiAgY29uc3RydWN0b3IgKHNlbGVjdG9yLCBoYW5kbGVTdWJtaXQpIHtcclxuICAgIHN1cGVyKHNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Zvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3NlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEhhbmRsZXIgPSB0aGlzLl9oYW5kbGVTdWJtaXRIYW5kbGVyLmJpbmQodGhpcyk7XHJcbiAgfVxyXG4gIFxyXG4gIF9oYW5kbGVTdWJtaXRIYW5kbGVyIChldmVudCkge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcbiAgXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzICgpIHtcclxuICAgIHN1cGVyLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9oYW5kbGVTdWJtaXRIYW5kbGVyKTtcclxuICB9XHJcbiAgXHJcbiAgX3JlbW92ZUV2ZW50TGlzdGVuZXJzICgpIHtcclxuICAgIHN1cGVyLl9yZW1vdmVFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9oYW5kbGVTdWJtaXRIYW5kbGVyKTtcclxuICB9XHJcbn0iLCJpbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvQXBpLmpzXCI7XHJcbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGVkaXRCdXR0b24sXHJcbiAgcHJvZmlsZU1vZGFsLFxyXG4gIGFkZENhcmRCdXR0b24sXHJcbiAgYWRkQ2FyZE1vZGFsLFxyXG4gIGZvcm1Db25maWdcclxufSBmcm9tIFwiLi4vY29tcG9uZW50cy91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IE1vZGFsV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL3NjcmlwdHMvTW9kYWxXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IE1vZGFsV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2NyaXB0cy9Nb2RhbFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBNb2RhbERlbGV0ZUNvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL01vZGFsRGVsZXRlQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9zY3JpcHRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiAnaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMicsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogJzcwOWEwZDlkLWRiMDYtNDg5MC1hNTk0LWIwN2U3MzA5YTM1MycsXHJcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgfVxyXG59KTtcclxuXHJcbi8vICsrKysrIENhcmQgU2VjdGlvbiArKysrKyAvL1xyXG5jb25zdCBjYXJkU2VsZWN0b3IgPSAnI2NhcmQnO1xyXG4vLyAtLS0gQ2FyZCByZW5kZXIgZnVuY3Rpb24gLS0tIC8vXHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQgKGluaXRDYXJkLCB1c2VyLCBzZWxlY3Rvcikge1xyXG4gIHJldHVybiBuZXcgQ2FyZCh7XHJcbiAgICBjYXJkRGF0YTogaW5pdENhcmQsXHJcbiAgICBpc0xpa2VkOiAobGlzdExpa2VzKSA9PiB7XHJcbiAgICAgIHJldHVybiAobGlzdExpa2VzLmZpbmQoaXRlbSA9PiBpdGVtLl9pZCA9PT0gdXNlci5faWQpICE9PSB1bmRlZmluZWQpO1xyXG4gICAgfSxcclxuICAgIGlzT3duZXI6IChvd25lcikgPT4ge1xyXG4gICAgICByZXR1cm4gKHVzZXIuX2lkID09PSBvd25lcik7XHJcbiAgICB9LFxyXG4gICAgb25DYXJkQ2xpY2s6IChjYXJkSW5mbykgPT4ge1xyXG4gICAgICBiaWdJbWFnZU1vZGFsLm9wZW4oY2FyZEluZm8pO1xyXG4gICAgfSxcclxuICAgIGRlbGV0ZUNhcmRIYW5kbGVyOiAoaWQsIGNhcmQpID0+IHtcclxuICAgICAgY29uc3QgZGVsZXRlQ29uZmlybSA9IG5ldyBNb2RhbERlbGV0ZUNvbmZpcm1hdGlvbignLmRlbGV0ZS1jYXJkJywgKCkgPT4ge1xyXG4gICAgICAgIGFwaS5yZW1vdmVDYXJkKGlkKVxyXG4gICAgICAgICAgLnRoZW4ocmVzID0+IGNhcmQucmVtb3ZlQ2FyZCgpKVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXHJcbiAgICAgICAgICAuZmluYWxseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZUNvbmZpcm0uY2xvc2UoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgICAgZGVsZXRlQ29uZmlybS5vcGVuKCk7XHJcbiAgICB9LFxyXG4gICAgbGlrZUhhbmRsZXI6IChjYXJkSW5mbykgPT4ge1xyXG4gICAgICBpZiAoY2FyZEluZm8uX2xpa2VzLmZpbmQoaXRlbSA9PiBpdGVtLl9pZCA9PT0gdXNlci5faWQpICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBhcGkucmVtb3ZlTGlrZShjYXJkSW5mbylcclxuICAgICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIGNhcmRJbmZvLl9saWtlcyA9IHJlcy5saWtlcztcclxuICAgICAgICAgICAgY2FyZEluZm8uc2V0TGlrZXMocmVzLmxpa2VzLmxlbmd0aCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSBcclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgYXBpLmFkZExpa2UoY2FyZEluZm8pXHJcbiAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBjYXJkSW5mby5fbGlrZXMgPSByZXMubGlrZXM7XHJcbiAgICAgICAgICAgIGNhcmRJbmZvLnNldExpa2VzKHJlcy5saWtlcy5sZW5ndGgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSxcclxuICBjYXJkU2VsZWN0b3IpO1xyXG59XHJcblxyXG5hcGkuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oKFtpbml0aWFsQ2FyZHMsIHVzZXJJbmZvXSkgPT4ge1xyXG4gICAgY29uc3QgY2FyZHNTZWN0aW9uID0gbmV3IFNlY3Rpb24oe1xyXG4gICAgICBkYXRhOiBpbml0aWFsQ2FyZHMsXHJcbiAgICAgIHJlbmRlcmVyOiBmdW5jdGlvbiAoaW5pdGlhbENhcmQpIHtcclxuICAgICAgICBjb25zdCBjYXJkID0gcmVuZGVyQ2FyZChpbml0aWFsQ2FyZCwgdXNlckluZm8sIGNhcmRTZWxlY3Rvcik7XHJcbiAgICAgICAgY2FyZHNTZWN0aW9uLmFkZEl0ZW0oY2FyZC5nZW5lcmF0ZUNhcmQoKSk7XHJcbiAgICAgIH1cclxuICAgIH0sICcuY2FyZHNfX2dyaWQnKTtcclxuICAgIGNhcmRzU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG5cclxuICAgIHVzZXIuc2V0VXNlckluZm8oe1xyXG4gICAgICBuYW1lOiB1c2VySW5mby5uYW1lLFxyXG4gICAgICBqb2I6IHVzZXJJbmZvLmFib3V0XHJcbiAgICB9KTtcclxuXHJcbiAgICB1c2VyLnNldFVzZXJBdmF0YXIoe1xyXG4gICAgICBhdmF0YXI6IHVzZXJJbmZvLmF2YXRhclxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgbW9kYWxBZGRDYXJkID0gbmV3IE1vZGFsV2l0aEZvcm0oJy5hZGQtY2FyZCcsIChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICBhcGkuYWRkQ2FyZCh7IG5hbWU6IGNhcmREYXRhLm5hbWUsIGxpbms6IGNhcmREYXRhLmxpbmsgfSlcclxuICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBuZXdDYXJkID0gcmVuZGVyQ2FyZChyZXMsIHVzZXJJbmZvLCBjYXJkU2VsZWN0b3IpO1xyXG4gICAgICAgICAgY2FyZHNTZWN0aW9uLmFkZEl0ZW0obmV3Q2FyZC5nZW5lcmF0ZUNhcmQoKSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgICAgICAuZmluYWxseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBtb2RhbEFkZENhcmQuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIGFkZENhcmRGb3JtVmFsaWRhdGlvbi5yZXNldFZhbGlkYXRpb24oKTtcclxuICAgICAgbW9kYWxBZGRDYXJkLm9wZW4oKTtcclxuICAgIH0pO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG5cclxuLy8gLS0tIE1vZGFsV2l0aEltYWdlIGluc3RhbmNlIC0tLSAvL1xyXG5jb25zdCBiaWdJbWFnZU1vZGFsID0gbmV3IE1vZGFsV2l0aEltYWdlKFwiLm1vZGFsX3R5cGVfYmlnLWltYWdlXCIpO1xyXG5iaWdJbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLyArKysrKyAnVXNlciBJbmZvJyArKysrKyAvL1xyXG4vLyAtLS0gVXNlckluZm8gaW5zdGFuY2UgLS0tIC8vXHJcbmNvbnN0IHVzZXJJbmZvVmFsdWVzID0gbmV3IFVzZXJJbmZvKFwiLnByb2ZpbGVfX3RpdGxlXCIsIFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIpO1xyXG5cclxuLy8gKysrKysgRm9ybXMgKysrKysgLy9cclxuLy8gPT09ICdFZGl0IHByb2ZpbGUnIGZvcm0gPT09IC8vXHJcbi8vIC0tLSBGb3JtIGNyZWF0aW9uIG1ldGhvZCAtLS0gLy9cclxuY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gbmV3IE1vZGFsV2l0aEZvcm0oXCIubW9kYWxfdHlwZV9lZGl0XCIsIChkYXRhKSA9PiB7XHJcbiAgdXNlckluZm9WYWx1ZXMuc2V0VXNlckluZm8oZWRpdFByb2ZpbGVGb3JtLmdldElucHV0VmFsdWVzKCkpO1xyXG4gIGVkaXRQcm9maWxlRm9ybS5jbG9zZSgpO1xyXG59KTtcclxuLy8gLS0tIFNldCBldmVudCBsaXN0ZW5lcnMgZm9yIHRoZSBmb3JtIC0tLSAvL1xyXG5lZGl0UHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuLy8gLS0tIFNldCB2YWx1ZXMgYW5kIG9wZW4gdGhlIGZvcm0gLS0tIC8vXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBlZGl0UHJvZmlsZUZvcm0uc2V0SW5wdXRWYWx1ZXModXNlckluZm9WYWx1ZXMuZ2V0VXNlckluZm8oKSlcclxuICBwcm9maWxlRm9ybVZhbGlkYXRpb24ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgZWRpdFByb2ZpbGVGb3JtLm9wZW4oKTtcclxufSk7XHJcbi8vID09PSAnQWRkIGNhcmQnIGZvcm0gPT09IC8vXHJcbi8vIC0tLSBGb3JtIGNyZWF0aW9uIG1ldGhvZCAtLS0gLy9cclxuY29uc3QgYWRkQ2FyZEZvcm0gPSBuZXcgTW9kYWxXaXRoRm9ybShcIi5tb2RhbF90eXBlX2FkZC1jYXJkXCIsICgpID0+IHtcclxuICBjb25zdCBuZXdDYXJkID0gYWRkQ2FyZEZvcm0uZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICBjYXJkc1NlY3Rpb24ucHJlcGVuZEl0ZW0oY3JlYXRlQ2FyZChuZXdDYXJkKSk7XHJcbiAgYWRkQ2FyZEZvcm0uY2xvc2UoKTtcclxufSk7XHJcbi8vIC0tLSBTZXQgZXZlbnQgbGlzdGVuZXJzIGZvciAnYWRkIGNhcmQnIG1vZGFsIC0tLSAvL1xyXG5hZGRDYXJkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gKysrKysgVmFsaWRhdGlvbiArKysrKyAvL1xyXG4vLyAtLS0gJ0VkaXQgcHJvZmlsZScgZm9ybSB2YWxpZGF0aW9uIGFkZGluZyAtLS0gLy9cclxuY29uc3QgcHJvZmlsZUZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgcHJvZmlsZU1vZGFsKTtcclxucHJvZmlsZUZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuLy8gLS0tICdBZGQgY2FyZCcgZm9ybSB2YWxpZGF0aW9uIGFkZGluZyAtLS0gLy9cclxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgYWRkQ2FyZE1vZGFsKTtcclxuYWRkQ2FyZEZvcm1WYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIC8vIC0tLSBHRVQgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi9jYXJkcyAtLS0gLy9cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5iYXNlVXJsICsgXCIvY2FyZHNcIiwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnNcclxuICAgIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSBcclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBHRVQgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi91c2Vycy9tZSAtLS0gLy9cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLmJhc2VVcmwgKyBcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVyc1xyXG4gICAgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9IFxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIFBPU1QgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi9jYXJkcyAtLS0gLy9cclxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5iYXNlVXJsICsgXCIvY2FyZHNcIiwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtuYW1lLGxpbmt9KVxyXG4gICAgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9IFxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gLS0tIERFTEVURSBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzL2NhcmRJRCAtLS0gLy9cclxuICByZW1vdmVDYXJkKGNhcmRJRCkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuYmFzZVVybCArIFwiL2NhcmRzL1wiICsgY2FyZElELCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiXHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0gXHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcclxuICB9XHJcblxyXG4vLyAtLS0gQWRkL3JlbW92ZSBsaWtlcyAtLS0gLy9cclxuICAvLyAtLS0gUFVUIGh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXBJZC9jYXJkcy9saWtlcy9jYXJkSWQgLS0tIC8vXHJcbiAgYWRkTGlrZShjYXJkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5iYXNlVXJsICsgXCIvY2FyZHMvbGlrZXMvXCIgKyBjYXJkLmdldElkKCksIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUFVUXCJcclxuICAgIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSBcclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIC0tLSBERUxFVEUgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cElkL2NhcmRzL2xpa2VzL2NhcmRJZCAtLS0gLy9cclxuICByZW1vdmVMaWtlKGNhcmQpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLmJhc2VVcmwgKyBcIi9jYXJkcy9saWtlcy9cIiArIGNhcmQuZ2V0SWQoKSwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIlxyXG4gICAgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9IFxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbi8vIC0tLSBFZGl0aW5nIFByb2ZpbGUgaW5mbyAtLS0gLy9cclxuICAvLyAtLS0gUEFUQ0ggaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cElkL3VzZXJzL21lIC0tLSAvL1xyXG4gIHVwZGF0ZVVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuYmFzZVVybCArIFwiL3VzZXJzL21lXCIsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgbmFtZSxcclxuICAgICAgICAgIGFib3V0XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gUEFUQ0ggaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cElkL3VzZXJzL21lL2F2YXRhclxyXG4gIHNldFVzZXJBdmF0YXIoeyBhdmF0YXIgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuYmFzZVVybCArIFwiL3VzZXJzL21lL2F2YXRhclwiLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHthdmF0YXJ9KVxyXG4gICAgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9IFxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufSIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxXaXRoSW1hZ2UgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgLy8gLS0tIE9wZW4gYmlnIGltYWdlIG1vZGFsIG1ldGhvZCAtLS0gLy9cclxuICBvcGVudXAgPSAoZXZlbnQpID0+IHtcclxuICAgIGNvbnN0IGJpZ0ltYWdlID0gZXZlbnQudGFyZ2V0O1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2JpZy1pbWFnZVwiKS5zcmMgPSBiaWdJbWFnZS5zcmM7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYmlnLWltYWdlXCIpLmFsdCA9IGJpZ0ltYWdlLmFsdDtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1jYXB0aW9uXCIpLnRleHRDb250ZW50ID0gYmlnSW1hZ2UuYWx0O1xyXG5cclxuICAgIHRoaXMub3BlbigpO1xyXG4gIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcigge25hbWUsIGpvYiwgYXZhdGFyfSApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAke25hbWV9YCk7XHJcbiAgICB0aGlzLl9qb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAke2pvYn1gKTtcclxuICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCR7YXZhdGFyfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgbmFtZSA6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXHJcbiAgICBqb2IgOiB0aGlzLl9qb2IudGV4dENvbnRlbnQsXHJcbiAgICBhdmF0YXI6IHRoaXMuX2F2YXRhci5zcmNcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbygge25hbWUsIGpvYn0gKSB7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2pvYi50ZXh0Q29udGVudCA9IGpvYjtcclxuICB9XHJcblxyXG4gIHNldFVzZXJBdmF0YXIoIHthdmF0YXJ9ICkge1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImNhcmREYXRhIiwiaXNMaWtlZCIsImlzT3duZXIiLCJvbkNhcmRDbGljayIsInJlbW92ZUhhbmRsZXIiLCJsaWtlSGFuZGxlciIsImNhcmRTZWxlY3RvciIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX2xpa2VzIiwibGlrZXMiLCJfbGlrZXNDb3VudCIsImxlbmd0aCIsIl9jYXJkU2VsZWN0b3IiLCJfb25DYXJkQ2xpY2siLCJiaW5kIiwiX2xpa2VIYW5kbGVyIiwiX2NsaWNrTGlrZUhhbmRsZXIiLCJfcmVtb3ZlSGFuZGxlciIsIl9pc0xpa2VkIiwiX2lzT3duZXIiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwibGlrZXNBbW91bnRTZXQiLCJsaWtlc0NvdW50IiwiX2l0ZW0iLCJ0ZXh0Q29udGVudCIsIl9saWtlQ2FyZCIsImV2ZW50IiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwic3RvcEltbWVkaWF0ZVByb3BvZ2F0aW9uIiwiZGVsZXRlQ2FyZCIsInJlbW92ZSIsIl9kZWxldGVDYXJkSGFuZGxlciIsInN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJfY2FyZEltYWdlIiwiZ2VuZXJhdGVDYXJkIiwiX2VsZW1lbnQiLCJhZGQiLCJzcmMiLCJhbHQiLCJnZXRJRCIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtQ29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfZm9ybUNvbmZpZyIsIl9mb3JtRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yTWVzc2FnZUNsYXNzIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dHMiLCJmb3JFYWNoIiwiaW5wdXQiLCJfdG9nZ2xlU3VibWl0QnV0dG9uIiwiX2NoZWNrSW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfY2hlY2tJZkZvcm1WYWxpZCIsImV2ZXJ5IiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiYnV0dG9uRWxlbWVudCIsImRpc2FibGVkIiwiaW5wdXRTZWxlY3RvciIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJTZWN0aW9uIiwiaXRlbXMiLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsImNsZWFyIiwiaW5uZXJIVE1MIiwicmVuZGVySXRlbXMiLCJjYXJkIiwiZWRpdEJ1dHRvbiIsInByb2ZpbGVNb2RhbCIsImZvcm1zIiwicHJvZmlsZSIsImFkZENhcmRCdXR0b24iLCJlbGVtZW50cyIsImpvYiIsImFkZENhcmRNb2RhbCIsImFkZENhcmRGb3JtIiwidGl0bGUiLCJmb3JtU2VsZWN0b3IiLCJNb2RhbCIsIm1vZGFsU2VsZWN0b3IiLCJfbW9kYWxFbGVtZW50IiwiX2NoZWNrRm9yRXNjQ2xvc2UiLCJrZXkiLCJjbG9zZSIsIm9wZW4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIk1vZGFsV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVTdWJtaXRCdG4iLCJnZXRJbnB1dFZhbHVlcyIsImlucHV0TGlzdCIsImlucHV0VmFsdWVzIiwidmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsInZhbHVlcyIsInJlc2V0IiwiTW9kYWxEZWxldGVDb25maXJtYXRpb24iLCJzZWxlY3RvciIsIl9mb3JtIiwiX3NlbGVjdG9yIiwiX2hhbmRsZVN1Ym1pdCIsIl9oYW5kbGVTdWJtaXRIYW5kbGVyIiwiX3JlbW92ZUV2ZW50TGlzdGVuZXJzIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm8iLCJhZGRDYXJkIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZW1vdmVDYXJkIiwiY2FyZElEIiwiZ2V0QXBwSW5mbyIsImFsbCIsImFkZExpa2UiLCJnZXRJZCIsInJlbW92ZUxpa2UiLCJ1cGRhdGVVc2VySW5mbyIsImFib3V0Iiwic2V0VXNlckF2YXRhciIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJyZW5kZXJDYXJkIiwiaW5pdENhcmQiLCJ1c2VyIiwibGlzdExpa2VzIiwidW5kZWZpbmVkIiwiZmluZCIsIml0ZW0iLCJjYXJkSW5mbyIsImJpZ0ltYWdlTW9kYWwiLCJkZWxldGVDYXJkSGFuZGxlciIsImRlbGV0ZUNvbmZpcm0iLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJmaW5hbGx5Iiwic2V0TGlrZXMiLCJpbml0aWFsQ2FyZHMiLCJ1c2VySW5mbyIsImNhcmRzU2VjdGlvbiIsImRhdGEiLCJpbml0aWFsQ2FyZCIsInNldFVzZXJJbmZvIiwibW9kYWxBZGRDYXJkIiwibmV3Q2FyZCIsImFkZENhcmRGb3JtVmFsaWRhdGlvbiIsIm9wZW51cCIsImJpZ0ltYWdlIiwidXNlckluZm9WYWx1ZXMiLCJfam9iIiwiX2F2YXRhciIsImVkaXRQcm9maWxlRm9ybSIsInByb2ZpbGVGb3JtVmFsaWRhdGlvbiIsInByZXBlbmRJdGVtIiwiY3JlYXRlQ2FyZCJdLCJzb3VyY2VSb290IjoiIn0=